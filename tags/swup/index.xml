<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>swup on Ef&#39;s log</title>
    <link>https://fahmifj.github.io/tags/swup/</link>
    <description>Recent content in swup on Ef&#39;s log</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sun, 30 Nov 2025 22:37:50 +0700</lastBuildDate><atom:link href="https://fahmifj.github.io/tags/swup/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Revamping My Blog Part II: Search Nav, ScrollSpy, SPA in Hugo</title>
      <link>https://fahmifj.github.io/blog/revamping-my-blog-part-2/</link>
      <pubDate>Sun, 30 Nov 2025 22:37:50 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/revamping-my-blog-part-2/</guid>
      <description>Part kedua revamp PaperMod</description>
      <content:encoded><![CDATA[<p>Menjelang akhir tahun, gue mulai lanjutin lagi proses revamp blog ini. Dari catatan pribadi, revamp ini udah masuk yang ke-9, tapi disini gue rangkum aja bagian majornya biar lebih gampang. Jadi gue anggap ini revamp kedua.</p>
<p>Di revamp yang <a href="/notes/revamping-my-blog/"target="_blank" rel="noopener noreferrer"
>pertama</a>, gue banyak otak-atik di bagian UI, nah di revamp kedua ini, gue lebih condong ke UXnya, khususnya untuk bagian navigasi.</p>
<h2 id="search-in-navbar">Search in Navbar</h2>
<p>Di PaperMod (tema bawaan), fitur pencariannya ini berupa sebuah halaman khusus. Jadi ketika user mau cari sesuatu di blog gue, dia harus mengklik menu &ldquo;Search&rdquo; yang mengarah ke halaman khusus berisi search box. Di situlah tempat user melakukan pencariannya.</p>
<p>Menurut gue hal cara tersebut kurang praktis dan efisien. Jadi, untuk mempermudah navigasi pencarian, gue pindahkan search box tersebut ke bagian Navbar.</p>
<p><div class="img-container"><img src="./imgs/image-20251118233004676.png" alt="image-20251118233004676"  /></div>
</p>
<h3 id="implementasi">Implementasi</h3>
<p>Caranya gampang, code html terkait search box tinggal di copy-paste ke dalam <code>layout/partials/header.html</code>:</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">header.html</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">...[SNIP]...
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;searchBox&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;searchInput&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;searchInput&#34;</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">&#34;search&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;search&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Search...&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;searchResults-container &#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  	<span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;search-results hidden&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;searchResults&#34;</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">&#34;search results&#34;</span> <span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">...[SNIP]...</span></span></code></pre>
</figure><p>Fitur search PaperMod ini mengandalkan <a href="fusejs.io"target="_blank" rel="noopener noreferrer"
>Fuse</a> dimana index searchnya hanya di-<em>fetch</em> dan dimuat ketika kita berada di halaman search tadi. Artinya, kalau search box gue pindah ke navbar, search-nya nggak akan jalan kecuali indexnya dimuat di setiap halaman.</p>
<p>Untuk hal ini cukup simple, gue cuma perlu hapus kondisional if berikut yang ada di dalam <code>layout/partials/head.html</code>:</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">head.html</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="cm">/* Search */</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="cm">/* Load search in every page */</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="cm">/*if (eq .Layout `search`) */</span> <span class="o">-</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nx">link</span> <span class="nx">crossorigin</span><span class="p">=</span><span class="s">&#34;anonymous&#34;</span> <span class="nx">rel</span><span class="p">=</span><span class="s">&#34;preload&#34;</span> <span class="nx">as</span><span class="p">=</span><span class="s">&#34;fetch&#34;</span> <span class="nx">href</span><span class="p">=</span><span class="s">&#34;{{- .Site.BaseURL -}}index.json&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nx">script</span> <span class="k">defer</span> <span class="nx">crossorigin</span><span class="p">=</span><span class="s">&#34;anonymous&#34;</span> <span class="nx">src</span><span class="p">=</span><span class="s">&#34;{{ $search.RelPermalink }}&#34;</span><span class="p">&gt;&lt;</span><span class="o">/</span><span class="nx">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="nx">end</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="cm">/* end */</span> <span class="o">-</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span></span></span></code></pre>
</figure><h3 id="touch-up-add-blur-effect">Touch up: Add blur effect</h3>
<p>Terinspirasi dari tema <a href="https://hugoloveit.com/"target="_blank" rel="noopener noreferrer"
>LoveIt</a>, gue tambahin juga efek blur ketika user sedang fokus ke pencarian.</p>
<p>Implementasinya ini gampang. Pada file <code>/layouts/_default/baseof.html</code>, tepat setelah tag <code>&lt;body&gt;</code>, gue tambah sebuah elemen div dengan ID <code>mask</code> yang berfungsi sebagai masking.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">baseof.html</span>
    </figcaption>
    <pre tabindex="0"><code class="language-html " data-lang="html ">&lt;body&gt;
&lt;div id=&#34;mask&#34;&gt;&lt;/div&gt;
  &lt;main&gt;...&lt;/main&gt;
&lt;/body&gt;</code></pre>
</figure><p>Lalu untuk CSSnya gue tambahkan properti berikut.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">custom.css</span>
    </figcaption>
    <pre tabindex="0"><code class="language-css " data-lang="css ">...
#mask {
    background-repeat: no-repeat;
    background-position: center;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background-color: rgba(0, 0, 0, 0);
}
body.blur &gt; :not(.header) {
    -webkit-filter: blur(4px);
    -moz-filter: blur(4px);
    -ms-filter: blur(4px);
    -o-filter: blur(4px);
    filter: blur(4px);
}
...</code></pre>
</figure><p>Untuk behavior atau logicnya sih simple:</p>
<ul>
<li>Tambahkan efek blur ke element <code>&lt;body&gt;</code> dan buat elemen masking menjadi paling atas dari semua elemen yang ada ketika user melakukan klik pada search box.</li>
<li>Hapus efek blur ketika user melakukan klik pada item pencarian atau pada masking elemen</li>
</ul>
<p>Kalo di Javascriptnya seperti berikut.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">fastsearch.js</span>
    </figcaption>
    <pre tabindex="0"><code class="language-javascript " data-lang="javascript ">...
const mask = document.getElementById(&#34;mask&#34;)
const pageBody = document.body;

function bgBlur() {
  pageBody.classList.add(&#34;blur&#34;);
  mask.style.zIndex = &#34;99&#34;; // z-index shouldn&#39;t be higher than the navbar/header
  mask.style.backgroundColor = &#34;rgba(0,0,0,0.25)&#34;;
}

function bgUnblur() {
  pageBody.classList.remove(&#34;blur&#34;);
  mask.style.zIndex = &#34;-1&#34;;
  mask.style.backgroundColor = &#34;rgba(0,0,0,0)&#34;;
}

function reset() {
 	...[SNIP]...
  bgUnblur();
}

searchInput.addEventListener(&#34;click&#34;, bgBlur);
mask.addEventListener(&#34;click&#34;, reset);
document.addEventListener(&#34;click&#34;, (e) =&gt; {
  const item = e.target.closest(&#34;.search-item&#34;);
  if (item) reset();
});</code></pre>
</figure><p>Setelah itu, gue tinggal ngurus UInya aja supaya search box dan hasil searchnya rapi sekaligus ngga tabrakan dengan menu navbar.</p>
<h2 id="toc-scrollspy">ToC ScrollSpy</h2>
<p>Gue balik lagi ngotak-ngatik bagian floating ToC yang sebelumnya udah gue bahas di revamp part I. Kali ini floating tocnya punya kemampuan mirip ScrollSpy dari Bootstrap. Singkatnya, ini fitur yang bisa nge-highlight otomatis bagian item ToC mana yang sedang kita lihat atau baca berdasarkan posisi scroll.</p>
<h3 id="implementasi-1">Implementasi</h3>
<p>Untuk ini, bagian code ToC bawaan dari PaperMod yang sebelumnya cuma buat expand heading ToC aja, gue rombak penuh pakai bantuan ChatGPT. Karena codenya lumayan panjang, jadi gue simpen di <a href="https://gist.githubusercontent.com/fahmifj/1a2a00983476a15b350158e89fc1d462/raw/64b2a0506dbe7789b4f711e3238d21b5acf32220/toc.js"target="_blank" rel="noopener noreferrer"
>gist</a> aja deh.</p>
<h2 id="swup-for-dynamic-page-load">Swup for Dynamic Page Load</h2>
<p>Sebelumnya sempat mikir untuk pindah ke Gatsby atau NextJS yang punya SSR (Server-side rendering), simply cuma pengen transisi perhalamannya lebih seamless dan modern aja sih. Tapi gue urungkan, soalnya Hugo lebih friendly dan gampang dimanage.</p>
<p>Sekarang keinginan untuk punya transisi halaman secara seamless di Hugo ini bisa terwujud berkat <a href="https://swup.js.org/"target="_blank" rel="noopener noreferrer"
>Swup</a>. Singkatnya, meskipun gue pakai SSG seperti Hugo, Swup ini bisa ngasih pengalaman mirip SSR.</p>
<h3 id="implementasi-2">Implementasi</h3>
<p>Untuk implementasinya sendiri cukup mudah kok. Gue cuma perlu nentuin kontainer mana yang mau dijadiin sebagai area konten dinamiknya. Kontainer area konten gue disini adalah element <code>&lt;main&gt;</code>, lalu tinggal tag aja element ini dengan id <code>#swup</code> (<code>/layouts/_default/baseof.html)</code>:</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">baseof.html</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">main</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;swup&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;main transition-fades&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="err">&lt;</span><span class="na">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;content-wrapper&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  	{{- block &#34;main&#34; . }}{{ end }}
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">...</span></span></code></pre>
</figure><p>Masalahnya disini adalah Swup hanya mengupdate/mengganti elemen yang ada di dalam kontainer Swup (partial load). Script event listener, di luar kontainer Swup, ngga &lsquo;aware&rsquo; dengan partial load ini.</p>
<p>Saat partial load terjadi, elemen lama yang punya event listener akan diganti dengan elemen baru. Karena target elemennya hilang (elemen lama), aksi dari event listener juga ngga akan jalan.</p>
<p>Solusi masalah ini adalah me-reinisialasi semua event listener script dari element yang ada di dalam kontainer Swup setiap kali partial load terjadi.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">custom.js</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">swup</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Swup</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">initCustomFunction</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">initTOC</span><span class="p">(</span><span class="s2">&#34;.toc&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">profileClick</span><span class="p">(</span><span class="s2">&#34;.profile-img&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">restoreMenuScroll</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nx">updateActiveMenu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nx">hljs</span><span class="p">.</span><span class="nx">highlightAll</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// first init custom listeners
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&#34;DOMContentLoaded&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">initCustomFunction</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// reinit on page ready
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">swup</span><span class="p">.</span><span class="nx">hooks</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;page:view&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">initCustomFunction</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span></span></span></code></pre>
</figure><h2 id="end">End</h2>
<p>Baiklah, kurang lebih itu update revamp kali ini dan gue udah ngerasa cukup puaslah, terutama dibagian Swup. Soal revamp ini juga itung-itung refreshing skill web sih, jadi bakal gue lanjut di part berikutnya untuk bagian mobile (mungkin).</p>
<p>See you in the next post!</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
