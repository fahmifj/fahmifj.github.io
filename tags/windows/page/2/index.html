<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Windows | Ef's log</title><meta name=keywords content><meta name=description content="Infosec, CTF write-ups, and other IT related stuff"><meta name=author content="Fahmi J"><link rel=canonical href=https://fahmifj.github.io/tags/windows/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.9d8b3fd1605d7100d65fdc8ce694a234cb178542796d60cb16dcffb7bed68973.css integrity="sha256-nYs/0WBdcQDWX9yM5pSiNMsXhUJ5bWDLFtz/t77WiXM=" rel="preload stylesheet" as=style><link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.84.1"><link rel=alternate type=application/rss+xml href=https://fahmifj.github.io/tags/windows/index.xml><script>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g+"?ref=bwt",d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","711neo6qfi")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-PDN0GP97D1',{anonymize_ip:!1})}</script><meta property="og:title" content="Windows"><meta property="og:description" content="Infosec, CTF write-ups, and other IT related stuff"><meta property="og:type" content="website"><meta property="og:url" content="https://fahmifj.github.io/tags/windows/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Windows"><meta name=twitter:description content="Infosec, CTF write-ups, and other IT related stuff"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class="header sticky"><nav class=nav><div class=container><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="友人F (Alt + H)">友人F</a></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://fahmifj.github.io/writeups/ title=Write-ups><span>Write-ups</span></a></li><li><a href=https://fahmifj.github.io/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://fahmifj.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://fahmifj.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://fahmifj.github.io/about/ title=About><span>About</span></a></li></ul><span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/tags/>Tags</a></div><h1>Windows</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>HackTheBox - Cascade</h2></header><section class=entry-content><p>Cascade is another fun Windows machine with Medium difficulty from HackTheBox created by VbScrub, the creator of Nest. It starts with by enumerating LDAP to find a custom LDAP attribute on one of the users to gain initial access to SMB shares. Enumeration on SMB discovers VNC credentials that can be decrypted using IRB. The credentials can be used to gain a foothold on the system. Another enumeration on SMB with those credentials finds a set of custom application.
...</p></section><footer class=entry-footer>April 23, 2021&nbsp;·&nbsp;12 min&nbsp;·&nbsp;Fahmi J<div class=entry-tags><p>OSCP-plus&nbsp;·&nbsp;Windows&nbsp;·&nbsp;Active-Directory&nbsp;·&nbsp;Domain-controller&nbsp;·&nbsp;SMB&nbsp;·&nbsp;VNC&nbsp;·&nbsp;.NET&nbsp;·&nbsp;Reverse-engineering&nbsp;·&nbsp;AD-Recycle-Bin&nbsp;·&nbsp;rpcclient&nbsp;·&nbsp;psexec.py&nbsp;·&nbsp;evil-winrm</p></div></footer><a class=entry-link aria-label="post link to HackTheBox - Cascade" href=https://fahmifj.github.io/writeups/hackthebox/htb-cascade/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>HackTheBox - APT</h2></header><section class=entry-content><p>APT is an insane difficulty Windows machine from HackTheBox and it starts with enumeration on RPC services to get a list of MSRPC interfaces. One of the interface called IObjectExporter has a method named ServerAlive() can be abused to reveals the IPv6 address of the machine. There is a share contains a backup file of AD database and it can be extracted to obtain users' hashes. Brute-force attack is performed to obtain one valid credentials from those hashes.
...</p></section><footer class=entry-footer>April 17, 2021&nbsp;·&nbsp;17 min&nbsp;·&nbsp;Fahmi J<div class=entry-tags><p>Windows&nbsp;·&nbsp;Active-Directory&nbsp;·&nbsp;Domain-controller&nbsp;·&nbsp;MSRPC&nbsp;·&nbsp;IOXIDResolver&nbsp;·&nbsp;IPv6&nbsp;·&nbsp;Windows-registry&nbsp;·&nbsp;NTLMv1&nbsp;·&nbsp;MpCmdRun&nbsp;·&nbsp;Responder&nbsp;·&nbsp;DCSync&nbsp;·&nbsp;secretsdump.py&nbsp;·&nbsp;reg.py&nbsp;·&nbsp;evil-winrm&nbsp;·&nbsp;socat</p></div></footer><a class=entry-link aria-label="post link to HackTheBox - APT" href=https://fahmifj.github.io/writeups/hackthebox/htb-apt/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>HackTheBox - Nest</h2></header><section class=entry-content><p>Nest is one of my favorite machines after Forest, I learned a lot about enumeration here, especially for SMB.
Nest starts with anonymous access on SMB, which allows me to obtain credentials of a temporary user. The credentials can be leveraged to read the other shares and obtain an encrypted password that belongs to c.smith. There is also a VB project inside a directory that can not be reached unless you visit its full path.
...</p></section><footer class=entry-footer>April 16, 2021&nbsp;·&nbsp;11 min&nbsp;·&nbsp;Fahmi J<div class=entry-tags><p>OSCP-plus&nbsp;·&nbsp;Windows&nbsp;·&nbsp;SMB&nbsp;·&nbsp;Alternate-Data-Stream&nbsp;·&nbsp;Cryptography&nbsp;·&nbsp;.NET&nbsp;·&nbsp;Reverse-engineering&nbsp;·&nbsp;psexec.py</p></div></footer><a class=entry-link aria-label="post link to HackTheBox - Nest" href=https://fahmifj.github.io/writeups/hackthebox/htb-nest/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>HackTheBox - Sauna</h2></header><section class=entry-content><p>Sauna is another Active Directory box with easy difficulty from Hack The Box that covers several Active Directory kill chain techniques, such as AS-REP roasting attack, finding credentials on registry, and a DCSync attack to pull Active Directory password hashes.
Sauna starts by generating a list of potential usernames from its website, which is then used to perform AS-REP roasting attack and obtain the Kerberos TGT from one of the users.
...</p></section><footer class=entry-footer>April 7, 2021&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Fahmi J<div class=entry-tags><p>OSCP-plus&nbsp;·&nbsp;Windows&nbsp;·&nbsp;Active-Directory&nbsp;·&nbsp;Domain-controller&nbsp;·&nbsp;ASREP-roasting&nbsp;·&nbsp;Kerberos&nbsp;·&nbsp;BloodHound&nbsp;·&nbsp;SharpHound&nbsp;·&nbsp;DCSync&nbsp;·&nbsp;evil-winrm&nbsp;·&nbsp;secretsdump.py&nbsp;·&nbsp;psexec.py</p></div></footer><a class=entry-link aria-label="post link to HackTheBox - Sauna" href=https://fahmifj.github.io/writeups/hackthebox/htb-sauna/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>HackTheBox - ServMon</h2></header><section class=entry-content><p>ServMon starts with FTP anonymous access that allows me to read the users' notes. One of these notes contains a hint to a location of a password list in one of the user’s dekstops. A Path Traversal vulnerability on the installed NVMS-1000 is exploited to obtain the password list. With a password spray attack, I’m able to gain a foothold on the system .
In the NSClient++ default installation folder, there is a config file which contains a set of credentials.
...</p></section><footer class=entry-footer>April 6, 2021&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Fahmi J<div class=entry-tags><p>OSCP-like&nbsp;·&nbsp;Windows&nbsp;·&nbsp;Directory-traversal&nbsp;·&nbsp;NVMS-1000&nbsp;·&nbsp;NSClient&nbsp;·&nbsp;Tunneling</p></div></footer><a class=entry-link aria-label="post link to HackTheBox - ServMon" href=https://fahmifj.github.io/writeups/hackthebox/htb-servmon/></a></article><footer class=page-footer><nav><div class=pagination><a class=prev href=https://fahmifj.github.io/tags/windows/>« Prev Page</a>
<a class=next href=https://fahmifj.github.io/tags/windows/page/3/>Next Page »</a></div></nav></footer></main><footer class=footer><span>&copy; 2021 <a href=https://fahmifj.github.io/>友人F</a></span>
<span>&#183;</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>