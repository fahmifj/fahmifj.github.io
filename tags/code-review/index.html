<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Code-review | Ef's log</title>
<meta name=keywords content>
<meta name=description content="Infosec, CTF write-ups, and other IT related stuff">
<meta name=author content="Fahmi FJ">
<link rel=canonical href=https://fahmifj.github.io/tags/code-review/>
<meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8">
<link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.e4fa5d9e6235265db00abdee7d0c336d84263e9ab0a51d6988eaf932dd1b67e0.css integrity="sha256-5PpdnmI1Jl2wCr3ufQwzbYQmPpqwpR1piOr5Mt0bZ+A=" rel="preload stylesheet" as=style>
<link rel=preload href=https://fahmifj.github.io/resources/itsfj.png as=image>
<link rel=icon href=https://fahmifj.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.87.0">
<link rel=alternate type=application/rss+xml href=https://fahmifj.github.io/tags/code-review/index.xml>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-PDN0GP97D1',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Code-review">
<meta property="og:description" content="Infosec, CTF write-ups, and other IT related stuff">
<meta property="og:type" content="website">
<meta property="og:url" content="https://fahmifj.github.io/tags/code-review/">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Code-review">
<meta name=twitter:description content="Infosec, CTF write-ups, and other IT related stuff">
</head>
<body class="list dark" id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
</noscript>
<header class="header sticky">
<nav class=nav>
<div class=menu-wrapper>
<div class=logo>
<a href=https://fahmifj.github.io/ accesskey=h title=友人F>友人F</a>
</span>
</div>
<ul id=menu onscroll=menu_on_scroll()>
<li>
<a href=https://fahmifj.github.io/about/ title=About>About</a>
</li>
<li>
<a href=https://fahmifj.github.io/archives/ title=Archives>Archives</a>
</li>
<li>
<a href=https://fahmifj.github.io/projects/ title=Projects>Projects</a>
</li>
<li>
<a href=https://fahmifj.github.io/search/ title="Search (Alt + /)" accesskey=/>Search</a>
</li>
</ul>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</nav>
</header>
<main class=main>
<header class=page-header>
<h1>Code-review</h1>
</header>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>HackTheBox - Ophiuchi</h2>
</header>
<section class=entry-content>
<p>
Ophiuchi starts off by enumerating a Java web application that offers a service for parsing YAML. The parser is vulnerable to a deserialization attack. Exploiting the vulnerability results in an interactive shell access to the system. Internal enumeration of the system finds a set of user credentials. This user is allowed to run a specific Go program which loads a web assembly file and executes a script file if a certain condition is met.
...
</p>
</section>
<footer class=entry-footer>
August 6, 2021&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Fahmi FJ<div class=entry-tags>
<p>OSCP-like&nbsp;·&nbsp;Linux&nbsp;·&nbsp;YAML&nbsp;·&nbsp;Deserialization&nbsp;·&nbsp;Wasm&nbsp;·&nbsp;Wabt&nbsp;·&nbsp;Golang&nbsp;·&nbsp;Code-review&nbsp;·&nbsp;Sudo </p>
</div>
</footer>
<a class=entry-link aria-label="post link to HackTheBox - Ophiuchi" href=https://fahmifj.github.io/writeups/hackthebox/htb-ophiuchi/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2></h2>
</header>
<section class=entry-content>
<p>
Tenet is a medium difficulty Linux machine from Hack The Box. It features a basic PHP deserialization vulnerability, which can be leveraged to gain a foothold. Inside the system, enumeration of the web configuration files reveals a set of database credentials, and these are reused for SSH login. There is a sudo privileges on a custom script, and it can be used to escalate myself into root account if I win a race condition against it.
...
</p>
</section>
<footer class=entry-footer>
June 14, 2021&nbsp;·&nbsp;11 min&nbsp;·&nbsp;Fahmi FJ<div class=entry-tags>
<p>Linux&nbsp;·&nbsp;WordPress&nbsp;·&nbsp;PHP&nbsp;·&nbsp;Deserialization&nbsp;·&nbsp;Code-Review&nbsp;·&nbsp;Password-reuse&nbsp;·&nbsp;Race-condition&nbsp;·&nbsp;sudo&nbsp;·&nbsp;WPscan&nbsp;·&nbsp;ffuf&nbsp;·&nbsp;Cewl </p>
</div>
</footer>
<a class=entry-link aria-label="post link to " href=https://fahmifj.github.io/writeups/hackthebox/htb-tenet/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>HackTheBox - Cereal (User only)</h2>
</header>
<section class=entry-content>
<p>
Cereal is a hard difficulty Windows machine that features a misconfigured web server, which exposes source code of the currently hosted web application. Initial source code analysis revealed a deleted JWT secret that could be used to forge a JWT token and bypass the application’s login page. Another code analysis finds the web is vulnerable to a deserialization attack. There is also an XSS vulnerability in one of the packages used by the application.
...
</p>
</section>
<footer class=entry-footer>
June 9, 2021&nbsp;·&nbsp;13 min&nbsp;·&nbsp;Fahmi FJ<div class=entry-tags>
<p>Windows&nbsp;·&nbsp;Recover-git&nbsp;·&nbsp;dotNET&nbsp;·&nbsp;Csharp&nbsp;·&nbsp;Code-review&nbsp;·&nbsp;JWT&nbsp;·&nbsp;Golang&nbsp;·&nbsp;Deserialization&nbsp;·&nbsp;XSS&nbsp;·&nbsp;Python </p>
</div>
</footer>
<a class=entry-link aria-label="post link to HackTheBox - Cereal (User only)" href=https://fahmifj.github.io/writeups/hackthebox/htb-cereal/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>HackTheBox - Time</h2>
</header>
<section class=entry-content>
<p>
Time is a medium difficulty Linux machine from HackTheBox that features a web application which provides JSON beautifier and validator services. Testing some invalid inputs exposes the application error message, indicating it backed with Jackson library. Searching for the error message on Google leads to a research blog about deserialization on Jackson. After reproducing the steps from the blog, I’m able to gain a foothold on the box. Enumerating the files discovers a timer script that is executed by the root user every 10 seconds.
...
</p>
</section>
<footer class=entry-footer>
May 9, 2021&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Fahmi FJ<div class=entry-tags>
<p>OSCP-like&nbsp;·&nbsp;Linux&nbsp;·&nbsp;Jackson&nbsp;·&nbsp;Java&nbsp;·&nbsp;SSRF&nbsp;·&nbsp;Deserialization&nbsp;·&nbsp;CVE-2019-12384&nbsp;·&nbsp;Systemd-timer&nbsp;·&nbsp;Code-review&nbsp;·&nbsp;Code-patching </p>
</div>
</footer>
<a class=entry-link aria-label="post link to HackTheBox - Time" href=https://fahmifj.github.io/writeups/hackthebox/htb-time/></a>
</article>
<article class="post-entry tag-entry">
<header class=entry-header>
<h2>HackTheBox - Bucket</h2>
</header>
<section class=entry-content>
<p>
Bucket, as the name implies, features an Amazon S3 bucket that has been configured to allow anonymous users to perform read/write operations to the objects inside a bucket. This type of misconfiguration can be leveraged to gain a foothold on the box by dropping a web shell. The box also has DynamoDB using the same configuration that allows anonymous users to perform read/write access. Enumeration on the DynamoDB discovers several credentials and one of the credentials is reused by the user.
...
</p>
</section>
<footer class=entry-footer>
April 24, 2021&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Fahmi FJ<div class=entry-tags>
<p>OSCP-like&nbsp;·&nbsp;Linux&nbsp;·&nbsp;AWS&nbsp;·&nbsp;LocalStack&nbsp;·&nbsp;S3&nbsp;·&nbsp;DynamoDB&nbsp;·&nbsp;Webshell&nbsp;·&nbsp;Code-review&nbsp;·&nbsp;Tunneling&nbsp;·&nbsp;PD4ML&nbsp;·&nbsp;Gobuster </p>
</div>
</footer>
<a class=entry-link aria-label="post link to HackTheBox - Bucket" href=https://fahmifj.github.io/writeups/hackthebox/htb-bucket/></a>
</article>
<footer class=page-footer>
<nav>
<div class=pagination>
<a class=next href=https://fahmifj.github.io/tags/code-review/page/2/>Next Page »</a>
</div>
</nav>
</footer>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://fahmifj.github.io/>友人F</a></span>
<span>&#183;</span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script>var toc=document.getElementsByClassName('inner')[0],pTag=document.getElementsByClassName('post-meta')[0],fromTop=pTag.getBoundingClientRect().top,fromBottom=pTag.getBoundingClientRect().bottom;document.addEventListener('scroll',function(b){let a=document.documentElement.scrollTop+75;a>fromTop?(toc.style.visibility='visible',toc.style.opacity='1'):(toc.style.visibility='hidden',toc.style.opacity='0')})</script>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>