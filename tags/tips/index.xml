<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Tips on Ef&#39;s log</title>
    <link>https://fahmifj.github.io/tags/tips/</link>
    <description>Recent content in Tips on Ef&#39;s log</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Wed, 21 Jul 2021 07:07:50 +0700</lastBuildDate><atom:link href="https://fahmifj.github.io/tags/tips/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Windows 10 Troubleshoot: Permissions</title>
      <link>https://fahmifj.github.io/blog/fixing-windows-10-permissions/</link>
      <pubDate>Wed, 21 Jul 2021 07:07:50 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/fixing-windows-10-permissions/</guid>
      <description>Facing weird error on Windows 10? Then maybe this post could help you</description>
      <content:encoded><![CDATA[<p>Today, I wanted to clean up my Windows laptop from unused programs, specifically chocolatey, the Windows package manager, and then planning to upgrade my Microsoft Office. But, you guess it, things don&rsquo;t always go as planned.</p>
<p>Solutions for &ldquo;<code>Error Code: 30015-4 (5)</code>&rdquo; and &ldquo;<code>C:\ProgramData\Microsoft\Windows GetLastError:5</code>&rdquo; , just to mention a few of the problems I faced, on <a href="https://answers.microsoft.com">Microsoft Answer</a> didn&rsquo;t help at all. In fact, after reading some of the answers regarding these problems, I feel I have become more stupid.</p>
<p>I suspected that these problems were caused by a Microsoft troubleshooter tool called <a href="https://www.microsoft.com/en-us/download/100607">SaRA</a>. Instead of fixing the system, it accidentally messed up the Windows permissions.</p>
<p>But, in the end, I was able to resolve these problems. So, I think it would be fun to document how I resolve these issues on my blog.</p>
<h2 id="the-problems-">The Problems üí¢</h2>
<p>The first problem I encounter is &ldquo;<em>Error Code: 30015-4  (5)</em>&rdquo; when I was trying to reinstall my Microsoft Office.</p>
<p><img class="img-container" src="imgs/image-20210721040950497.png" alt="image-20210721040950497"  />
</p>
<p>I looked for the online help, and it was pointing out to <a href="https://support.microsoft.com/en-us/office/fix-office-installation-errors-d5df89a9-0507-4b4c-92f9-22f457e630aa?ns=ocsac2rinstall&amp;version=16&amp;syslcid=1033&amp;uilcid=1033&amp;appver=cin160&amp;helpid=%225-4-30015%22&amp;ui=en-us&amp;rs=en-us&amp;ad=us">this page</a>. At the bottom of the page, it offers a &ldquo;easy fix&rdquo; tool to resolve the problem above.</p>
<p><img class="img-container" src="imgs/image-20210721041358098.png" alt="image-20210721041358098"  />
</p>
<p>I downloaded that tool, ran it, and the error is still there üôÉ. From here, I couldn&rsquo;t install or uninstall an application that was wrapped with Windows Installer (<code>.msi</code>), just like I showed in my <a href="https://fahmifj.github.io/blog/play-with-printnightmare/">PrintNightmare</a> post</p>
<h2 id="identifying-the-root-cause-">Identifying The Root Cause üïµÔ∏è‚Äç‚ôÇÔ∏è</h2>
<p>Now that searching &ldquo;Error Code: 30015-4  (5)&rdquo; in the Ms Support site didn&rsquo;t help, but I started to search for the official documentation about error code, and I found <a href="https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes--0-499-">this page</a>. I couldn&rsquo;t find anything about &ldquo;30015-4&rdquo;, but I think I did know what &ldquo;(5)&rdquo; meant.</p>
<p><img class="img-container" src="imgs/image-20210721043547662.png" alt="image-20210721043547662"  />
</p>
<p>Also, according the error I got when I&rsquo;m trying to install a Windows SDK and uninstall Node, it was clear these all related with permissions even my Wi-Fi.</p>
<h2 id="lets-fix-them">Let&rsquo;s Fix Themüî®</h2>
<p>I found no problem in  <code>C:\Program Files\</code> and <code>C:\Program Files (x86)\</code> (the default folder for installed apps). So the next one to inspect is <code>C:\ProgramData</code>, where all application data stored/created.</p>
<p>After inspecting all the folders under <code>C:\ProgramData\</code> and <code>C:\ProgramData\Microsoft\Windows</code>, I found out that some of the folders only have my account listed in their security properties.</p>
<p><img class="img-container" src="imgs/image-20210721044802348.png" alt="image-20210721044802348"  />
</p>
<p>While the normal one should be looks like this.</p>
<p><img class="img-container" src="imgs/image-20210721045334784.png" alt="image-20210721045334784"  />
</p>
<p>And here are the advanced settings.</p>
<p><img class="img-container" src="imgs/image-20210721045624596.png" alt="image-20210721045624596"  />
</p>
<p>Now I know how the default permissions look like, I could apply the same permission to fix the problems I faced.</p>
<h3 id="office-error-code-30015-4-5">Office Error Code: 30015-4 (5)</h3>
<p>To fix &ldquo;Error Code: 30015-4 (5)&rdquo;, I  will enable the inheritance on the affected folder, which is <code>C:\ProgramData\Microsoft\OFFICE</code>. So that the permissions on the <code>Microsoft</code> folder will be inherited to the <code>OFFICE</code> folder. And then I will remove my account, &ldquo;Fahmi FJ&rdquo;, from the permission entries.</p>
<p><img class="img-container" src="imgs/image-20210721051824838.png" alt="image-20210721051824838"  />
</p>
<p>Check the other folders' permission under the same parent folder if you&rsquo;re not sure about this.</p>
<p>Now I get my Microsoft Office back.</p>
<p><img class="img-container" src="imgs/image-20210721053920106.png" alt="image-20210721053920106"  />
</p>
<h3 id="getlasterror5">GetLastError:5</h3>
<p>To fix this error, same as above, enable the inheritance to inherit the parent  folder permissions.</p>
<p><img class="img-container" src="imgs/image-20210721053101620.png" alt="image-20210721053101620"  />
</p>
<h3 id="the-system-detected-an-overrun-of-a-blabla">The system detected an overrun of a blabla..</h3>
<p>This error can have multiple root causes, but in my case the root cause is the folder permission.</p>
<p><img class="img-container" src="imgs/image-20210721050915867.png" alt="image-20210721050915867"  />
</p>
<p>The error raises when I clicked any Wi-Fi connection currently in use from the Wi-Fi settings.</p>
<p><img class="img-container" src="imgs/image-20210721053820002.png" alt="image-20210721053820002"  />
</p>
<p>Also, the &ldquo;Forget&rdquo; and &ldquo;Properties&rdquo; buttons were missing. I found the same issue <a href="https://answers.microsoft.com/en-us/windows/forum/all/windows-10-doesnt-save-wifi-network-resolved/16ae1129-e24b-4268-91c4-acc4446966fa">here</a> but the solution doesn&rsquo;t suite my environment.</p>
<p><img class="img-container" src="imgs/image-20210721054401662.png" alt="image-20210721054401662"  />
</p>
<p>In Windows, all Wi-Fi profiles are stored in <code>C:\ProgramData\Microsoft\Wlansvc\Profiles</code>, so if the permissions are messed up, the system is most likely to crash or partially working. So fixing the permissions will also fix the functionality back to normal.</p>
<p><img class="img-container" src="imgs/image-20210721055011183.png" alt="image-20210721055011183"  />
</p>
<p>And it&rsquo;s working again, and no more &ldquo;<em>The system detected an overrun of a stack-based buffer in this  application. This overrun could potentially allow a malicious user to  gain control of this application</em>&rdquo;.</p>
<p><img class="img-container" src="imgs/image-20210721055107535.png" alt="image-20210721055107535"  />
</p>
<p>So actually this section covers the following problems.</p>
<ul>
<li>SystemSettings.exe - System Error: The system detected an overrun of a blabla..</li>
<li>Windows won&rsquo;t remember Wi-Fi password</li>
<li>The &ldquo;Forget&rdquo; and &ldquo;Properties&rdquo; buttons are missing from Wi-Fi connection.</li>
<li>Mobile Hotspot Wi-Fi</li>
</ul>
<p>Annoying errors with the same root cause, it is so annoying. But, I learned! So I hope it helps you too.</p>
<h2 id="the-end">The End?</h2>
<p>No, I will keep this post to be updated whenever I faced the same problem with Windows Permissions.</p>
<p>Just after I finished this post, I saw this on Twitter (Full link to tweet: <a href="https://twitter.com/jonasLyk/status/1417205166172950531)">https://twitter.com/jonasLyk/status/1417205166172950531)</a>.</p>
<p><img class="img-container" src="imgs/image-20210721062052472.png" alt="image-20210721062052472"  />
</p>
<p>It seems the root cause here is the Windows itself üòÖ.</p>
<hr>
<h2 id="references">References</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes--1700-3999-">https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes--1700-3999-</a></li>
<li>Myself</li>
</ul>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
