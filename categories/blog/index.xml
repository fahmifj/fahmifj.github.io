<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>blog on Ef&#39;s log</title>
    <link>https://fahmifj.github.io/categories/blog/</link>
    <description>Recent content in blog on Ef&#39;s log</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sat, 13 Dec 2025 13:44:19 +0700</lastBuildDate><atom:link href="https://fahmifj.github.io/categories/blog/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Tidying Up My Blog</title>
      <link>https://fahmifj.github.io/notes/tidying-up-my-blog/</link>
      <pubDate>Sat, 13 Dec 2025 13:44:19 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/notes/tidying-up-my-blog/</guid>
      <description>Some improvements I made to this blog only revolve around UI and UX, but then I realized the structure no longer reflected how I actually learn and work. I feel like so many redundant in how I categorized things up here. This post notes on my walkthrough in reorganizing it.
How Things Are Organized Before Before, I have these categories as my main sections and are shown in my menu.</description>
      <content:encoded><![CDATA[<p>Some improvements I made to this blog only revolve around UI and UX, but then I realized the structure no longer reflected how I actually learn and work. I feel like so many redundant in how I categorized things up here. This post notes on my walkthrough in reorganizing it.</p>
<h2 id="how-things-are-organized">How Things Are Organized</h2>
<h3 id="before">Before</h3>
<p>Before, I have these categories as my main sections and are shown in my menu.</p>
<ul>
<li><a href="https://fahmifj.space/articles/"target="_blank" rel="noopener noreferrer"
>Articles</a>, intented to be a section for things like complete guide, tutorials written in formal</li>
<li><a href="https://fahmifj.space/notes/"target="_blank" rel="noopener noreferrer"
>Notes</a>, this is for quick notes and brain dump and life updates.</li>
<li><a href="https://fahmifj.space/ctf/"target="_blank" rel="noopener noreferrer"
>CTF</a>, dedicated for CTF writeups. These are mostly HackTheBox and TryHackMe boot2root type CTF.</li>
<li><a href="https://fahmifj.space/series/"target="_blank" rel="noopener noreferrer"
>Series</a>, used this curate posts that can belong to an ongoing learning, tutorial, or experimentation.</li>
<li><a href="https://fahmifj.space/archives/"target="_blank" rel="noopener noreferrer"
>Archives</a>, contains all my posts in chronological order.</li>
</ul>
<h3 id="after">After</h3>
<p>Right now, I moved reorganized the main section with</p>
<ul>
<li>Articles, now merged with notes.</li>
<li>Projects, something I build and deliver.</li>
<li>About, my about page to get to know me.`</li>
<li>Archives, nothing change.</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Using Cloudflare Workers to Mirror My Blog</title>
      <link>https://fahmifj.github.io/blog/mirror-website-using-cloudflare-workers/</link>
      <pubDate>Sat, 06 Dec 2025 15:33:48 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/mirror-website-using-cloudflare-workers/</guid>
      <description>I want to host my blog on a custom domain that I own (fahmifj.space) instead of using the GitHub Pages domain (fahmifj.github.io).
However, migrating a site to another domain could negatively impact SEO. Although I&amp;rsquo;m not really concerned about it, I think it&amp;rsquo;s a great opportunity to learn something from this case.
So, instead of moving everything, I keep GH Pages as the primary site and let the custom domain act as a mirror.</description>
      <content:encoded><![CDATA[<p>I want to host my blog on a custom domain that I own (<code>fahmifj.space</code>) instead of using the GitHub Pages domain (<code>fahmifj.github.io</code>).</p>
<p>However, migrating a site to another domain could negatively impact SEO. Although I&rsquo;m not really concerned about it, I think it&rsquo;s a great opportunity to learn something from this case.</p>
<p>So, instead of moving everything, I keep GH Pages as the primary site and let the custom domain act as a mirror. Both domains serve the same content without redirecting one to the other.</p>
<p>This post documents the setup and explains why keeping GitHub Pages as the primary works better for me.</p>
<h2 id="cloudflare-workers-as-reverse-proxy">Cloudflare Workers as Reverse Proxy</h2>
<p>Cloudflare provides a feature called Workers. It allows you to write and run serverless code, similar in concept to Google Cloud Functions.</p>
<p>Using this feature, I write a Worker that acts as a reverse proxy. Its job is to fetch my GitHub Pages content and serve it back on the custom domain.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">                       ┌──────────────────────────┐
</span></span><span class="line"><span class="cl">                       │   fahmifj.github.io      │
</span></span><span class="line"><span class="cl">                       │    (upstream hosting)    │
</span></span><span class="line"><span class="cl">                       └──────────┬───────────────┘
</span></span><span class="line"><span class="cl">                                  │ GitHub Pages origin
</span></span><span class="line"><span class="cl">                                  ▼
</span></span><span class="line"><span class="cl">                          Cloudflare Worker
</span></span><span class="line"><span class="cl">                          (proxy + rewrite)
</span></span><span class="line"><span class="cl">                                  │
</span></span><span class="line"><span class="cl">                                  ▼
</span></span><span class="line"><span class="cl">                            fahmifj.space
</span></span><span class="line"><span class="cl">                           (custom domain)</span></span></code></pre>
</figure><h3 id="create-worker-v1">Create Worker (v1)</h3>
<p>This first version of the Worker functions purely as a content fetcher.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">worker.js</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">async</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URL</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Force everything to fetch from GitHub Pages 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">url</span><span class="p">.</span><span class="nx">hostname</span> <span class="o">=</span> <span class="s2">&#34;fahmifj.github.io&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">headers</span><span class="o">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">redirect</span><span class="o">:</span> <span class="s2">&#34;follow&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Copy GitHub response and serve it
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="nx">response</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre>
</figure><p>The result is straightforward, it serves the same content as GitHub Pages.</p>
<p><div class="img-container"><img src="./imgs/image-20251208204713163.png" alt="image-20251208204713163"  /></div>
</p>
<h3 id="attach-custom-domain-to-worker">Attach Custom Domain to Worker</h3>
<p>Next, I attach my custom domain to the Worker (<code>Workers &amp; Pages</code> &gt; <code>My Worker</code> &gt; <code>Settings</code> &gt; <code>Domain &amp; Routers</code>).</p>
<img src="./imgs/image-20251209003601514.png" alt="image-20251209003601514" style="zoom: 50%;" />
<p>At this point, <code>fahmifj.space</code> is already serving the same content as <code>fahmifj.github.io</code>.</p>
<h3 id="worker-with-url-rewriter-v2">Worker with URL Rewriter (v2)</h3>
<p>Hugo builds my site with absolute URLs based on my GH Pages domain, which is <code>fahmifj.github.io</code>. Because of this, clicking most links on the custom domain sends users back to GH Pages.</p>
<p>To fix that, I need to make an adjustment on the Worker to rewrite all the GitHub Pages URLs and replace them with the custom domain. With the help of ChatGPT, I also add a condition to:</p>
<ul>
<li>Block search engines indexing bot.</li>
<li>Return 404 for the sitemap.</li>
<li>Remove canonical link before the contents are served on the custom domain.</li>
</ul>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">worker.js</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">async</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">upstream</span> <span class="o">=</span> <span class="s2">&#34;fahmifj.github.io&#34;</span><span class="p">;</span> <span class="c1">// GitHub Pages domain
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">mirror</span> <span class="o">=</span> <span class="s2">&#34;fahmifj.space&#34;</span><span class="p">;</span> <span class="c1">// Custom domain
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URL</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Prevent indexing by googlebot
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">ua</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;user-agent&#34;</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">||</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">bots</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;googlebot&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;bingbot&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;slurp&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;duckduckbot&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;baiduspider&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;yandex&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">bots</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">bot</span> <span class="p">=&gt;</span> <span class="nx">ua</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">bot</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s2">&#34;Not for indexing&#34;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">status</span><span class="o">:</span> <span class="mi">403</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Do not serve sitemap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">pathname</span> <span class="o">===</span> <span class="s2">&#34;/sitemap.xml&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">status</span><span class="o">:</span> <span class="mi">404</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">url</span><span class="p">.</span><span class="nx">hostname</span> <span class="o">=</span> <span class="nx">upstream</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Read HTML response
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">upstreamResponse</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">headers</span><span class="o">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">redirect</span><span class="o">:</span> <span class="s2">&#34;follow&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">contentType</span> <span class="o">=</span> <span class="nx">upstreamResponse</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;content-type&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">contentType</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&#34;text/html&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">upstreamResponse</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Add no-index header (no crawling on my custom domain)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">headers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Headers</span><span class="p">(</span><span class="nx">upstreamResponse</span><span class="p">.</span><span class="nx">headers</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&#34;X-Robots-Tag&#34;</span><span class="p">,</span> <span class="s2">&#34;noindex, nofollow&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//  Rewrite all URLs from upstream → custom domain
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="k">new</span> <span class="nx">HTMLRewriter</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// Rewrite links
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;a[href]&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">element</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">rewriteAttr</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="s2">&#34;href&#34;</span><span class="p">,</span> <span class="nx">upstream</span><span class="p">,</span> <span class="nx">mirror</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">})</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// Rewrite assets
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;img[src], script[src], link[href]&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">element</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">rewriteAttr</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="s2">&#34;src&#34;</span><span class="p">,</span> <span class="nx">upstream</span><span class="p">,</span> <span class="nx">mirror</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nx">rewriteAttr</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="s2">&#34;href&#34;</span><span class="p">,</span> <span class="nx">upstream</span><span class="p">,</span> <span class="nx">mirror</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">})</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// Remove canonical tag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;link[rel=&#39;canonical&#39;]&#34;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">element</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">})</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="nx">upstreamResponse</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">status</span><span class="o">:</span> <span class="nx">upstreamResponse</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">headers</span>
</span></span><span class="line"><span class="cl">      <span class="p">}));</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* ---- Helper ---- */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">rewriteAttr</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">,</span> <span class="nx">upstream</span><span class="p">,</span> <span class="nx">mirror</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">attr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">upstream</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">element</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="nx">attr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">value</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sb">`https://</span><span class="si">${</span><span class="nx">upstream</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="sb">`https://</span><span class="si">${</span><span class="nx">mirror</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre>
</figure><h2 id="conclusion">Conclusion</h2>
<p>With this setup, the custom domain acting as a mirror can coexist with GH Pages.</p>
<p>You might think that it is odd to keep using GitHub pages even though I already have a custom domain. The reason is simple: I want my blog to stay online as long as possible by relying on a free service provided by GitHub itself.</p>
<p>If I used my custom domain as the primary site, I would be responsible for maintaining that domain (or even server). The custom domain can expire in one or two year and I might forget renewing it or even I decide to switch to another TLD. These all could negatively impact SEO*.</p>
<blockquote>
<p>*or .. maybe I&rsquo;m just a lazy sysadmin.</p>
</blockquote>
<p>But with GitHub Pages as the primary site, I don&rsquo;t have to worry about maintaining a domain. GitHub handles everything and the canonical URL stays consistent. This way, I will still have the freedom to change my custom domain in the future without worrying about SEO.</p>
<p>Okay that&rsquo;s it. See you in the next post!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Revamping My Blog Part II: Search Nav, ScrollSpy, SPA in Hugo</title>
      <link>https://fahmifj.github.io/blog/revamping-my-blog-part-2/</link>
      <pubDate>Sun, 30 Nov 2025 22:37:50 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/revamping-my-blog-part-2/</guid>
      <description>Part kedua revamp PaperMod</description>
      <content:encoded><![CDATA[<p>Menjelang akhir tahun, gue mulai lanjutin lagi proses revamp blog ini. Dari catatan pribadi, revamp ini udah masuk yang ke-9, tapi disini gue rangkum aja bagian majornya biar lebih gampang. Jadi gue anggap ini revamp kedua.</p>
<p>Di revamp yang <a href="/notes/revamping-my-blog/"target="_blank" rel="noopener noreferrer"
>pertama</a>, gue banyak otak-atik di bagian UI, nah di revamp kedua ini, gue lebih condong ke UXnya, khususnya untuk bagian navigasi.</p>
<h2 id="search-in-navbar">Search in Navbar</h2>
<p>Di PaperMod (tema bawaan), fitur pencariannya ini berupa sebuah halaman khusus. Jadi ketika user mau cari sesuatu di blog gue, dia harus mengklik menu &ldquo;Search&rdquo; yang mengarah ke halaman khusus berisi search box. Di situlah tempat user melakukan pencariannya.</p>
<p>Menurut gue hal cara tersebut kurang praktis dan efisien. Jadi, untuk mempermudah navigasi pencarian, gue pindahkan search box tersebut ke bagian Navbar.</p>
<p><div class="img-container"><img src="./imgs/image-20251118233004676.png" alt="image-20251118233004676"  /></div>
</p>
<h3 id="implementasi">Implementasi</h3>
<p>Caranya gampang, code html terkait search box tinggal di copy-paste ke dalam <code>layout/partials/header.html</code>:</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">header.html</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">...[SNIP]...
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;searchBox&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;searchInput&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;searchInput&#34;</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">&#34;search&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;search&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;Search...&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;searchResults-container &#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  	<span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;search-results hidden&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;searchResults&#34;</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">&#34;search results&#34;</span> <span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">...[SNIP]...</span></span></code></pre>
</figure><p>Fitur search PaperMod ini mengandalkan <a href="fusejs.io"target="_blank" rel="noopener noreferrer"
>Fuse</a> dimana index searchnya hanya di-<em>fetch</em> dan dimuat ketika kita berada di halaman search tadi. Artinya, kalau search box gue pindah ke navbar, search-nya nggak akan jalan kecuali indexnya dimuat di setiap halaman.</p>
<p>Untuk hal ini cukup simple, gue cuma perlu hapus kondisional if berikut yang ada di dalam <code>layout/partials/head.html</code>:</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">head.html</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="cm">/* Search */</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="cm">/* Load search in every page */</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="cm">/*if (eq .Layout `search`) */</span> <span class="o">-</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nx">link</span> <span class="nx">crossorigin</span><span class="p">=</span><span class="s">&#34;anonymous&#34;</span> <span class="nx">rel</span><span class="p">=</span><span class="s">&#34;preload&#34;</span> <span class="nx">as</span><span class="p">=</span><span class="s">&#34;fetch&#34;</span> <span class="nx">href</span><span class="p">=</span><span class="s">&#34;{{- .Site.BaseURL -}}index.json&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nx">script</span> <span class="k">defer</span> <span class="nx">crossorigin</span><span class="p">=</span><span class="s">&#34;anonymous&#34;</span> <span class="nx">src</span><span class="p">=</span><span class="s">&#34;{{ $search.RelPermalink }}&#34;</span><span class="p">&gt;&lt;</span><span class="o">/</span><span class="nx">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="nx">end</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span><span class="o">-</span> <span class="cm">/* end */</span> <span class="o">-</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span></span></span></code></pre>
</figure><h3 id="touch-up-add-blur-effect">Touch up: Add blur effect</h3>
<p>Terinspirasi dari tema <a href="https://hugoloveit.com/"target="_blank" rel="noopener noreferrer"
>LoveIt</a>, gue tambahin juga efek blur ketika user sedang fokus ke pencarian.</p>
<p>Implementasinya ini gampang. Pada file <code>/layouts/_default/baseof.html</code>, tepat setelah tag <code>&lt;body&gt;</code>, gue tambah sebuah elemen div dengan ID <code>mask</code> yang berfungsi sebagai masking.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">baseof.html</span>
    </figcaption>
    <pre tabindex="0"><code class="language-html " data-lang="html ">&lt;body&gt;
&lt;div id=&#34;mask&#34;&gt;&lt;/div&gt;
  &lt;main&gt;...&lt;/main&gt;
&lt;/body&gt;</code></pre>
</figure><p>Lalu untuk CSSnya gue tambahkan properti berikut.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">custom.css</span>
    </figcaption>
    <pre tabindex="0"><code class="language-css " data-lang="css ">...
#mask {
    background-repeat: no-repeat;
    background-position: center;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background-color: rgba(0, 0, 0, 0);
}
body.blur &gt; :not(.header) {
    -webkit-filter: blur(4px);
    -moz-filter: blur(4px);
    -ms-filter: blur(4px);
    -o-filter: blur(4px);
    filter: blur(4px);
}
...</code></pre>
</figure><p>Untuk behavior atau logicnya sih simple:</p>
<ul>
<li>Tambahkan efek blur ke element <code>&lt;body&gt;</code> dan buat elemen masking menjadi paling atas dari semua elemen yang ada ketika user melakukan klik pada search box.</li>
<li>Hapus efek blur ketika user melakukan klik pada item pencarian atau pada masking elemen</li>
</ul>
<p>Kalo di Javascriptnya seperti berikut.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">fastsearch.js</span>
    </figcaption>
    <pre tabindex="0"><code class="language-javascript " data-lang="javascript ">...
const mask = document.getElementById(&#34;mask&#34;)
const pageBody = document.body;

function bgBlur() {
  pageBody.classList.add(&#34;blur&#34;);
  mask.style.zIndex = &#34;99&#34;; // z-index shouldn&#39;t be higher than the navbar/header
  mask.style.backgroundColor = &#34;rgba(0,0,0,0.25)&#34;;
}

function bgUnblur() {
  pageBody.classList.remove(&#34;blur&#34;);
  mask.style.zIndex = &#34;-1&#34;;
  mask.style.backgroundColor = &#34;rgba(0,0,0,0)&#34;;
}

function reset() {
 	...[SNIP]...
  bgUnblur();
}

searchInput.addEventListener(&#34;click&#34;, bgBlur);
mask.addEventListener(&#34;click&#34;, reset);
document.addEventListener(&#34;click&#34;, (e) =&gt; {
  const item = e.target.closest(&#34;.search-item&#34;);
  if (item) reset();
});</code></pre>
</figure><p>Setelah itu, gue tinggal ngurus UInya aja supaya search box dan hasil searchnya rapi sekaligus ngga tabrakan dengan menu navbar.</p>
<h2 id="toc-scrollspy">ToC ScrollSpy</h2>
<p>Gue balik lagi ngotak-ngatik bagian floating ToC yang sebelumnya udah gue bahas di revamp part I. Kali ini floating tocnya punya kemampuan mirip ScrollSpy dari Bootstrap. Singkatnya, ini fitur yang bisa nge-highlight otomatis bagian item ToC mana yang sedang kita lihat atau baca berdasarkan posisi scroll.</p>
<h3 id="implementasi-1">Implementasi</h3>
<p>Untuk ini, bagian code ToC bawaan dari PaperMod yang sebelumnya cuma buat expand heading ToC aja, gue rombak penuh pakai bantuan ChatGPT. Karena codenya lumayan panjang, jadi gue simpen di <a href="https://gist.githubusercontent.com/fahmifj/1a2a00983476a15b350158e89fc1d462/raw/64b2a0506dbe7789b4f711e3238d21b5acf32220/toc.js"target="_blank" rel="noopener noreferrer"
>gist</a> aja deh.</p>
<h2 id="swup-for-dynamic-page-load">Swup for Dynamic Page Load</h2>
<p>Sebelumnya sempat mikir untuk pindah ke Gatsby atau NextJS yang punya SSR (Server-side rendering), simply cuma pengen transisi perhalamannya lebih seamless dan modern aja sih. Tapi gue urungkan, soalnya Hugo lebih friendly dan gampang dimanage.</p>
<p>Sekarang keinginan untuk punya transisi halaman secara seamless di Hugo ini bisa terwujud berkat <a href="https://swup.js.org/"target="_blank" rel="noopener noreferrer"
>Swup</a>. Singkatnya, meskipun gue pakai SSG seperti Hugo, Swup ini bisa ngasih pengalaman mirip SSR.</p>
<h3 id="implementasi-2">Implementasi</h3>
<p>Untuk implementasinya sendiri cukup mudah kok. Gue cuma perlu nentuin kontainer mana yang mau dijadiin sebagai area konten dinamiknya. Kontainer area konten gue disini adalah element <code>&lt;main&gt;</code>, lalu tinggal tag aja element ini dengan id <code>#swup</code> (<code>/layouts/_default/baseof.html)</code>:</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">baseof.html</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">main</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;swup&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;main transition-fades&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="err">&lt;</span><span class="na">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;content-wrapper&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  	{{- block &#34;main&#34; . }}{{ end }}
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">...</span></span></code></pre>
</figure><p>Masalahnya disini adalah Swup hanya mengupdate/mengganti elemen yang ada di dalam kontainer Swup (partial load). Script event listener, di luar kontainer Swup, ngga &lsquo;aware&rsquo; dengan partial load ini.</p>
<p>Saat partial load terjadi, elemen lama yang punya event listener akan diganti dengan elemen baru. Karena target elemennya hilang (elemen lama), aksi dari event listener juga ngga akan jalan.</p>
<p>Solusi masalah ini adalah me-reinisialasi semua event listener script dari element yang ada di dalam kontainer Swup setiap kali partial load terjadi.</p>
<figure class="highlight">
    <figcaption>
        <span class="hl-filename">custom.js</span>
    </figcaption>
    <pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">swup</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Swup</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">initCustomFunction</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">initTOC</span><span class="p">(</span><span class="s2">&#34;.toc&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">profileClick</span><span class="p">(</span><span class="s2">&#34;.profile-img&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">restoreMenuScroll</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nx">updateActiveMenu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nx">hljs</span><span class="p">.</span><span class="nx">highlightAll</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// first init custom listeners
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&#34;DOMContentLoaded&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">initCustomFunction</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// reinit on page ready
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">swup</span><span class="p">.</span><span class="nx">hooks</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;page:view&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">initCustomFunction</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span></span></span></code></pre>
</figure><h2 id="end">End</h2>
<p>Baiklah, kurang lebih itu update revamp kali ini dan gue udah ngerasa cukup puaslah, terutama dibagian Swup. Soal revamp ini juga itung-itung refreshing skill web sih, jadi bakal gue lanjut di part berikutnya untuk bagian mobile (mungkin).</p>
<p>See you in the next post!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>How to Run GNS3 Server on Apple M2 Using OrbStack</title>
      <link>https://fahmifj.github.io/blog/running-gns3-on-apple-m2-orbstack/</link>
      <pubDate>Wed, 29 Jan 2025 20:36:34 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/running-gns3-on-apple-m2-orbstack/</guid>
      <description>Lately, I&amp;rsquo;ve been switching from my Windows laptop to MacBook M2 for daily driver. It was smooth until I needed to migrate my virtual networking lab that relies on GNS3. It&amp;rsquo;s for my preparation before taking another Mikrotik&amp;rsquo;s certification. I was initially hesitant about whether I could run GNS3 on my M2 machine. After some research, I discovered that the GNS3 client is indeed available for macOS. To host the GNS3 server, I learned that I could set it up from scratch on a Linux machine using Orbstack.</description>
      <content:encoded><![CDATA[<p>Lately, I&rsquo;ve been switching from my Windows laptop to MacBook M2 for daily driver. It was smooth until I needed to migrate my virtual networking lab that relies on GNS3. It&rsquo;s for my preparation before taking another Mikrotik&rsquo;s certification. I was initially hesitant about whether I could run GNS3 on my M2 machine. After some <a href="https://www.gns3.com/community/featured/gns3-on-apple-silicon"target="_blank" rel="noopener noreferrer"
>research</a>, I discovered that the GNS3 client is indeed available for macOS. To host the GNS3 server, I learned that I could set it up from scratch on a Linux machine using Orbstack.</p>
<h4 id="goals">Goals</h4>
<ul>
<li>Get GNS3 server running on M2 Apple Silicon CPU.</li>
<li>Get GNS3 appliance installed on the GNS3 server.</li>
</ul>
<h4 id="prerequisites">Prerequisites</h4>
<ul>
<li><a href="https://orbstack.dev/"target="_blank" rel="noopener noreferrer"
>Orbstack</a> installed.</li>
<li><a href="https://github.com/gns3/gns3-gui/releases"target="_blank" rel="noopener noreferrer"
>GNS3 GUI/client</a> installed.</li>
</ul>
<h4 id="diagram">Diagram</h4>
<p>I drew a diagram to give you an overview of what we are going to do here.</p>
<img src="./imgs/image-20250129212031966.png" alt="image-20250129212031966" style="zoom: 50%;" />
<h2 id="on-mac">On Mac</h2>
<h3 id="deploy-a-linux-machine">Deploy A Linux Machine</h3>
<p>With Orbstack, create a new Linux machine with the latest Ubuntu distro.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ orb create --arch amd64 ubuntu gns3-host</span></span></code></pre>
</figure><p>Then verify the machine is running.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ orb list
</span></span><span class="line"><span class="cl">NAME       STATE    DISTRO  VERSION   ARCH
</span></span><span class="line"><span class="cl">----       -----    ------  -------   ----
</span></span><span class="line"><span class="cl">gns3-host  running  ubuntu  oracular  amd64</span></span></code></pre>
</figure><p>The Linux machine we just installed will act as the GNS3 server host.</p>
<h3 id="resources-allocation">Resources Allocation</h3>
<p>We can allocate CPU and memory resources to limit how much Orbstack machine can use with:</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#Show current configuration</span>
</span></span><span class="line"><span class="cl">$ orb config show
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Set maximum CPU cores for Orbstack to 4 cores</span>
</span></span><span class="line"><span class="cl">$ orb config <span class="nb">set</span> cpu <span class="m">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Set maximum memory for Orbstack to 8 GB</span>
</span></span><span class="line"><span class="cl">$ orb config <span class="nb">set</span> memory_mib <span class="m">8000</span></span></span></code></pre>
</figure><h2 id="on-the-linux-machine">On the Linux machine</h2>
<h3 id="hosting-gns3-server">Hosting GNS3 Server</h3>
<p>From Mac, login into the machine.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ orb -m gns3-host -u root</span></span></code></pre>
</figure><p>Add the GNS3 repository and install some necessary tools.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@gns3 $ sudo add-apt-repository ppa:gns3/ppa
</span></span><span class="line"><span class="cl">user@gns3 $ sudo apt update
</span></span><span class="line"><span class="cl">user@gns3 $ sudo apt install software-properties-common
</span></span><span class="line"><span class="cl">user@gns3 $ sudo apt install qemu-system-x86
</span></span><span class="line"><span class="cl">user@gns3 $ sudo apt install telnet
</span></span><span class="line"><span class="cl">user@gns3 $ sudo apt install gns3-server</span></span></code></pre>
</figure><p>In the middle way, select &ldquo;yes&rdquo; when you prompted with something like this.</p>
<img src="./imgs/image-20250129214423431.png" alt="image-20250129214423431" style="zoom:50%;" />
<p>If you missed the prompt, run the following.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#Add ubridge group to the gns3 user</span>
</span></span><span class="line"><span class="cl">user@gns3 $ sudo usermod -aG ubridge gns3</span></span></code></pre>
</figure><p>Verify the GNS3 server installation.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@gns3 $ systemctl status gns3-server</span></span></code></pre>
</figure><p>Or by visiting &ldquo;http://localhost:3080&rdquo;.</p>
<h3 id="change-working-directory">Change Working Directory</h3>
<p>This is optional. I would like to move the default working directory of GNS3 at <code>/var/lib/gns3-server/GNS3/</code> to <code>/opt/gns3/</code>.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#Create new dir config</span>
</span></span><span class="line"><span class="cl">user@gns3 $ sudo mkdir /opt/gns3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Copy old dir config to new dir config</span>
</span></span><span class="line"><span class="cl">user@gns3 $ sudo cp -r /var/lib/gns3-server/GNS3/* /opt/gns3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Change ownership </span>
</span></span><span class="line"><span class="cl">user@gns3 $ sudo chown -R gns3:gns3 /opt/gns3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Change default home directory</span>
</span></span><span class="line"><span class="cl">user@gns3 $ sudo usermod -d /opt/gns3 gns3</span></span></code></pre>
</figure><h3 id="configure-gns3-server">Configure GNS3 Server</h3>
<p>Since KVM is not supported inside the orbstack machine, we need to make some adjustments for GNS3 server config. Edit the config at <code>/opt/gns3/.config/GNS3/2.2/gns3_server.conf</code> as follows:</p>
<figure class="highlight">
    <pre tabindex="0"><code class="language-" data-lang="">[Server]
host = 0.0.0.0
port = 3080
images_path = /opt/gns3/images
appliances_path = /opt/gns3/appliances
configs_path = /opt/gns3/configs
projects_path = /opt/gns3/projects
symbols_path = /opt/gns3/symbols

report_errors = True

; First console port of the range allocated to devices
console_start_port_range = 5000
; Last console port of the range allocated to devices
console_end_port_range = 10000

; First VNC console port of the range allocated to devices.
; The value MUST BE &gt;= 5900 and &lt;= 65535
vnc_console_start_port_range = 5900
; Last VNC console port of the range allocated to devices
; The value MUST BE &gt;= 5900 and &lt;= 65535
vnc_console_end_port_range = 10000

; First port of the range allocated for inter-device communication. Two ports are allocated per link.
udp_start_port_range = 10000
; Last port of the range allocated for inter-device communication. Two ports are allocated per link
udp_end_port_range = 20000

; Only allow these interfaces to be used by GNS3, for the Cloud node for example (Linux/OSX only)
; Do not forget to allow virbr0 in order for the NAT node to work
allowed_interfaces = virbr0

; Enable the built-in templates
enable_builtin_templates = True

; check if hardware virtualization is used by other emulators (KVM, VMware or VirtualBox)
hardware_virtualization_check = False

[Dynamips]
allocate_aux_console_ports = False
mmap_support = True
sparse_memory_support = True
ghost_ios_support = True

[IOU]
iourc_path = /opt/gns3/iourc
license_check = True

[Qemu]
enable_kvm = False
require_kvm = False
enable_hardware_acceleration = False
require_hardware_acceleration = False</code></pre>
</figure><p>If the config directory don&rsquo;t exist do the following (inside the orbstack VM):</p>
<ol>
<li>Run <code>systemctl stop gns3-server</code>.</li>
<li>Run <code>gns3server</code> manually for a minute and stop it.</li>
<li>Start again with <code>systemctl start gns3-server</code>.</li>
<li>Look up again under <code>/var/lib/gns3-server/GNS3/.config</code> or <code>/opt/gns3/.config</code> if you follow the step 3.</li>
</ol>
<p>We&rsquo;re done with the server here.</p>
<h2 id="setting-up-gns3-client">Setting Up GNS3 Client</h2>
<h3 id="gns3-client">GNS3 Client</h3>
<p>GNS3 Client should detect the server automatically, if not, try open <strong>the GNS3 Client &gt; Settings &gt; Server</strong> and point the GNS3 server to the Linux machine.</p>
<p><div class="img-container"><img src="./imgs/image-20250129223723294.png" alt="image-20250129223723294"  /></div>
</p>
<p>Verify the connection.</p>
<h3 id="appliances-installation">Appliances Installation</h3>
<p>The network appliances now can be installed normally.</p>
<h2 id="the-results">The results</h2>
<h3 id="testing-initial-setup">Testing Initial Setup</h3>
<p>So far, excluding the ATM and Frame relay switches, I&rsquo;ve tested the basic appliances and everything works as it should except for the Cloud appliance.</p>
<img src="./imgs/image-20250129230112734.png" alt="image-20250129230112734" style="zoom:50%;" />
<h3 id="performances">Performances</h3>
<p>I allocated 4 CPUs and 4 GB of memory to Orbstack for the initial lab setup. Despite adding two more routers, everything runs smoothly and fast, with no choppy performance at all.</p>
<img src="./imgs/image-20250130222443482.png" alt="image-20250130222443482" style="zoom:50%;" />
<h2 id="conclusion">Conclusion</h2>
<p>At this point, GNS3 hosted within Orbstack Linux machine ran seamlessly on my M2 Mac. This should be enough for creating or simulating networking projects. However, I still wanted my network appliances could communicate with the LAN on my Mac, which I will dig into it in the next section.</p>
<h2 id="dig-into-network-limitation">Dig into Network Limitation</h2>
<p><strong>Accessing GNS3 Appliances from Mac LAN</strong></p>
<p>According to <a href="https://docs.orbstack.dev/machines/network"target="_blank" rel="noopener noreferrer"
>the documentation</a>, all Orbstack Linux machines are connected to the same network bridge with a fixed IPv4 address of <code>198.19.249.0/24</code>. On Mac, this network bridge displayed as <code>bridge100</code> and the Linux machines connected to that bridge via its <code>eth0</code>.</p>
<p>My goal is, let&rsquo;s say Winbox on Mac, will able to communicate with the GNS3 Mikrotik through the Cloud appliance via <code>eth0</code> of GNS3 server. Here&rsquo;s the diagram.</p>
<img src="./imgs/image-20250201125922492.png" alt="image-20250201125922492" style="zoom: 33%;" />
<p>Unfortunately, the Cloud appliance here did not list the <code>eth0</code> interface.</p>
<img src="./imgs/image-20250130225807891.png" alt="image-20250130225807891" style="zoom: 25%;" />
<p>In the image above,  <code>virbr0</code>  and <code>gns3tap0-0</code> are the interfaces that GNS3 use for the NAT appliances (<a href="https://gns3.com/how-the-nat-node-in-gns3-works"target="_blank" rel="noopener noreferrer"
>source</a>). When I ran the script that populates the interfaces on the GNS3 server manually, the output states that <code>eth0</code> cannot be used on this server.</p>
<img src="./imgs/image-20250131005043784.png" alt="image-20250131005043784" style="zoom:50%;" />
<p>After taking another look at the code, I figured out where the issue was. You guys probably have noticed it. 😂</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;win&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">allowed_interfaces</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_section_config</span><span class="p">(</span><span class="s2">&#34;Server&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;allowed_interfaces&#34;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">allowed_interfaces</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">allowed_interfaces</span> <span class="o">=</span> <span class="n">allowed_interfaces</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">net_if_addrs</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_if_addrs</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">interface</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">net_if_addrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">allowed_interfaces</span> <span class="ow">and</span> <span class="n">interface</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_interfaces</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">interface</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;gns3tap&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&#34;Interface &#39;</span><span class="si">{}</span><span class="s2">&#39; is not allowed to be used on this server&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">interface</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span></span></span></code></pre>
</figure><p>Yeah, it&rsquo;s on the step 3, about the server config! I just need to add the interface I want to be allowed there. Haha.</p>
<figure class="highlight">
    <pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="c1">; Only allow these interfaces to be used by GNS3, for the Cloud node for example (Linux/OSX only)</span>
</span></span><span class="line"><span class="cl"><span class="c1">; Do not forget to allow virbr0 in order for the NAT node to work</span>
</span></span><span class="line"><span class="cl"><span class="na">allowed_interfaces</span> <span class="o">=</span> <span class="s">virbr0,eth0 </span>
</span></span><span class="line"><span class="cl"><span class="c1">; ^ I added eth0</span></span></span></code></pre>
</figure><p>After that, pinging from Mac (192.19.249.3) to the Mikrotik appliance (192.19.249.150) is reachable.</p>
<img src="./imgs/image-20250201140538579.png" alt="image-20250201140538579" style="zoom: 33%;" />
<p>But it&rsquo;s not over yet, I&rsquo;m still unable to access the services like for example Mikrotik Winbox on port 8291 or WebFig on port 80. It results the same with the GNS3 server.</p>
<img src="./imgs/image-20250202135153641.png" alt="image-20250202135153641" style="zoom: 33%;" />
<p>Inspecting the traffic with Wireshark, I saw that no TCP handshake was performed between my Mac and the Mikrotik appliance. I gave up! Orbstack network implementation is beyond my understanding, so I don&rsquo;t know what exactly it does under the hood.</p>
<img src="./imgs/image-20250201163513432.png" alt="image-20250201163513432" style="zoom: 33%;" />
<p>It seems I have to wait for Orbstack to fully support bridged networking. In the meantime, I will take a look for other options like UTM, or even move to PNET Lab. Personally, I liked Orbstack more, it almost similar to WSL but on Mac.</p>
<p><strong>UPDATE</strong></p>
<p>I tried to deploy PNETLab on Google Cloud, check <a href="/articles/deploy-pnetlab-on-gcp/"target="_blank" rel="noopener noreferrer"
>this out</a>.</p>
<p>That&rsquo;s all, see you in the next post!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Hello World PT.2: I&#39;m back!</title>
      <link>https://fahmifj.github.io/notes/hello-world-pt2/</link>
      <pubDate>Thu, 18 Aug 2022 00:39:04 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/notes/hello-world-pt2/</guid>
      <description>I&amp;#39;m not quitting the blog yet!</description>
      <content:encoded><![CDATA[<p>Hello readers, it&rsquo;s been a while, hasn&rsquo;t it?</p>
<p>Setelah sekian lamanya, gue akan aktif nge-blog lagi!</p>
<p>Sebenernya dari awal juga gak ada niatan untuk menonaktifkan blog ini sih. Justru, ada banyak hal yang ingin gue tulis karena banyak kasus-kasus baru dan unik di tempat kerja sekarang. Sayangnya, saat itu intensitas kerjanya lumayan tinggi jadi belum sempat untuk nyentuh blog ini lagi. Situasi tersebut bukan bermaksud &ldquo;negatif&rdquo; ya, tetapi lebih ke <em>challenging</em> aja dan itu seru.</p>
<p>Saking banyaknya yang gue pelajari sambil nge-catch up pace kerjanya, jadi sewaktu belum selesai dengan <em>draft</em> yang satu, gue sudah buat <em>draft</em> lain. Akibatnya, menggununglah itu draft-draft tadi.</p>
<p>Berhubung sekarang sudah <em>all clear</em>, maka disela-sela waktu <em>gabut</em> ini gue coba untuk nge-blog lagi.</p>
<h2 id="tinjauan">Tinjauan</h2>
<p>Setelah buka dan baca tulisan-tulisan yang gue tulis disini, ada beberapa point yang kayaknya perlu gue update, dua diantaranya adalah:</p>
<ul>
<li>Pertama, bahasa Inggris yg gue pake ternyata lumayan <em>nitttt-</em> juga yaa  //oke, untuk ini lebih baik tidak diperjelas, harap maklum :)).</li>
<li>Kedua, dari sisi tampilan, desain blog ini tidak lagi <del>sedikit</del> unik karena ada beberapa readers 外人 yang meminta izin untuk menyontek desain sekarang dan secara UX untuk mobile juga kurang. Jadi, gue merasa harus di revamp lagi dikit.</li>
</ul>
<p>Jadi, sebelum mulai aktif lagi, ada beberapa hal yang bakal gue update dan perbaiki dulu. Mungkin desainnya bisa dikebut mulai sekarang, soalnya revamp sebelumnya bikin gue mual liat CSS.</p>
<h2 id="feedback">Feedback</h2>
<p>Nah, soal feedback nih, ada temen gue yang kesulitan menterjemahkan writeup/walkthrough CTF yang gue buat dalam bahasa ke-&ldquo;Inggris&rdquo;-an  (gue juga semasuk-masuknya aja sih itu haha). Dia minta supaya gue bikin versi bahasa Indonesia-nya. Tapi untuk ini gue gak bisa nurutin permintaannya, soalnya gue <del>males</del> latihan juga pake bahasa Inggris, ditambah, menurut statistik Google, visitor blog ini lebih banyak dari luar daripada Indonesianya. Sooo, liat nanti deh.</p>
<p>Oh ya, gue juga lagi nyicil  bikin tulisan-tulisan pendek kaya punya Pak <a href="https://hilman.space"target="_blank" rel="noopener noreferrer"
>@hilmanski</a>, tapi isinya tentang IT sehari-hari. Semoga bisa terealisasi.</p>
<h2 id="end">End</h2>
<p>Oke, mungkin itu dulu celotehan gue disini, see you in the next post.</p>
<blockquote>
<p><strong>[ ! ] Informasi tidak penting</strong></p>
<p>Perlu diketahui tulisan ini sebenarnya sudah di-edit berkali-kali karena terlanjur nge-set draft ke <em>true</em> (aslinya sih grogi nulis lagi setelah hiatus berbulan-bulan wkwkw).</p>
</blockquote>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
