<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>Fixing Broken Windows Permissions After Using SaRA | Ef's log</title><meta name=keywords content="Windows,Microsoft Office"><meta name=description content="Facing weird error on Windows 10? Then this post might help you"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/blog/office-error-30015-4/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.9b9140f0561464259fe4956ef93e1c91bda8fb14ae7c3cef3ee8be4ad3cbdd4b.css integrity="sha256-m5FA8FYUZCWf5JVu+T4ckb2o+xSufDzvPui+StPL3Us=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.6379eb6ace9db4c25b9b09a9c8799d367f9e72f537f38c9ed49c81b223e344bc.js integrity="sha256-Y3nras6dtMJbmwmpyHmdNn+ecvU384ye1JyBsiPjRLw="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0="></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.111.2"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="Fixing Broken Windows Permissions After Using SaRA"><meta property="og:description" content="Facing weird error on Windows 10? Then this post might help you"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/blog/office-error-30015-4/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-07-21T07:07:50+07:00"><meta property="article:modified_time" content="2021-07-21T07:07:50+07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Fixing Broken Windows Permissions After Using SaRA"><meta name=twitter:description content="Facing weird error on Windows 10? Then this post might help you"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://fahmifj.github.io/blog/"},{"@type":"ListItem","position":2,"name":"Fixing Broken Windows Permissions After Using SaRA","item":"https://fahmifj.github.io/blog/office-error-30015-4/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fixing Broken Windows Permissions After Using SaRA","name":"Fixing Broken Windows Permissions After Using SaRA","description":"Facing weird error on Windows 10? Then this post might help you","keywords":["Windows","Microsoft Office"],"articleBody":"TL;DR\nIf your Microsoft Office installation fails with Error Code: 30015-4 (5) or you’re seeing GetLastError:5 and strange Wi-Fi issues after using the Microsoft Support and Recovery Assistant (SaRA), it’s probably caused by broken Windows folder permissions.\nFix:\nRe-enable permission inheritance on affected folders under C:\\ProgramData\\Microsoft\\. Remove any custom user entries (keep SYSTEM, Administrators, Users). Reboot and retry the installer. Common folders to check:\nC:\\ProgramData\\Microsoft\\OFFICE C:\\ProgramData\\Microsoft\\Windows C:\\ProgramData\\Microsoft\\Wlansvc Symptoms this resolves:\nOffice install error 30015-4 (5) GetLastError:5 during app install/uninstall Wi-Fi forgetting passwords or crashing with stack-based buffer error Missing “Forget” / “Properties” options in Wi-Fi menu Yesterday, what started as a simple plan to upgrade Microsoft Office and clean up unused Chocolatey packages turned into a full-blown Windows permissions disaster.\nWhile reinstalling Office, I ran into this error Error Code: 30015-4 (5) , from there it escalated quickly to more error messages. At that time, I couldn’t install or uninstall any program that used Windows Installer, and even my Wi-Fi not functioning like how it was supposed to.\nThis post documents how I identified the root cause, which is corrupted system permissions, that was likely caused by Microsoft’s SaRA (Support and Recovery Assistant) tool and how I fixed everything by manually restoring folder permission inheritance.\nThe Problems Office Installation Failed The trouble started when Office refused to install and threw this message: Error Code: 30015-4(5).\nClicking on the online help led me to this page, where it offers an “easy fix” tool, which turns out only to make thing worse.\nThe tool running successfully, but the same error persisted. At this point, I couldn’t install or uninstall any applications wrapped with Windows Installer (.msi) anymore. The problem then escalated to unrelated installers like Node.js or Visual Studio’s Windows SDK.\nSide Effects: WiFi Gone Weird Strangely, my WiFi started acting up:\nIt stopped saving Wi-Fi profiles, so I had to re-enter passwords every time. Auto-connect and mobile hotspot features stopped working. The Forget and Properties options disappeared when right-clicking a network. And most bizarre was a stack-based buffer overrun error appeared when opening Wi-Fi settings. Right-clicking a connected Wi-Fi network triggered the stack-based buffer overrun.\nAnd as you can see below, the “Forget” and “Properties” options were gone completely.\nAt this point, it was clear this wasn’t just an Office issue anymore, my Windows system were messed up.\nIdentifying Root Cause Searching for Error Code: 30015-4 (5) on Microsoft’s support site didn’t help much. So I looked into the windows system error codes list and found that (5) corresponds to:\nThat confirmed it was clear that these problems were related to the system permissions.\nI started to investigate the folder where all application data is stored/created.\nC:\\Program Files\\ C:\\Program Files (x86)\\ C:\\ProgramData While investigating all the folders under C:\\ProgramData\\ and C:\\ProgramData\\Microsoft, I noticed that some of the folders only had my user account listed in their security properties.\nNormally, the folder permissions under C:\\ProgramData should be configured similar to the image below (taken from VirtualBox folder).\nWith advanced permissions configured like this:\nNow that I knew what proper permissions looked like, I could start fixing the broken ones.\nFixing Permissions Office Installation Error Code: 30015-4 (5) To fix this, I restored proper inheritance on the Office data folder:\nPath:\nC:\\ProgramData\\Microsoft\\OFFICE Fix steps\nRight-click the folder → Properties → Security → Advanced Remove any explicit entries for your user account (keep SYSTEM, Administrators, Users). Enable Inheritance (This allows the OFFICE folder to inherit permissions from its parent Microsoft folder). If you’re not sure about this, do check the other folders’ permissions under the same parent folder. Using this case, then the parent folder is C:\\ProgramData\\Microsoft\\, and the child are any folders under C:\\ProgramData\\Microsoft\\[child].\nAfter applying these changes, I retried the Office installer and it finally worked.\nGetLastError:5 Next, I encountered the following error message from chocolatey and node.js:\nC:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs GetLastError: 5 Any GetLastError:5, can be resolved using the same method as above, by enabling the inheritance to the affected application folder.\nTo trace the problem:\nCheck the permissions of each parent folder in sequence: C:\\ProgramData\\Microsoft C:\\ProgramData\\Microsoft\\Windows C:\\ProgramData\\Microsoft\\Windows\\Start Menu C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs Identify where inheritance was broken. Reenable it, starting from the topmost broken folder. In my case, the Windows folder had lost its inherited permissions, so I restored it first by enable the inheritance (See “Inherited from” column).\nAnd then, I will revert the Start Menu folder permissions to default, see image below.\nFinally inherit the Start Menu folder permissions to the Programs folder.\nIf you’re unsure what the default permissions should be, try install a clean Windows VM and compare them, it’s much safer than guessing.\nStack-based and WiFi error If you’re seeing any of these symptoms:\nSystemSettings.exe – System Error (stack overrun message) Windows forgets Wi-Fi networks or passwords Missing Forget and Properties options in Wi-Fi menu Mobile hotspot won’t start Then the culprit is probably the WLAN service profile folder. In Windows, all Wi-Fi profiles are stored in\nC:\\ProgramData\\Microsoft\\Wlansvc\\Profiles If the system doesn’t have write access, it can’t save or load them correctly.\nThe fix steps are the same:\nRight-click Wlansvc folder \u003e Properties \u003e Security \u003e Advanced Remove any users account available Enable inheritance, so permissions flow down from Microsoft Apply and restart Windows After that, everything worked again:\nWi-Fi remembered passwords Auto-connect and hotspot worked No more stack-based buffer error It also fixed the missing options and auto-connect. Lesson Learned Permission issues can cause weird system behavior, even unrelated things like Wi-Fi and installer errors. Always check folder inheritance settings before running automated repair tools. Use a virtual machine to inspect clean Windows defaults, it’s a great reference for fixing broken permissions. Tools like Microsoft SaRA can help in many cases, but sometimes they might overfix things. End In the end, restoring folder inheritance fixed all my issues, from Office installation errors to Wi-Fi crashes. All that chaos just because I wanted to reinstall Office, nut at least now I understand Windows permissions better than ever.\n","wordCount":"989","inLanguage":"en","datePublished":"2021-07-21T07:07:50+07:00","dateModified":"2021-07-21T07:07:50+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/blog/office-error-30015-4/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a>
<button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div><ul id=menu onscroll=menuOnScroll()><li><a href=https://fahmifj.github.io/blog/ title=Blog>Blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=CTF>CTF</a></li><li><a href=https://fahmifj.github.io/threads/ title=Threads>Threads</a></li><li><a href=https://fahmifj.github.io/archives/ title=Archives>Archives</a></li></ul><button id=menu-toggle aria-label="Toggle menu">☰</button><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search placeholder=Search...><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div></div></nav></header><div id=mask></div><main id=swup class="main transition-fade"><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/blog/>Blog</a></div><h1 class=post-title>Fixing Broken Windows Permissions After Using SaRA</h1><p class=post-description>Facing weird error on Windows 10? Then this post might help you</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>Published on July 21, 2021</span>&nbsp;&#183;&nbsp;<span class=read-time>5 min read</span></div><hr></header><div class=post-content-container><nav id=toc class=toc aria-label="Table of contents"><div class=inner><ul><li><a href=#the-problems aria-label="The Problems">The Problems</a><ul><li><a href=#office-installation-failed aria-label="Office Installation Failed">Office Installation Failed</a></li><li><a href=#side-effects-wifi-gone-weird aria-label="Side Effects: WiFi Gone Weird">Side Effects: WiFi Gone Weird</a></li><li><a href=#identifying-root-cause aria-label="Identifying Root Cause">Identifying Root Cause</a></li></ul></li><li><a href=#fixing-permissions aria-label="Fixing Permissions">Fixing Permissions</a><ul><li><a href=#office-installation-error-code-30015-4-5 aria-label="Office Installation Error Code: 30015-4 (5)">Office Installation Error Code: 30015-4 (5)</a></li><li><a href=#getlasterror5 aria-label=GetLastError:5>GetLastError:5</a></li><li><a href=#stack-based-and-wifi-error aria-label="Stack-based and WiFi error">Stack-based and WiFi error</a></li></ul></li><li><a href=#lesson-learned aria-label="Lesson Learned">Lesson Learned</a></li><li><a href=#end aria-label=End>End</a></li></ul></div></nav><div class=post-content><p>TL;DR</p><p>If your Microsoft Office installation fails with <code>Error Code: 30015-4 (5)</code> or you’re seeing <code>GetLastError:5</code> and strange Wi-Fi issues after using the Microsoft Support and Recovery Assistant (SaRA), it’s probably caused by broken Windows folder permissions.</p><p><strong>Fix:</strong></p><ol><li>Re-enable permission inheritance on affected folders under <code>C:\ProgramData\Microsoft\</code>.</li><li>Remove any custom user entries (keep SYSTEM, Administrators, Users).</li><li>Reboot and retry the installer.</li></ol><p>Common folders to check:</p><ul><li><code>C:\ProgramData\Microsoft\OFFICE</code></li><li><code>C:\ProgramData\Microsoft\Windows</code></li><li><code>C:\ProgramData\Microsoft\Wlansvc</code></li></ul><p>Symptoms this resolves:</p><ul><li>Office install error <strong>30015-4 (5)</strong></li><li><code>GetLastError:5</code> during app install/uninstall</li><li>Wi-Fi forgetting passwords or crashing with stack-based buffer error</li><li>Missing &ldquo;Forget&rdquo; / &ldquo;Properties&rdquo; options in Wi-Fi menu</li></ul><hr><p>Yesterday, what started as a simple plan to upgrade Microsoft Office and clean up unused Chocolatey packages turned into a full-blown Windows permissions disaster.</p><p>While reinstalling Office, I ran into this error <code>Error Code: 30015-4 (5)</code> , from there it escalated quickly to more error messages. At that time, I couldn’t install or uninstall any program that used Windows Installer, and even my Wi-Fi not functioning like how it was supposed to.</p><p>This post documents how I identified the root cause, which is corrupted system permissions, that was likely caused by Microsoft’s <strong>SaRA (Support and Recovery Assistant)</strong> tool and how I fixed everything by manually restoring folder permission inheritance.</p><h2 id=the-problems>The Problems<a class=anchor aria-hidden=true href=#the-problems>#</a></h2><h3 id=office-installation-failed>Office Installation Failed<a class=anchor aria-hidden=true href=#office-installation-failed>#</a></h3><p>The trouble started when Office refused to install and threw this message: <code>Error Code: 30015-4(5)</code>.</p><p><div class=img-container><img src=imgs/image-20210721040950497.png alt=image-20210721040950497 title="Error Code: 30015-4 (5)"></div></p><p>Clicking on the online help led me to <a href="https://support.microsoft.com/en-us/office/fix-office-installation-errors-d5df89a9-0507-4b4c-92f9-22f457e630aa?ns=ocsac2rinstall&amp;version=16&amp;syslcid=1033&amp;uilcid=1033&amp;appver=cin160&amp;helpid=%225-4-30015%22&amp;ui=en-us&amp;rs=en-us&amp;ad=us" target=_blank rel="noopener noreferrer">this page</a>, where it offers an &ldquo;easy fix&rdquo; tool, which turns out only to make thing worse.</p><p><div class=img-container><img src=imgs/image-20210721041358098.png alt=image-20210721041358098 title="An easy fix tool that resulted in another chaos"></div></p><p>The tool running successfully, but the same error persisted. At this point, I couldn&rsquo;t install or uninstall any applications wrapped with Windows Installer (<code>.msi</code>) anymore. The problem then escalated to unrelated installers like Node.js or Visual Studio’s Windows SDK.</p><p><div class=img-container><img src=./imgs/image-20210718024015408.png alt=image-20210718024015408></div></p><h3 id=side-effects-wifi-gone-weird>Side Effects: WiFi Gone Weird<a class=anchor aria-hidden=true href=#side-effects-wifi-gone-weird>#</a></h3><p>Strangely, my WiFi started acting up:</p><ol><li>It stopped saving Wi-Fi profiles, so I had to re-enter passwords every time.</li><li>Auto-connect and mobile hotspot features stopped working.</li><li>The <em>Forget</em> and <em>Properties</em> options disappeared when right-clicking a network.</li><li>And most bizarre was a <strong>stack-based buffer overrun</strong> error appeared when opening Wi-Fi settings.</li></ol><p>Right-clicking a connected Wi-Fi network triggered the stack-based buffer overrun.</p><p><div class=img-container><img src=imgs/image-20210721050915867.png alt=image-20210721050915867 title="Stack-based buffer error"></div></p><p>And as you can see below, the “Forget” and “Properties” options were gone completely.</p><p><div class=img-container><img src=imgs/image-20210721054401662.png alt=image-20210721054401662 title="Missing the Forget and the Properties options"></div></p><p>At this point, it was clear this wasn’t just an Office issue anymore, my Windows system were messed up.</p><h3 id=identifying-root-cause>Identifying Root Cause<a class=anchor aria-hidden=true href=#identifying-root-cause>#</a></h3><p>Searching for <code>Error Code: 30015-4 (5)</code> on Microsoft’s support site didn’t help much. So I looked into the <a href=https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes--0-499- target=_blank rel="noopener noreferrer">windows system error codes</a> list and found that <code>(5)</code> corresponds to:</p><p><div class=img-container><img src=imgs/image-20210721043547662.png alt=image-20210721043547662></div></p><p>That confirmed it was clear that these problems were related to the system permissions.</p><p>I started to investigate the folder where all application data is stored/created.</p><ul><li><code>C:\Program Files\</code></li><li><code>C:\Program Files (x86)\</code></li><li><code>C:\ProgramData</code></li></ul><p>While investigating all the folders under <code>C:\ProgramData\</code> and <code>C:\ProgramData\Microsoft</code>, I noticed that some of the folders only had my user account listed in their security properties.</p><p><div class=img-container><img src=imgs/image-20210721044802348.png alt=image-20210721044802348 title="Bad Permissions on Office folder"></div></p><p>Normally, the folder permissions under <code>C:\ProgramData</code> should be configured similar to the image below (taken from VirtualBox folder).</p><p><div class=img-container><img src=imgs/image-20210721045334784.png alt=image-20210721045334784 title="Good Permissions: Basic"></div></p><p>With advanced permissions configured like this:</p><p><div class=img-container><img src=imgs/image-20210721045624596.png alt=image-20210721045624596 title="Good Permissions: Advanced Settings"></div></p><p>Now that I knew what proper permissions looked like, I could start fixing the broken ones.</p><h2 id=fixing-permissions>Fixing Permissions<a class=anchor aria-hidden=true href=#fixing-permissions>#</a></h2><h3 id=office-installation-error-code-30015-4-5>Office Installation Error Code: 30015-4 (5)<a class=anchor aria-hidden=true href=#office-installation-error-code-30015-4-5>#</a></h3><p>To fix this, I restored proper inheritance on the <strong>Office data folder</strong>:</p><p>Path:</p><figure class=highlight><pre tabindex=0><code class=language-PATH: data-lang=PATH:>C:\ProgramData\Microsoft\OFFICE</code></pre></figure><p>Fix steps</p><ol><li>Right-click the folder → <em>Properties</em> → <em>Security</em> → <em>Advanced</em></li><li>Remove any explicit entries for your user account (keep SYSTEM, Administrators, Users).</li><li>Enable Inheritance (This allows the <code>OFFICE</code> folder to inherit permissions from its parent <code>Microsoft</code> folder).</li></ol><p><div class=img-container><img src=imgs/image-20210721051824838.png alt=image-20210721051824838 title="Fix Office Error Code: 30015-4(5)"></div></p><p>If you&rsquo;re not sure about this, do check the other folders&rsquo; permissions under the same parent folder. Using this case, then the parent folder is <code>C:\ProgramData\Microsoft\</code>, and the child are any folders under <code>C:\ProgramData\Microsoft\[child]</code>.</p><p>After applying these changes, I retried the Office installer and it finally worked.</p><p><div class=img-container><img src=imgs/image-20210721053920106.png alt=image-20210721053920106></div></p><h3 id=getlasterror5>GetLastError:5<a class=anchor aria-hidden=true href=#getlasterror5>#</a></h3><p>Next, I encountered the following error message from chocolatey and node.js:</p><figure class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>C:<span class=se>\P</span>rogramData<span class=se>\M</span>icrosoft<span class=se>\W</span>indows<span class=se>\S</span>tart Menu<span class=se>\P</span>rograms GetLastError: <span class=m>5</span></span></span></code></pre></figure><p>Any <code>GetLastError:5</code>, can be resolved using the same method as above, by enabling the inheritance to the affected application folder.</p><p>To trace the problem:</p><ol><li>Check the permissions of each parent folder in sequence:<ul><li><code>C:\ProgramData\Microsoft</code></li><li><code>C:\ProgramData\Microsoft\Windows</code></li><li><code>C:\ProgramData\Microsoft\Windows\Start Menu</code></li><li><code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs</code></li></ul></li><li>Identify where inheritance was broken.</li><li>Reenable it, starting from the topmost broken folder.</li></ol><p>In my case, the <code>Windows</code> folder had lost its inherited permissions, so I restored it first by enable the inheritance (See &ldquo;Inherited from&rdquo; column).</p><p><div class=img-container><img src=imgs/image-20210721114505028.png alt=image-20210721114505028></div></p><p>And then, I will revert the <code>Start Menu</code> folder permissions to default, see image below.</p><p><div class=img-container><img src=imgs/image-20210721114911619.png alt=image-20210721114911619></div></p><p>Finally inherit the <code>Start Menu</code> folder permissions to the <code>Programs</code> folder.</p><p><div class=img-container><img src=imgs/image-20210721115022365.png alt=image-20210721115022365></div></p><p>If you’re unsure what the default permissions should be, try install a clean Windows VM and compare them, it’s much safer than guessing.</p><h3 id=stack-based-and-wifi-error>Stack-based and WiFi error<a class=anchor aria-hidden=true href=#stack-based-and-wifi-error>#</a></h3><p>If you’re seeing any of these symptoms:</p><ul><li>SystemSettings.exe – System Error (stack overrun message)</li><li>Windows forgets Wi-Fi networks or passwords</li><li>Missing <em>Forget</em> and <em>Properties</em> options in Wi-Fi menu</li><li>Mobile hotspot won’t start</li></ul><p>Then the culprit is probably the WLAN service profile folder. In Windows, all Wi-Fi profiles are stored in</p><figure class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>C:\ProgramData\Microsoft\Wlansvc\Profiles</span></span></code></pre></figure><p>If the system doesn’t have write access, it can’t save or load them correctly.</p><p>The fix steps are the same:</p><ol><li>Right-click <code>Wlansvc</code> folder > <em>Properties</em> > <em>Security</em> > <em>Advanced</em></li><li>Remove any users account available</li><li>Enable <em>inheritance</em>, so permissions flow down from <code>Microsoft</code></li><li>Apply and restart Windows</li></ol><p><div class=img-container><img src=imgs/image-20210721055011183.png alt=image-20210721055011183></div></p><p>After that, everything worked again:</p><ul><li>Wi-Fi remembered passwords</li><li>Auto-connect and hotspot worked</li><li>No more stack-based buffer error</li><li>It also fixed the missing options and auto-connect.</li></ul><p><div class=img-container><img src=imgs/image-20210721055107535.png alt=image-20210721055107535></div></p><h2 id=lesson-learned>Lesson Learned<a class=anchor aria-hidden=true href=#lesson-learned>#</a></h2><ul><li>Permission issues can cause <em>weird</em> system behavior, even unrelated things like Wi-Fi and installer errors.</li><li>Always check folder inheritance settings before running automated repair tools.</li><li>Use a virtual machine to inspect clean Windows defaults, it’s a great reference for fixing broken permissions.</li><li>Tools like Microsoft SaRA can help in many cases, but sometimes they might overfix things.</li></ul><h2 id=end>End<a class=anchor aria-hidden=true href=#end>#</a></h2><p>In the end, restoring folder inheritance fixed all my issues, from Office installation errors to Wi-Fi crashes. All that chaos just because I wanted to reinstall Office, nut at least now I understand Windows permissions better than ever.</p><div class=post-references><h2>Reference</h2><ul><li><a href=https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes--1700-3999- target=_blank rel="noopener noreferrer">https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes--1700-3999-</a></li></ul></div></div></div><div class=post-meta-bottom></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/windows/>windows</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Fixing Broken Windows Permissions After Using SaRA on twitter" href="https://twitter.com/intent/tweet/?text=Fixing%20Broken%20Windows%20Permissions%20After%20Using%20SaRA&amp;url=https%3a%2f%2ffahmifj.github.io%2fblog%2foffice-error-30015-4%2f&amp;hashtags=Windows"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Fixing Broken Windows Permissions After Using SaRA on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2ffahmifj.github.io%2fblog%2foffice-error-30015-4%2f&amp;title=Fixing%20Broken%20Windows%20Permissions%20After%20Using%20SaRA&amp;summary=Fixing%20Broken%20Windows%20Permissions%20After%20Using%20SaRA&amp;source=https%3a%2f%2ffahmifj.github.io%2fblog%2foffice-error-30015-4%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Fixing Broken Windows Permissions After Using SaRA on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fblog%2foffice-error-30015-4%2f&title=Fixing%20Broken%20Windows%20Permissions%20After%20Using%20SaRA"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Fixing Broken Windows Permissions After Using SaRA on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fblog%2foffice-error-30015-4%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Fixing Broken Windows Permissions After Using SaRA on whatsapp" href="https://api.whatsapp.com/send?text=Fixing%20Broken%20Windows%20Permissions%20After%20Using%20SaRA%20-%20https%3a%2f%2ffahmifj.github.io%2fblog%2foffice-error-30015-4%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Fixing Broken Windows Permissions After Using SaRA on telegram" href="https://telegram.me/share/url?text=Fixing%20Broken%20Windows%20Permissions%20After%20Using%20SaRA&amp;url=https%3a%2f%2ffahmifj.github.io%2fblog%2foffice-error-30015-4%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><div class=footer-wrapper><div class=footer-right><span class=copyright>&copy; 2025&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span></div><div class=footer-mid><span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span>
&nbsp;·&nbsp;
<span class=support><a href=https://fahmifj.github.io/about#support>support</a></span>
&nbsp;·&nbsp;
<span class=rss><a href=https://fahmifj.github.io/index.xml>rss</a></span></div><div class=footer-left><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span><a href=https://git.io/hugopapermod rel="noopener noreferrer" target=_blank>PaperMod</a></span></div></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script src=https://fahmifj.github.io/js/toc.min.2fdf2a552d475a4f70f7cd5bdd987dfa7d62f78b07acacd44027b6b9486268e4.js></script>
<script defer type=module src=https://fahmifj.github.io/js/Swup.umd.min.d64a38b8723041127f14ef7bcd3898876f7226120fe6bd79aadb73f863ee0395.js></script>
<script defer src=https://fahmifj.github.io/js/custom.min.92ee8d1cb48fc287df05886217b413a12841616e99833d423ea6338e6ad1b66f.js></script></body></html>